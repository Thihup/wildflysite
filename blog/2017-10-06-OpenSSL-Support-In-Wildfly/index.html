<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description" content="">
  <link rel="shortcut icon" type="image/png" href="/wildflysite/favicon.ico" >
  <link rel="stylesheet" href="/wildflysite/assets/css/main.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">


</head>

<body class="OpenSSL support with WildFly">
  <div class="content">
    <div class="header navigation">
  <div class="logo-wrapper">
    <a href="/wildflysite/"><img class="wf-logo" src="/wildflysite/assets/img/wildfly_icons_one-color-logo.png"></a>
  </div>
  <div class="nav-container">
    <nav>
      <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
      <ul class="nav-list">
        <li>
          <a href="/wildflysite/" class="">Home</a>
        </li>
        <li>
          <a href="/wildflysite/downloads/" class="">Downloads</a>
        </li>
        <li>
          <a href="/wildflysite/blog/" class="">Blog</a>
        </li>
        <li>
          <a href="/wildflysite/about/" class="">About</a>
        </li>
        <li>
          <a href="/wildflysite/contribute/" class="">Contribute</a>
        </li>
        <li>
          <a href="/wildflysite/docs/" class="">Docs</a>
        </li>
        <li>
          <a class="button-cta secondary" href="https://github.com/wildfly/wildfly/fork" target="_blank">Fork</a>
        </li>
      </ul>
    </nav>
  </div>
</div>

    <div class="post-page grid-wrapper">
  <!-- <div class="grid__item width-12-12"><h1 class="title">OpenSSL support with WildFly</h1></div> -->
  <!-- <div class="grid__item width-2-12 doc-toc"><ul class="inline_toc">
  <li><a href="#openssl-support-with-wildfly">OpenSSL support with WildFly</a></li>
  <li><a href="#setting-up-openssl">Setting up OpenSSL</a></li>
  <li><a href="#setting-up-wildfly-with-security-realms">Setting up Wildfly with Security Realms</a></li>
  <li><a href="#setting-up-wildfly-with-elytron">Setting up Wildfly with Elytron</a></li>
</ul></div> -->
  <div class="grid__item width-10-12 doc-content"><div class="sect1">
<h2 id="openssl-support-with-wildfly">OpenSSL support with WildFly</h2>
<div class="sectionbody">
<div class="paragraph">
<p>sdouglas
2017-10-06</p>
</div>
<div class="paragraph">
<p>The upcoming WildFly 11 release includes support for OpenSSL. This provides two main advantages over JSSE:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for ALPN on all JDK&#8217;s</p>
</li>
<li>
<p>Significantly improved performance compared to JSSE</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setting-up-openssl">Setting up OpenSSL</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In general for Linux based systems all that is required is to install a recent version of OpenSSL using your systems
package manager. The OpenSSL support will search the library path, and use whatever version of OpenSSL it finds. The
same applies to MacOS when OpenSSL has been installed using brew (the system default OpenSSL installation is too old).</p>
</div>
<div class="paragraph">
<p>For windows and for custom OpenSSL locations you need to specify the location via a system property,
<code>org.wildfly.openssl.path</code>. If this is set then Wildfly will search for OpenSSL in the directory specified. If you have
multiple versions of OpenSSL in the same directory and need to specify the precise file to use you can instead use
<code>org.wildfly.openssl.path.ssl</code> and <code>org.wildfly.openssl.path.crypto</code> to specify the path to libssl and libcrypto
respectively.</p>
</div>
<div class="paragraph">
<p>As Wildfly uses dynamic linking this should work with any OpenSSL version from 1.0.1 onwards (however for security
reasons it is recommended to always use the most up to date 1.1.x or 1.0.x version that is available, as older versions
may have unpatched vulnerabilities).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setting-up-wildfly-with-security-realms">Setting up Wildfly with Security Realms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As Wildfly supports SSL out of the box with dynamically generated self signed certificates all that is required is to
change the protocol in use. Doing this is as simple as running a single command in the CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/core-service=management/security-realm=ApplicationRealm/server-identity=ssl:write-attribute(name=protocol, value=openssl.TLS)</pre>
</div>
</div>
<div class="paragraph">
<p>Other valid values are <code>openssl.TLSv1.1</code> and <code>openssl.TLSv1.2</code>, which limit the minimum TLS version to 1.1 and 1.2
respectively.</p>
</div>
<div class="paragraph">
<p>Once this is done you can use OpenSSL by simply pointing your browser to <a href="https://localhost:8443">https://localhost:8443</a>.
You should see the following message in the log that tells you that OpenSSL is in use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>09:01:04,150 INFO  [org.wildfly.openssl.SSL] (MSC service thread 1-6) WFOPENSSL0002 OpenSSL Version OpenSSL 1.0.2l  25 May 2017</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setting-up-wildfly-with-elytron">Setting up Wildfly with Elytron</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As Elytron is not used by default there is a little bit more work involved in setting it up. Elytron does not support
auto generation of SSL certificates, so for the sake of this example I am going to assume that the keystore is
located at <code>standalone/configuration/application.keystore</code> (the same location that the auto generated keystore is placed,
if you just want a self signed certificate for testing purposes you can simply connect to
<a href="https://localhost:8443">https://localhost:8443</a> with the default configuration and one will be generated for you).</p>
</div>
<div class="paragraph">
<p>In order to set up SSL using Elytron run the following commands (note that this is just to use JSSE, the OpenSSL config
will come later).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/subsystem=elytron/key-store=server:add(path=application.keystore, relative-to=jboss.server.config.dir, credential-reference={clear-text=password}, type=jks)
/subsystem=elytron/key-manager=server:add(key-store=server, credential-reference={clear-text=password}, algorithm=SunX509)
/subsystem=elytron/server-ssl-context=server:add(key-manager=server, protocols=[TLSv1.2])
batch
/subsystem=undertow/server=default-server/https-listener=https:undefine-attribute(name=security-realm)
/subsystem=undertow/server=default-server/https-listener=https:write-attribute(name=ssl-context, value=server)
run-batch
:reload</pre>
</div>
</div>
<div class="paragraph">
<p>If you point your browser at <a href="https://localhost:8443">https://localhost:8443</a> you should now have a working Elytron based
SSL config. Once you have verified that this has worked we now need to change it to use OpenSSL. To do this we change
the ordering of the providers in the elytron combined-providers, which means that OpenSSL will now take precedence:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/subsystem=elytron/aggregate-providers=combined-providers:list-add(index=0, name=providers, value=openssl)
/subsystem=elytron/aggregate-providers=combined-providers:list-remove(index=2, name=providers)</pre>
</div>
</div>
<div class="paragraph">
<p>You should now have OpenSSL working with Elytron.</p>
</div>
</div>
</div></div>
</div>



  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/wildflysite/"><img class="wf-logo" src="/wildflysite/assets/img/wildfly_icons_one-color-logo.png"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">WildFly is open. All dependencies of this project are available under the <a href='https://www.gnu.org/licenses/old-licenses/lgpl-2.1.en.html' class='dark-background' target='_blank'>LGPL 2.1</a> or compatible license.<br/><br/>This website was built with <a href='https://jekyllrb.com/' class='dark-background' target='_blank'>Jekyll</a> is hosted on <a href='https://pages.github.com/' class='dark-background' target='_blank'>Github Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/wildfly/wildfly.org/fork' class='dark-background' target='_blank'>fork it</a> and show us what youâ€™ve got.</p>

    
      <div class="width-1-12 project-links">
        <strong>Navigation</strong>
        <ul class="footer-links width-1-12">
          
            <li><a href="/wildflysite/downloads" class="dark-background">Downloads</a></li>
          
            <li><a href="/wildflysitef/docs" class="dark-background">Docs</a></li>
          
            <li><a href="https://github.com/wildfly/wildfly" class="dark-background">Github</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <strong>Contribute</strong>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://issues.jboss.org/browse/WFLY" class="dark-background">Submit a bug</a></li>
          
            <li><a href="https://community.jboss.org/en/wildfly?view=discussion" class="dark-background">Join the forum</a></li>
          
            <li><a href="https://github.com/wildfly/wildfly/fork" class="dark-background">Fork WildFly</a></li>
          
            <li><a href="https://twitter.com/WildFlyAS" class="dark-background">Follow us</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <strong>Get Help</strong>
        <ul class="footer-links width-1-12">
          
            <li><a href="https://community.jboss.org/en/wildfly?view=discussion" class="dark-background">Join the forum</a></li>
          
            <li><a href="https://www.hipchat.com/gFOhnVQke" class="dark-background">Join HipChat</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-6-12 more-links">
        <strong>Find more Red Hat Middleware Community Projects</strong>
        <ul class="footer-links">
          
            <li><a href="https://www.apiman.io/" class="dark-background">APIMan</a></li>
          
            <li><a href="http://arquillian.org" class="dark-background">Arquillian</a></li>
          
            <li><a href="http://byteman.jboss.org/" class="dark-background">Byteman</a></li>
          
            <li><a href="http://capedwarf.org/" class="dark-background">CapeDwarf</a></li>
          
            <li><a href="https://github.com/alechenninger/chronicler" class="dark-background">Chronicler</a></li>
          
            <li><a href="https://github.com/darcy-framework" class="dark-background">Darcy</a></li>
          
            <li><a href="http://debezium.io/" class="dark-background">Debezium</a></li>
          
            <li><a href="https://www.drools.org/" class="dark-background">Drools</a></li>
          
            <li><a href="http://gatein.jboss.org/" class="dark-background">GateIn</a></li>
          
            <li><a href="http://www.hawkular.org/" class="dark-background">Hawkular</a></li>
          
            <li><a href="http://hawt.io/" class="dark-background">Hawtio</a></li>
          
            <li><a href="http://hibernate.org/" class="dark-background">Hibernate</a></li>
          
            <li><a href="http://www.infinispan.org/" class="dark-background">Infinispan</a></li>
          
            <li><a href="https://devstudio.jboss.com/" class="dark-background">JBoss DevStudio</a></li>
          
            <li><a href="http://forge.jboss.org/" class="dark-background">JBoss Forge</a></li>
          
            <li><a href="https://github.com/jboss-logging" class="dark-background">JBoss Logging</a></li>
          
            <li><a href="http://jbossremoting.jboss.org/" class="dark-background">JBoss Remoting</a></li>
          
            <li><a href="https://www.jbpm.org/" class="dark-background">jBPM</a></li>
          
            <li><a href="https://jsfunit.jboss.org/" class="dark-background">JSFUnit</a></li>
          
            <li><a href="https://www.keycloak.org/" class="dark-background">Keycloak</a></li>
          
            <li><a href="http://modcluster.io/" class="dark-background">Mod Cluster</a></li>
          
            <li><a href="http://modeshape.jboss.org/" class="dark-background">ModeShape</a></li>
          
            <li><a href="https://www.optaplanner.org/" class="dark-background">OptaPlanner</a></li>
          
            <li><a href="https://picketbox.jboss.org/" class="dark-background">Picketbox</a></li>
          
            <li><a href="http://resteasy.jboss.org/" class="dark-background">RESTEasy</a></li>
          
            <li><a href="https://riftsaw.jboss.org/" class="dark-background">Riftsaw</a></li>
          
            <li><a href="http://savara.jboss.org/" class="dark-background">Savara</a></li>
          
            <li><a href="http://seamframework.org/" class="dark-background">Seam</a></li>
          
            <li><a href="http://arquillian.org/" class="dark-background">Shrinkwrap</a></li>
          
            <li><a href="http://snowdrop.jboss.org/" class="dark-background">Snowdrop</a></li>
          
            <li><a href="https://switchyard.jboss.org/" class="dark-background">Switchyard</a></li>
          
            <li><a href="https://tattletale.jboss.org/" class="dark-background">Tattletale</a></li>
          
            <li><a href="http://teiid.jboss.org/" class="dark-background">Teiid</a></li>
          
            <li><a href="http://wildfly-swarm.io/" class="dark-background">WildFly Swarm</a></li>
          
            <li><a href="http://wise.jboss.org/" class="dark-background">Wise</a></li>
          
            <li><a href="https://xnio.jboss.org/" class="dark-background">XNIO</a></li>
          
        </ul>
      </div>
    
  </div>
</div>
  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" class="dark-background" target="_blank">CC by 3.0</a>
    </span>
    <span class="redhat">
      a Red Hat sponsored project   
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/"><img src="/wildflysite/assets/img/RHLogo_white.svg"></a>
    </span>
  </div>
</div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script type="text/javascript" src="/wildflysite/assets/javascript/mobile-nav.js"></script>
</body>

</html>