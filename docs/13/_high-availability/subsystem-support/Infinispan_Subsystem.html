<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Infinispan_subsystem | Wildfly</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="Infinispan_subsystem" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Infinispan Subsystem" />
<meta property="og:description" content="Infinispan Subsystem" />
<link rel="canonical" href="https://jbossorg.github.io/wildflysite/docs/13/_high-availability/subsystem-support/Infinispan_Subsystem.html" />
<meta property="og:url" content="https://jbossorg.github.io/wildflysite/docs/13/_high-availability/subsystem-support/Infinispan_Subsystem.html" />
<meta property="og:site_name" content="Wildfly" />
<script type="application/ld+json">
{"description":"Infinispan Subsystem","@type":"WebPage","url":"https://jbossorg.github.io/wildflysite/docs/13/_high-availability/subsystem-support/Infinispan_Subsystem.html","headline":"Infinispan_subsystem","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/wildflysite/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://jbossorg.github.io/wildflysite/feed.xml" title="Wildfly" /></head>
<body><div class="header navigation">
  <div class="logo-wrapper">
    <a href="/wildflysite/"><img class="wf-logo" src="/wildflysite/assets/img/wildfly_icons_one-color-logo.png"></a>
  </div>
  <div class="nav-container">
    <nav>
      <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
      <ul class="nav-list">
        <li>
          <a href="/wildflysite/" class="">Home</a>
        </li>
        <li>
          <a href="/wildflysite/downloads/" class="">Downloads</a>
        </li>
        <li>
          <a href="/wildflysite/blog/" class="">Blog</a>
        </li>
        <li>
          <a href="/wildflysite/about/" class="">About</a>
        </li>
        <li>
          <a href="/wildflysite/contribute/" class="">Contribute</a>
        </li>
        <li>
          <a href="/wildflysite/docs/" class="">Docs</a>
        </li>
        <li>
          <a class="button-cta secondary" href="https://github.com/wildfly/wildfly/fork" target="_blank">Fork</a>
        </li>
      </ul>
    </nav>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="sect1">
<h2 id="Infinispan_Subsystem">Infinispan Subsystem</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Infinispan subsystem configures a set of Infinispan cache containers and cache configurations for use by WildFly clustering services.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cache-container">Cache container</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A cache container manages a set of cache configurations that share the same transport and marshalling configuration.
Cache containers returned by the Infinispan subsystem are auto-configured with the following customizations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A custom <a href="#transport">transport</a> capable of sharing a JGroups channel defined by the JGroups subsystem.</p>
</li>
<li>
<p>Uses WildFly&#8217;s mbean server, if the org.jboss.as.jmx extension is present.</p>
</li>
<li>
<p>Marshaller configured to resolve classes using JBoss Modules.</p>
</li>
<li>
<p>Marshaller configured with a set of marshalling optimizations for common JDK classes</p>
</li>
<li>
<p>Marshaller configured with additional Externalizers loadable from the configured module attribute.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>e.g. To create a new cache container that loads marshallers from the "org.bar" module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo:add(module=org.foo)</code></pre>
</div>
</div>
<div class="paragraph">
<p>A cache container may designate a specific cache as its default cache, i.e. the cache returned via <a href="http://docs.jboss.org/infinispan/9.2/apidocs/org/infinispan/manager/CacheContainer.html#getCache--">CacheContainer.getCache()</a>:</p>
</div>
<div class="paragraph">
<p>e.g. To set "bar" as the default cache of the "foo" container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo:write-attribute(name=default-cache, value=bar)</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="transport">Transport</h3>
<div class="paragraph">
<p>Configures the mechanism used by clustered caches to communicate with each other.
It is only necessary to define a transport if the cache container contains clustered caches.</p>
</div>
<div class="paragraph">
<p>To create a JGroups transport using the default channel of the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/transport=jgroups:add()</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create a JGroups transport using a distinct "alpha" channel, that uses the "tcp" stack:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=jgroups/channel=alpha:add(stack=tcp)
/subsystem=infinispan/cache-container=foo/transport=jgroups:add(channel=alpha)</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of transport attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
<div class="paragraph">
<p>To remove an existing JGroups transport, you can either use the standard remove resource operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/transport=jgroups:remove()</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203; or by adding the "none" transport (which will auto-remove any existing transport):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/transport=none:add(){allow-resource-service-restart=true}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cache-types">Cache types</h3>
<div class="paragraph">
<p>Infinispan supports a number of cache types for use in both HA and non-HA server profiles.</p>
</div>
<div class="sect3">
<h4 id="local">Local</h4>
<div class="paragraph">
<p>A local cache stores a given cache entry only on the local node.
A local cache does not require a transport, as cache reads and writes are always local.</p>
</div>
<div class="paragraph">
<p>For more information about this cache type, refer to the <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#local_mode">the Infinispan documentation</a>.</p>
</div>
<div class="paragraph">
<p>To create a local cache:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar:add()</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of local-cache attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="replicated">Replicated</h4>
<div class="paragraph">
<p>A replicated cache stores a given cache entry on every node in the cluster.
A replicated cache requires a transport, as cache writes are replicated to all nodes in the cluster on which the associated cache is running.</p>
</div>
<div class="paragraph">
<p>For more information about this cache type, refer to the <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#replicated_mode">the Infinispan documentation</a>.</p>
</div>
<div class="paragraph">
<p>To create a replicated cache:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/replicated-cache=bar:add()</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of replicated-cache attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="distributed">Distributed</h4>
<div class="paragraph">
<p>A distributed cache stores a given cache entry on a configurable number of nodes in the cluster, assigned via an algorithm based on consistent hashing.
A distributed cache requires a transport, as cache writes need to forward to each owner, and cache reads from a non-owner require a remote request.</p>
</div>
<div class="paragraph">
<p>For more information about this cache type, refer to the <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#distribution_mode">the Infinispan documentation</a>.</p>
</div>
<div class="paragraph">
<p>To create a distributed cache where a given entry is stored on 3 nodes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/distributed-cache=bar:add(owners=3)</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of distributed-cache attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="scattered">Scattered</h4>
<div class="paragraph">
<p>A scattered cache is a variation of a distributed cache that maintains 2 copies of a particular cache entry.
Consequently, it can only tolerate failure of a single node at a time.
Primary ownership of a cache entry is determined by the same mechanism used by a distributed cache,
while the backup copy is the node that last updated the entry.</p>
</div>
<div class="paragraph">
<p>This design means that a scattered cache only requires 1 remote invocation to write a given cache entry, regardless of which node initiated the cache operation.
By comparison, a distributed cache (with 2 owners) uses 1 remote invocation to write a cache entry if and only if the primary owner initiated the cache operation, and otherwise requires 2 remote invocations.</p>
</div>
<div class="paragraph">
<p>For more information about this cache type, refer to the <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#scattered_mode">the Infinispan documentation</a>.</p>
</div>
<div class="paragraph">
<p>To create a scattered cache:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/scattered-cache=bar:add()</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of scattered-cache attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="invalidation">Invalidation</h4>
<div class="paragraph">
<p>An invalidation cache is a special type of clustered cache that does not share state, but instead ensures that remote state is invalidated any time a given entry is updated locally.
An invalidation cache requires a transport, as cache writes trigger invalidation on remote nodes on which the associated cache is running.</p>
</div>
<div class="paragraph">
<p>For more information about this cache type, refer to the <a href="http://infinispan.org/docs/stable/user_guide/user_guide.html#invalidation_mode">the Infinispan documentation</a>.</p>
</div>
<div class="paragraph">
<p>To create an invalidation cache:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/invalidation-cache=bar:add()</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of invalidation-cache attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cache-features">Cache features</h3>
<div class="paragraph">
<p>The configuration of a cache is divided into several components, each defining a specific cache feature.
Because a given cache configuration requires each component relevant to its cache type, cache add operations and cache component add operations are typically batched.
Any undefined components are auto-created using their defaults.</p>
</div>
<div class="paragraph">
<p>e.g. The following cache add operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar:add()</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203; is actually equivalent to the following sequence of operations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>batch
/subsystem=infinispan/cache-container=foo/local-cache=bar:add()
/subsystem=infinispan/cache-container=foo/local-cache=bar/component=expiration:add()
/subsystem=infinispan/cache-container=foo/local-cache=bar/component=locking:add()
/subsystem=infinispan/cache-container=foo/local-cache=bar/component=transaction:add()
/subsystem=infinispan/cache-container=foo/local-cache=bar/memory=object:add()
/subsystem=infinispan/cache-container=foo/local-cache=bar/store=none:add()
run-batch</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, you can reset all the attributes of a component by simply removing the component.
e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar:component=expiration:remove(){allow-resource-service-restart=true}</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203; is equivalent to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar:component=expiration:remove(){allow-resource-service-restart=true}
/subsystem=infinispan/cache-container=foo/local-cache=bar:component=expiration:add(){allow-resource-service-restart=true}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="memory">Memory</h4>
<div class="paragraph">
<p>An Infinispan cache can be configured to store cache entries as Java objects or as binary data (i.e. byte[]), either on or off the JVM heap.
The type of storage used has semantic implications for the user of the cache.
When using object storage, the cache has store-as-reference semantics, whereas when using binary storage the cache has call-by-value semantics.
Consider the following logic:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">List&lt;String&gt; list = new ArrayList&lt;&gt;();
cache.startBatch();
cache.put("a", list);
list.add("test");
cache.endBatch(true);

List&lt;String&gt; result = cache.get("a");
System.out.println(result.size());</code></pre>
</div>
</div>
<div class="paragraph">
<p>How many elements are in the "result" list? The answer depends on how the cache is configured.</p>
</div>
<div class="paragraph">
<p>When the cache is configured to use object memory, our result list has 1 element.
When the cache is configured to use binary (or off-heap) memory, our result list is empty.
When using binary memory, the cache value must be marshalled to a byte[] on write and unmarshalled on read, thus any mutations of the cache value in the interim are not reflected in the cache.</p>
</div>
<div class="sect4">
<h5 id="object-storage">Object storage</h5>
<div class="paragraph">
<p>When using object storage, cache keys and values are stored as Java object references.
Object storage may be configured with a maximum size.
When the number of entries in the cache exceeds this threshold, the least recently used entries are evicted from memory.</p>
</div>
<div class="paragraph">
<p>e.g. To store a maximum of 100 objects in the Java heap:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar/memory=object:add(size=100)</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of memory=object attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
</div>
<div class="sect4">
<h5 id="binary-storage-on-heap">Binary storage (on-heap)</h5>
<div class="paragraph">
<p>When using binary storage, each cache entry is stored as a byte[] within the JVM heap.
Binary storage may also be configured with a maximum size.
This size can be specified either as a maximum number of entries (i.e. COUNT), or as a maximum number of bytes (i.e. MEMORY).
When the number of entries in the cache exceeds this threshold, the least recently used entries are evicted from memory.</p>
</div>
<div class="paragraph">
<p>e.g. To store a maximum of 1 MB of binary data in the Java heap:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar/memory=binary:add(size=1048576, eviction-type=MEMORY)</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of memory=binary attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
</div>
<div class="sect4">
<h5 id="off-heap-binary-storage">Off-heap binary storage</h5>
<div class="paragraph">
<p>When using off-heap storage, each cache entry is stored as a byte[] in native memory allocated via sun.misc.Unsafe.
Off-heap memory storage may also be configured with a maximum size, specified either as a maximum number of entries (i.e. COUNT), or as a maximum number of bytes (i.e. MEMORY).
When the number of entries in the cache exceeds this threshold, the least recently used entries are evicted from memory.</p>
</div>
<div class="paragraph">
<p>e.g. To store a maximum of 1 GB of binary data in native memory outside of the Java heap:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar/memory=off-heap:add(size=1073741824)</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of memory=off-heap attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="transactions">Transactions</h4>
<div class="paragraph">
<p>An Infinispan cache can be configured as transactional or non-transactional.
This behavior is determined by the mode attribute, which supports the following values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">NONE</dt>
<dd>
<p>Non-transactional cache (the default behavior).</p>
</dd>
<dt class="hdlist1">BATCH</dt>
<dd>
<p>Transactional cache using a local Infinispan transaction manager.
Infinispan transactions are started/committed/rolled-back using <a href="http://docs.jboss.org/infinispan/9.2/apidocs/org/infinispan/commons/api/BatchingCache.html">Infinispan&#8217;s batching API</a>.</p>
</dd>
<dt class="hdlist1">NON_XA</dt>
<dd>
<p>Transactional cache configured to use the server&#8217;s transaction manager, registering as a Synchronization to the current transaction.
Cache commit/rollback happens after the associated transaction completes.</p>
</dd>
<dt class="hdlist1">NON_DURABLE_XA</dt>
<dd>
<p>Transactional cache configured to use the server&#8217;s transaction manager, enlisting as an XAResource to the current transaction, but without transaction recovery support.</p>
</dd>
<dt class="hdlist1">FULL_XA</dt>
<dd>
<p>Transactional cache configured to use the server&#8217;s transaction manager, with full transaction recovery support.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Within the context of a transaction, cache write operations must obtain a lock on the affected keys.
Locks may be acquired either pessimistically (the default), i.e. before invoking the operation, or optimistically, i.e. before transaction commit.</p>
</div>
<div class="paragraph">
<p>e.g. To configure a transactional cache using local Infinispan transactions with OPTIMISTIC locking:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar/component=transaction(mode=BATCH, locking=OPTIMISTIC)</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of transaction attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="locking">Locking</h4>
<div class="paragraph">
<p>Within the context of a transaction, entries read from the cache are isolated from other concurrent transactions according to the configured isolation level.
Infinispan supports the following transaction isolation levels:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">READ_COMMITTED</dt>
<dd>
<p>A cache read may return a different value than a previous read within the same transaction, even if a concurrent transaction updated the entry.
This is the default isolation level.</p>
</dd>
<dt class="hdlist1">REPEATABLE_READ</dt>
<dd>
<p>A cache read will return the same value as a previous read within the same transaction, even if a concurrent transaction updated the entry.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Cache reads are always lock-free unless invoked using Flag.FORCE_WRITE_LOCK.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>e.g. To configure a cache using REPEATABLE_READ isolation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar/component=locking(isolation=REPEATABLE_READ)</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of locking attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="expiration">Expiration</h4>
<div class="paragraph">
<p>The expiration component configures expiration defaults for cache entries.
Cache entries may be configured to expire after some duration since creation (i.e. lifespan) or since last accessed (i.e. max-idle).</p>
</div>
<div class="paragraph">
<p>e.g. To configure expiration of entries older than 1 day, or that have not been accessed within the past hour:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar/component=expiration(lifespan=86400000, max-idle=3600000)</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
max-idle based expiration is not generally safe for use with clustered caches, as the meta data of a cache entry is not replicated by cache read operations
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For a complete list of expiration attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="persistence">Persistence</h4>
<div class="paragraph">
<p>An Infinispan cache can optionally load/store cache entries from an external storage.
All cache stores support the following attributes:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">fetch-state</dt>
<dd>
<p>Indicates whether to refresh persistent state from cluster members on cache start.
Does not apply to a local or invalidation cache, nor a shared store.
Default is true.</p>
</dd>
<dt class="hdlist1">passivation</dt>
<dd>
<p>Indicates whether cache entries should only be persisted upon eviction from memory.
Default is true.</p>
</dd>
<dt class="hdlist1">preload</dt>
<dd>
<p>Indicates whether cache entries should be loaded into memory on cache start.
Default is false.</p>
</dd>
<dt class="hdlist1">purge</dt>
<dd>
<p>Indicates whether the cache store should be purged on cache start.
Purge should never be enabled on a shared store.
Default is true.</p>
</dd>
<dt class="hdlist1">shared</dt>
<dd>
<p>Indicates that the same cache store endpoint (e.g. database, data grid, etc.) is used by all members of the cluster.
When using a shared cache store, cache entries are only persisted by the primary owner of a given cache entry.
Default is false.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>To remove an existing cache store, you can either use the standard resource remove operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar/store=file:remove()</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203; or by adding the "none" store (which auto-removes any existing store):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar/store=none:add(){allow-resource-service-restart=true}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="file-store">File store</h5>
<div class="paragraph">
<p>A file store persists cache entries to the local filesystem.
By default, files are stored in a file named "<em>cache-name</em>.dat" within a subdirectory named "infinispan/<em>container-name</em>" relative to the server&#8217;s data directory.</p>
</div>
<div class="paragraph">
<p>e.g. To persist cache entries to $HOME/foo/bar.dat:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar/store=file:add(path=foo, relative-to=user.home)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="jdbc-store">JDBC store</h5>
<div class="paragraph">
<p>A JDBC store persists cache entries to a database.</p>
</div>
<div class="paragraph">
<p>e.g. To persist cache entries to an H2 database via the ExampleDS data-source:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar/store=jdbc:add(data-source=ExampleDS, dialect=H2)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="remote-cache-store">Remote cache store</h5>
<div class="paragraph">
<p>A remote store persists cache entries to a set of remote Infinispan server instances via the HotRod protocol.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=node1:add(host=server1, port=1000)
/socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=node2:add(host=server2, port=1000)
/subsystem=infinispan/cache-container=foo/local-cache=bar/store=remote:add(remote-servers=[node1,node2])</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="state-transfer">State transfer</h4>
<div class="paragraph">
<p>The state transfer component defines the behavior for the initial transfer of state from remote caches on cache start.
State transfer is only applicable to distributed and replicated caches.
When configured with a timeout, a cache is only available after its initial state transfer completes.
If state transfer does not complete within the configured timeout, the cache will fail to start.</p>
</div>
<div class="paragraph">
<p>e.g. To configure a state-transfer timeout of 1 minute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar/component=state-transfer:add(timeout=60000)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, state transfer can be configured to be non-blocking, by configuring a timeout of 0.
While this prevents timeouts due to large state transfers, cache operations on the new node will require remote invocations to retrieve the requisite state until state transfer is complete.</p>
</div>
<div class="paragraph">
<p>e.g. To configure a non-blocking state transfer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/subsystem=infinispan/cache-container=foo/local-cache=bar/component=state-transfer:add(timeout=0)</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a complete list of state-transfer attributes, refer to the <a href="https://wildscribe.github.io/">WildFly management model documentation</a></p>
</div>
</div>
</div>
</div>
</div>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/wildflysite/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Wildfly</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Wildfly</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wildfly"><svg class="svg-icon"><use xlink:href="/wildflysite/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wildfly</span></a></li><li><a href="https://www.twitter.com/WildFlyAS"><svg class="svg-icon"><use xlink:href="/wildflysite/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">WildFlyAS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
