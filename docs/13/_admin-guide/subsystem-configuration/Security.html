<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Security subsystem configuration | Wildfly</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="Security subsystem configuration" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/subsystem-configuration/Security.html" />
<meta property="og:url" content="https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/subsystem-configuration/Security.html" />
<meta property="og:site_name" content="Wildfly" />
<script type="application/ld+json">
{"@type":"WebPage","url":"https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/subsystem-configuration/Security.html","headline":"Security subsystem configuration","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/wildflysite/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://jbossorg.github.io/wildflysite/feed.xml" title="Wildfly" /></head>
<body><div class="header navigation">
  <div class="logo-wrapper">
    <a href="/wildflysite/"><img class="wf-logo" src="/wildflysite/assets/img/wildfly_icons_one-color-logo.png"></a>
  </div>
  <div class="nav-container">
    <nav>
      <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
      <ul class="nav-list">
        <li>
          <a href="/wildflysite/" class="">Home</a>
        </li>
        <li>
          <a href="/wildflysite/downloads/" class="">Downloads</a>
        </li>
        <li>
          <a href="/wildflysite/blog/" class="">Blog</a>
        </li>
        <li>
          <a href="/wildflysite/about/" class="">About</a>
        </li>
        <li>
          <a href="/wildflysite/contribute/" class="">Contribute</a>
        </li>
        <li>
          <a href="/wildflysite/docs/" class="">Docs</a>
        </li>
        <li>
          <a class="button-cta secondary" href="https://github.com/wildfly/wildfly/fork" target="_blank">Fork</a>
        </li>
      </ul>
    </nav>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The security subsystem is the subsystem that brings the security
services provided by <a href="http://www.jboss.org/picketbox">PicketBox</a> to the
WildFly {wildflyVersion} server instances.</p>
</div>
<div class="paragraph">
<p>If you are looking to secure the management interfaces for the
management of the domain then you should read the
<a href="#Security_Realms">Securing the Management Interfaces</a> chapter as the
management interfaces themselves are not run within a WildFly process so
use a custom configuration.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="structure-of-the-security-subsystem">Structure of the Security Subsystem</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When deploying applications to WildFly most of the time it is likely
that you would be deploying a web application or EJBs and just require a
security domain to be defined with login modules to verify the users
identity, this chapter aims to provide additional detail regarding the
architecture and capability of the security subsystem however if you are
just looking to define a security domain and leave the rest to the
container please jump to the
<a href="#security-domains">security-domains</a>
section.</p>
</div>
<div class="paragraph">
<p>The security subsystem operates by using a security context associated
with the current request, this security context then makes available to
the relevant container a number of capabilities from the configured
security domain, the capabilities exposed are an authentication manager,
an authorization manager, an audit manager and a mapping manager.</p>
</div>
<div class="sect2">
<h3 id="security-authentication-manager">Authentication Manager</h3>
<div class="paragraph">
<p>The authentication manager is the component that performs the actual
authentication taking the declared users identity and their credential
so that the login context for the security domain can be used to 'login'
the user using the configured login module or modules.</p>
</div>
</div>
<div class="sect2">
<h3 id="security-authorization-manager">Authorization Manager</h3>
<div class="paragraph">
<p>The authorization manager is a component which can be obtained by the
container from the current security context to either obtain information
about a users roles or to perform an authorization check against a
resource for the currently authenticated user.</p>
</div>
</div>
<div class="sect2">
<h3 id="audit-manager">Audit Manager</h3>
<div class="paragraph">
<p>The audit manager from the security context is the component that can be
used to log audit events in relation to the security domain.</p>
</div>
</div>
<div class="sect2">
<h3 id="mapping-manager">Mapping Manager</h3>
<div class="paragraph">
<p>The mapping manager can be used to assign additional principals,
credentials, roles or attributes to the authenticated subject.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security-subsystem-configuration">Security Subsystem Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default a lot of defaults have already been selected for the security
subsystem and unless there is a specific implementation detail you need
to change, these defaults should not require modification. This chapter
describes all of the possible configuration attributes for completeness
but do keep in mind that not all will need to be changed.</p>
</div>
<div class="paragraph">
<p>The security subsystem is enabled by default by the addition of the
following extension: -<br>
<br>
&lt;extension module="org.jboss.as.security"/&gt;</p>
</div>
<div class="paragraph">
<p>The namespace used for the configuration of the security subsystem is
urn:jboss:domain:security:1.0, the configuration is defined within the
&lt;subsystem&gt; element from this namespace.</p>
</div>
<div class="paragraph">
<p>The &lt;subsystem&gt; element can optionally contain the following child
elements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>security-management</p>
</li>
<li>
<p>subject-factory</p>
</li>
<li>
<p>security-domains</p>
</li>
<li>
<p>security-properties</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="security-management">security-management</h3>
<div class="paragraph">
<p>This element is used to override some of the high level implementation
details of the PicketBox implementation if you have a need to change
some of this behaviour.</p>
</div>
<div class="paragraph">
<p>The element can have any or the following attributes set, all of which
are optional.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">authentication-manager-class-name</th>
<th class="tableblock halign-left valign-top">Specifies the AuthenticationManager
implementation class name to use.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deep-copy-subject-mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the copy mode of subjects done by the
security managers to be deep copies that makes copies of the subject
principals and credentials if they are cloneable. It should be set to
true if subject include mutable content that can be corrupted when
multiple threads have the same identity and cache flushes/logout
clearing the subject in one thread results in subject references
affecting other threads. Default value is "false".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-callback-handler-class-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a global class name for
the CallbackHandler implementation to be used with login modules.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">authorization-manager-class-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute specifies the
AuthorizationManager implementation class name to use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">audit-manager-class-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the AuditManager implementation
class name to use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">identity-trust-manager-class-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the IdentityTrustManager
implementation class name to use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mapping-manager-class-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the MappingManager implementation
class name to use.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="subject-factory">subject-factory</h3>
<div class="paragraph">
<p>The subject factory is responsible for creating subject instances, this
also makes use of the authentication manager to actually verify the
caller. It is used mainly by JCA components to establish a subject. It
is not likely this would need to be overridden but if it is required the
"subject-factory-class-name" attribute can be specified on the
subject-factory element.</p>
</div>
</div>
<div class="sect2">
<h3 id="security-domains">security-domains</h3>
<div class="paragraph">
<p>This portion of the configuration is where the bulk of the security
subsystem configuration will actually take place for most
administrators, the security domains contain the configuration which is
specific to a deployment.</p>
</div>
<div class="paragraph">
<p>The security-domains element can contain numerous &lt;security-domain&gt;
definitions, a security-domain can have the following attributes set:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">The unique name of this security domain.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">extends</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Although version 1.0 of the security subsystem schema
contained an 'extends' attribute, security domain inheritance is not
supported and this attribute should not be used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of authentication cache to use with this domain.
If this attribute is removed no cache will be used. Allowed values are
"default" or "infinispan"</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following elements can then be set within the security-domain to
configure the domain behaviour.</p>
</div>
<div class="sect3">
<h4 id="authentication">authentication</h4>
<div class="paragraph">
<p>The authentication element is used to hold the list of login modules
that will be used for authentication when this domain is used, the
structure of the login-module element is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">&lt;login-module code="..." flag="..." module="..."&gt;
  &lt;module-option name="..." value="..."/&gt;
&lt;/login-module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code attribute is used to specify the implementing class of the
login module which can either be the full class name or one of the
abbreviated names from the following list:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Classname</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.ClientLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Certificate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.BaseCertLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CertificateUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.BaseCertLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CertificateRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.CertRolesLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.DatabaseServerLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DatabaseCertificate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.DatabaseCertLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DatabaseUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.DatabaseServerLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.IdentityLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ldap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.LdapLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LdapExtended</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.LdapExtLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RoleMapping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.RoleMappingLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RunAs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.RunAsLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Simple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.SimpleServerLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ConfiguredIdentity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.picketbox.datasource.security.ConfiguredIdentityLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SecureIdentity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.picketbox.datasource.security.SecureIdentityLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PropertiesUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.PropertiesUsersLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SimpleUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.SimpleUsersLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LdapUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.LdapUsersLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kerberos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.sun.security.auth.module.Krb5LoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPNEGOUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.negotiation.spnego.SPNEGOLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AdvancedLdap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.negotiation.AdvancedLdapLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AdvancedADLdap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.negotiation.AdvancedADLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UsersRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.UsersRolesLoginModule</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The module attribute specifies the name of the JBoss Modules module from
which the class specified by the code attribute should be loaded.
Specifying it is not necessary if one of the abbreviated names in the
above list is used.</p>
</div>
<div class="paragraph">
<p>The flag attribute is used to specify the JAAS flag for this module and
should be one of required, requisite, sufficient, or optional.</p>
</div>
<div class="paragraph">
<p>The module-option element can be repeated zero or more times to specify
the module options as required for the login module being configured. It
requires the name and value attributes.</p>
</div>
</div>
<div class="sect3">
<h4 id="authentication-jaspi">authentication-jaspi</h4>
<div class="paragraph">
<p>The authentication-jaspi is used to configure a Java Authentication SPI
(JASPI) provider as the authentication mechanism. A security domain can
have either a &lt;authentication&gt; or a &lt;authentication-jaspi&gt; element, but
not both. We set up JASPI by configuring one or more login modules
inside the login-module-stack element and setting up an authentication
module. Here is the structure of the authentication-jaspi element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;login-module-stack name="..."&gt;
  &lt;login-module code="..." flag="..." module="..."&gt;
    &lt;module-option name="..." value="..."/&gt;
  &lt;/login-module&gt;
&lt;/login-module-stack&gt;
&lt;auth-module code="..." login-module-stack-ref="..."&gt;
  &lt;module-option name="..." value="..."/&gt;
&lt;/auth-module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The login-module-stack-ref attribute value must be the name of the
login-module-stack element to be used. The sub-element login-module is
configured just like in the
<a href="#authentication">authentication</a>
part</p>
</div>
</div>
<div class="sect3">
<h4 id="authorization">authorization</h4>
<div class="paragraph">
<p>Authorization in the AS container is normally done with RBAC (role based
access control) but there are situations where a more fine grained
authorization policy is required. The authorization element allows
definition of different authorization modules to used, such that
authorization can be checked with JACC (Java Authorization Contract for
Containers) or XACML (eXtensible Access Control Markup Language). The
structure of the authorization element is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;policy-module code="..." flag="..." module="..."&gt;
  &lt;module-option name="..." value="..."/&gt;
&lt;/policy-module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code attribute is used to specify the implementing class of the
policy module which can either be the full class name or one of the
abbreviated names from the following list:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Classname</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DenyAll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.authorization.modules.AllDenyAuthorizationModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PermitAll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.authorization.modules.AllPermitAuthorizationModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delegating</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.authorization.modules.DelegatingAuthorizationModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.authorization.modules.WebAuthorizationModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JACC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.authorization.modules.JACCAuthorizationModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XACML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.authorization.modules.XACMLAuthorizationModule</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The module attribute specifies the name of the JBoss Modules module from
which the class specified by the code attribute should be loaded.
Specifying it is not necessary if one of the abbreviated names in the
above list is used.</p>
</div>
<div class="paragraph">
<p>The flag attribute is used to specify the JAAS flag for this module and
should be one of required, requisite, sufficient, or optional.</p>
</div>
<div class="paragraph">
<p>The module-option element can be repeated zero or more times to specify
the module options as required for the login module being configured. It
requires the name and value attributes.</p>
</div>
</div>
<div class="sect3">
<h4 id="mapping">mapping</h4>
<div class="paragraph">
<p>The mapping element defines additional mapping of principals,
credentials, roles and attributes for the subject. The structure of the
mapping element is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;mapping-module type="..."code="..." module="..."&gt;
  &lt;module-option name="..." value="..."/&gt;
&lt;/mapping-module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The type attribute reflects the type of mapping of the provider and
should be one of principal, credential, role or attribute. By default
"role" is the type used if the attribute is not set.</p>
</div>
<div class="paragraph">
<p>The code attribute is used to specify the implementing class of the
login module which can either be the full class name or one of the
abbreviated names from the following list:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Classname</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PropertiesRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.mapping.providers.role.PropertiesRolesMappingProvider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SimpleRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.mapping.providers.role.SimpleRolesMappingProvider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DeploymentRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.mapping.providers.DeploymentRolesMappingProvider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DatabaseRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.mapping.providers.role.DatabaseRolesMappingProvider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LdapRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.mapping.providers.role.LdapRolesMappingProvider</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The module attribute specifies the name of the JBoss Modules module from
which the class specified by the code attribute should be loaded.
Specifying it is not necessary if one of the abbreviated names in the
above list is used.</p>
</div>
<div class="paragraph">
<p>The module-option element can be repeated zero or more times to specify
the module options as required for the login module being configured. It
requires the name and value attributes.</p>
</div>
</div>
<div class="sect3">
<h4 id="audit">audit</h4>
<div class="paragraph">
<p>The audit element can be used to define a custom audit provider. The
default implementation used is
<code>org.jboss.security.audit.providers.LogAuditProvider</code>. The structure of
the audit element is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;provider-module code="..." module="..."&gt;
  &lt;module-option name="..." value="..."/&gt;
&lt;/provider-module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code attribute is used to specify the implementing class of the
provider module.</p>
</div>
<div class="paragraph">
<p>The module attribute specifies the name of the JBoss Modules module from
which the class specified by the code attribute should be loaded.</p>
</div>
<div class="paragraph">
<p>The module-option element can be repeated zero or more times to specify
the module options as required for the login module being configured. It
requires the name and value attributes.</p>
</div>
</div>
<div class="sect3">
<h4 id="jsse">jsse</h4>
<div class="paragraph">
<p>The jsse element defines configuration for keystores and truststores
that can be used for SSL context configuration or for certificate
storing/retrieving.</p>
</div>
<div class="paragraph">
<p>The set of attributes (all of them optional) of this element are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">keystore-password</th>
<th class="tableblock halign-left valign-top">Password of the keystore</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type of the keystore. By default it&#8217;s "JKS"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL where the keystore file can be found</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider of the keystore. The default JDK provider
for the keystore type is used if this attribute is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-provider-argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String that can be passed as the argument
of the keystore Provider constructor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key-manager-factory-algorithm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Algorithm of the KeyManagerFactory. The
default JDK algorithm of the key manager factory is used if this
attribute is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key-manager-factory-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider of the KeyManagerFactory. The
default JDK provider for the key manager factory algorithm is used if
this attribute is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">truststore-password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password of the truststore</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">truststore-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type of the truststore. By deafult it&#8217;s "JKS"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">truststore-url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL where the truststore file can be found</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">truststore-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider of the truststore. The default JDK
provider for the truststore type is used if this attribute is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">truststore-provider-argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String that can be passed as the argument
of the truststore Provider constructor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">trust-manager-factory-algorithm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Algorithm of the TrustManagerFactory.
The default JDK algorithm of the trust manager factory is used if this
attribute is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">trust-manager-factory-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider of the TrustManagerFactory.
The default JDK provider for the trust manager factory algorithm is used
if this attribute is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">client-alias</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alias of the keystore to be used when creating client
side SSL sockets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">server-alias</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alias of the keystore to be used when creating server
side SSL sockets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">service-auth-token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Validation token to enable third party services to
retrieve a keystore Key. This is typically used to retrieve a private
key for signing purposes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">client-auth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flag to indicate if the server side SSL socket should
require client authentication. Default is "false"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cipher-suites</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma separated list of cipher suites to be used by a
SSLContext</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">protocols</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma separated list of SSL protocols to be used by a
SSLContext</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The optional additional-properties element can be used to include other
options. The structure of the jsse element is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;jsse keystore-url="..." keystore-password="..." keystore-type="..." keystore-provider="..." keystore-provider-argument="..." key-manager-factory-algorithm="..." key-manager-factory-provider="..." truststore-url="..." truststore-password="..." truststore-type="..." truststore-provider="..." truststore-provider-argument="..." trust-manager-factory-algorithm="..." trust-manager-factory-provider="..." client-alias="..." server-alias="..." service-auth-token="..." client-auth="..." cipher-suites="..." protocols="..."&gt;
  &lt;additional-properties&gt;x=y
    a=b
  &lt;/additional-properties&gt;
&lt;/jsse&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="security-properties">security-properties</h3>
<div class="paragraph">
<p>This element is used to specify additional properties as required by the
security subsystem, properties are specified in the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;security-properties&gt;
  &lt;property name="..." value="..."/&gt;
&lt;/security-properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The property element can be repeated as required for as many properties
need to be defined.</p>
</div>
<div class="paragraph">
<p>Each property specified is set on the <code>java.security.Security</code> class.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Security_Authentication_Modules">Authentication Modules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section we will describe each login module&#8217;s options available.</p>
</div>
<div class="sect2">
<h3 id="client">Client</h3>
<div class="paragraph">
<p>This login module is designed to establish caller identity and
credentials when WildFly is acting a client. It should never be used as
part of a security domain used for actual server authentication.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">multi-threaded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to true if each thread has its own
principal and credential storage. Set to false to indicate that all
threads in the VM share the same identity and credential. Default is
false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">restore-login-identity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to true if the identity and
credential seen at the start of the login() method should be restored
after the logout() method is invoked. Default is false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password-stacking</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to useFirstPass to indicate that this
login module should look for information stored in the LoginContext to
use as the identity. This option can be used when stacking other login
modules with this one. Default is false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="database">Database</h3>
<div class="paragraph">
<p>This login module is designed to be used for authenticating users
against a database backend.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dsJndiName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JNDI name of the datasource containing the tables
for users and roles</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">principalsQuery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL prepared statement to be executed in
order to match the password. Default is select Password from Principals
where PrincipalID=?</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rolesQuery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL prepared statement to be executed in order to
map roles. It should be an equivalent to select Role, RoleGroup from
Roles where PrincipalID=?, where Role is the role name and RoleGroup
column value should always be "Roles" with capital R.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">suspendResume</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A boolean flag that specifies that any
existing JTA transaction be suspended during DB operations. The default
is true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="certificate">Certificate</h3>
<div class="paragraph">
<p>This login module is designed to authenticate users based on
X509Certificates. A use case for this is CLIENT-CERT authentication of a
web application.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">securityDomain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the security domain that has the jsse
configuration for the truststore holding the trusted certificates</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">verifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The class name of the
org.jboss.security.auth.certs.X509CertificateVerifier to use for
verification of the login certificate</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If there is no verifier set, this login module will try to validate the
user&#8217;s certificate with a public certificate stored in the truststore.
The public certificate must be stored in the truststore using the DN of
the certificate as the truststore alias.</p>
</div>
</div>
<div class="sect2">
<h3 id="certificateroles">CertificateRoles</h3>
<div class="paragraph">
<p>This login module extends the Certificate login module to add role
mapping capabilities from a properties file. It has the same options
plus these additional options:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rolesProperties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the resource/file containing the
roles to assign to each user. Default is roles.properties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultRolesProperties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the resource/file to fall
back to if the rolesProperties file can&#8217;t be found. Default is
defaultRoles.properties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">roleGroupSeperator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Character to use as the role group
separator in the role properties file. Default character is '.' (period)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The role properties file must be in the format username=role1,role2
where the username is the DN of the certificate, escaping any equals and
space characters. Here is an example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CN\=unit-tests-client,\ OU\=JBoss\ Inc.,\ O\=JBoss\ Inc.,\ ST\=Washington,\ C\=US=JBossAdmin</pre>
</div>
</div>
<div class="paragraph">
<p>This would assign the <em>JBossAdmin</em> role to an user that presents a
certificate with <em>CN=unit-tests-client, OU=JBoss Inc., O=JBoss Inc.,
ST=Washington, C=US</em> as the DN.</p>
</div>
</div>
<div class="sect2">
<h3 id="databasecertificate">DatabaseCertificate</h3>
<div class="paragraph">
<p>This login module extends the Certificate login to add role mapping
capabilities from a database table. It has the same options plus these
additional options:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dsJndiName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JNDI name of the datasource containing the tables
for users and roles</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rolesQuery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL prepared statement to be executed in order to
map roles. It should be an equivalent to select Role, RoleGroup from
Roles where PrincipalID=?, where Role is the role name and RoleGroup
column value should always be "Roles" with capital R. Default is select
Role, RoleGroup from Roles where PrincipalID=?</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">suspendResume</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A boolean flag that specifies that any
existing JTA transaction be suspended during DB operations. The default
is <strong>true</strong>
select Role, RoleGroup from Roles where PrincipalID=?</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/wildflysite/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Wildfly</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Wildfly</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wildfly"><svg class="svg-icon"><use xlink:href="/wildflysite/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wildfly</span></a></li><li><a href="https://www.twitter.com/WildFlyAS"><svg class="svg-icon"><use xlink:href="/wildflysite/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">WildFlyAS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
