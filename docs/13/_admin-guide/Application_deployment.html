<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Application deployment | Wildfly</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="Application deployment" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/Application_deployment.html" />
<meta property="og:url" content="https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/Application_deployment.html" />
<meta property="og:site_name" content="Wildfly" />
<script type="application/ld+json">
{"@type":"WebPage","url":"https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/Application_deployment.html","headline":"Application deployment","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/wildflysite/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://jbossorg.github.io/wildflysite/feed.xml" title="Wildfly" /></head>
<body><div class="header navigation">
  <div class="logo-wrapper">
    <a href="/wildflysite/"><img class="wf-logo" src="/wildflysite/assets/img/wildfly_icons_one-color-logo.png"></a>
  </div>
  <div class="nav-container">
    <nav>
      <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
      <ul class="nav-list">
        <li>
          <a href="/wildflysite/" class="">Home</a>
        </li>
        <li>
          <a href="/wildflysite/downloads/" class="">Downloads</a>
        </li>
        <li>
          <a href="/wildflysite/blog/" class="">Blog</a>
        </li>
        <li>
          <a href="/wildflysite/about/" class="">About</a>
        </li>
        <li>
          <a href="/wildflysite/contribute/" class="">Contribute</a>
        </li>
        <li>
          <a href="/wildflysite/docs/" class="">Docs</a>
        </li>
        <li>
          <a class="button-cta secondary" href="https://github.com/wildfly/wildfly/fork" target="_blank">Fork</a>
        </li>
      </ul>
    </nav>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div id="preamble">
<div class="sectionbody">
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="managed-domain">Managed Domain</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In a managed domain, deployments are associated with a <code>server-group</code>
(see ﻿ <a href="#Core_management_concepts">Core management concepts</a>).
Any server within the server group will then be provided with that
deployment.</p>
</div>
<div class="paragraph">
<p>The domain and host controller components manage the distribution of
binaries across network boundaries.</p>
</div>
<div class="sect2">
<h3 id="deployment-commands">Deployment Commands</h3>
<div class="paragraph">
<p>Distributing deployment binaries involves two steps: uploading the
deployment to the repository the domain controller will use to
distribute its contents, and then assigning the deployment to one or
more server groups.</p>
</div>
<div class="paragraph">
<p>You can do this in one sweep with the CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[domain@localhost:9990 /] deploy ~/Desktop/test-application.war
Either --all-server-groups or --server-groups must be specified.
 
[domain@localhost:9990 /] deploy ~/Desktop/test-application.war --all-server-groups
'test-application.war' deployed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The deployment will be available to the domain controller, assigned to a
server group, and deployed on all running servers in that group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[domain@localhost:9990 /] :read-children-names(child-type=deployment)
{
   "outcome" =&gt; "success",
   "result" =&gt; [
       "mysql-connector-java-5.1.15.jar",
       "test-application.war"
   ]
}
 
[domain@localhost:9990 /] /server-group=main-server-group/deployment=test-application.war:read-resource(include-runtime)
{
   "outcome" =&gt; "success",
   "result" =&gt; {
       "enabled" =&gt; true,
       "name" =&gt; "test-application.war",
       "managed" =&gt; true,
       "runtime-name" =&gt; "test-application.war"
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you only want the deployment deployed on servers in some server
groups, but not all, use the <code>--server-groups</code> parameter instead of
<code>-all-server-groups</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[domain@localhost:9990 /] deploy ~/Desktop/test-application.war --server-groups=main-server-group,another-group
'test-application.war' deployed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you have a new version of the deployment that you want to deploy
replacing an existing one, use the <code>--force</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[domain@localhost:9990 /] deploy ~/Desktop/test-application.war --all-server-groups --force
'test-application.war' deployed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can remove binaries from server groups with the <code>undeploy</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[domain@localhost:9990 /] undeploy test-application.war --all-relevant-server-groups
Successfully undeployed test-application.war.
 
[domain@localhost:9990 /] /server-group=main-server-group:read-children-names(child-type=deployment)
{
   "outcome" =&gt; "success",
   "result" =&gt; []
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you only want to undeploy from some server groups but not others, use
the <code>-</code> <code>server-groups</code> parameter instead of
<code>-all-relevant-server-groups</code>.</p>
</div>
<div class="paragraph">
<p>The CLI <code>deploy</code> command supports a number of other parameters that can
control behavior. Use the <code>--help</code> parameter to learn more:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[domain@localhost:9990 /] deploy --help
[...]</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Managing deployments through the web interface provides an alternate,
sometimes simpler approach.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="exploded-managed-deployments">Exploded managed deployments</h3>
<div class="paragraph">
<p>Managed and unmanaged deployments can be 'exploded', i.e. on the
filesystem in the form of a directory structure whose structure
corresponds to an unzipped version of the archive. An exploded
deployment can be convenient to administer if your administrative
processes involve inserting or replacing files from a base version in
order to create a version tailored for a particular use (for example,
copy in a base deployment and then copy in a jboss-web.xml file to
tailor a deployment for use in WildFly.) Exploded deployments are also
nice in some development scenarios, as you can replace static content
(e.g. .html, .css) files in the deployment and have the new content
visible immediately without requiring a redeploy.</p>
</div>
<div class="paragraph">
<p>Since unmanaged deployment content is directly in your charge, the
following operations only make sense for a managed deployment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[domain@localhost:9990 /] /deployment=exploded.war:add(content=[{empty=true}])</pre>
</div>
</div>
<div class="paragraph">
<p>This will create an empty exploded deployment to which you&#8217;ll be able to
add content. The <strong>empty</strong> content parameter is required to check that you
really intend to create an empty deployment and not just forget to
define the content.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[domain@localhost:9990 /] /deployment=kitchensink.ear:explode()</pre>
</div>
</div>
<div class="paragraph">
<p>This will 'explode' an existing archive deployment to its exploded
format. This operation is not recursive so you need to explode the
sub-deployment if you want to be able to manipulate the sub-deployment
content. You can do this by specifying the sub-deployment archive <strong>path</strong>
as a parameter to the explode operation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[domain@localhost:9990 /] /deployment=kitchensink.ear:explode(path=wildfly-kitchensink-ear-web.war)</pre>
</div>
</div>
<div class="paragraph">
<p>Now you can add or remove content to your exploded deployment. Note that
per-default this will overwrite existing contents, you can specify the
overwrite parameter to make the operation fail if the content already
exists.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[domain@localhost:9990 /] /deployment=exploded.war:add-content(content=[{target-path=WEB-INF/classes/org/jboss/as/test/deployment/trivial/ServiceActivatorDeployment.class, input-stream-index=/home/demo/org/jboss/as/test/deployment/trivial/ServiceActivatorDeployment.class}, {target-path=META-INF/MANIFEST.MF, input-stream-index=/home/demo/META-INF/MANIFEST.MF}, {target-path=META-INF/services/org.jboss.msc.service.ServiceActivator, input-stream-index=/home/demo/META-INF/services/org.jboss.msc.service.ServiceActivator}])</pre>
</div>
</div>
<div class="paragraph">
<p>Each content specifies a source content and the target path to which it
will be copied relative to the deployment root. With WildFly 11 you can
use <strong>input-stream-index</strong> (which was a convenient way to pass a stream of
content) from the CLI by pointing it to a local file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[domain@localhost:9990 /] /deployment=exploded.war:remove-content(paths=[WEB-INF/classes/org/jboss/as/test/deployment/trivial/ServiceActivatorDeployment.class, META-INF/MANIFEST.MF, META-INF/services/org.jboss.msc.service.ServiceActivator])</pre>
</div>
</div>
<div class="paragraph">
<p>Now you can list the content of an exploded deployment, or just some
part of it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[domain@localhost:9990 /] /deployment=kitchensink.ear:browse-content(archive=false, path=wildfly-kitchensink-ear-web.war)
{
    "outcome" =&gt; "success",
    "result" =&gt; [
        {
            "path" =&gt; "META-INF/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "META-INF/MANIFEST.MF",
            "directory" =&gt; false,
            "file-size" =&gt; 128L
        },
        {
            "path" =&gt; "WEB-INF/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "WEB-INF/templates/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "WEB-INF/classes/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "WEB-INF/classes/org/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "WEB-INF/classes/org/jboss/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "WEB-INF/classes/org/jboss/as/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "WEB-INF/classes/org/jboss/as/quickstarts/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "WEB-INF/classes/org/jboss/as/quickstarts/kitchensink_ear/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "WEB-INF/classes/org/jboss/as/quickstarts/kitchensink_ear/controller/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "WEB-INF/classes/org/jboss/as/quickstarts/kitchensink_ear/rest/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "WEB-INF/classes/org/jboss/as/quickstarts/kitchensink_ear/util/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "resources/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "resources/css/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "resources/gfx/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "WEB-INF/templates/default.xhtml",
            "directory" =&gt; false,
            "file-size" =&gt; 2113L
        },
        {
            "path" =&gt; "WEB-INF/faces-config.xml",
            "directory" =&gt; false,
            "file-size" =&gt; 1365L
        },
        {
            "path" =&gt; "WEB-INF/classes/org/jboss/as/quickstarts/kitchensink_ear/controller/MemberController.class",
            "directory" =&gt; false,
            "file-size" =&gt; 2750L
        },
        {
            "path" =&gt; "WEB-INF/classes/org/jboss/as/quickstarts/kitchensink_ear/rest/MemberResourceRESTService.class",
            "directory" =&gt; false,
            "file-size" =&gt; 6363L
        },
        {
            "path" =&gt; "WEB-INF/classes/org/jboss/as/quickstarts/kitchensink_ear/rest/JaxRsActivator.class",
            "directory" =&gt; false,
            "file-size" =&gt; 464L
        },
        {
            "path" =&gt; "WEB-INF/classes/org/jboss/as/quickstarts/kitchensink_ear/util/WebResources.class",
            "directory" =&gt; false,
            "file-size" =&gt; 667L
        },
        {
            "path" =&gt; "WEB-INF/beans.xml",
            "directory" =&gt; false,
            "file-size" =&gt; 1262L
        },
        {
            "path" =&gt; "index.xhtml",
            "directory" =&gt; false,
            "file-size" =&gt; 3603L
        },
        {
            "path" =&gt; "index.html",
            "directory" =&gt; false,
            "file-size" =&gt; 949L
        },
        {
            "path" =&gt; "resources/css/screen.css",
            "directory" =&gt; false,
            "file-size" =&gt; 4025L
        },
        {
            "path" =&gt; "resources/gfx/headerbkg.png",
            "directory" =&gt; false,
            "file-size" =&gt; 1147L
        },
        {
            "path" =&gt; "resources/gfx/asidebkg.png",
            "directory" =&gt; false,
            "file-size" =&gt; 1374L
        },
        {
            "path" =&gt; "resources/gfx/banner.png",
            "directory" =&gt; false,
            "file-size" =&gt; 41473L
        },
        {
            "path" =&gt; "resources/gfx/bkg-blkheader.png",
            "directory" =&gt; false,
            "file-size" =&gt; 116L
        },
        {
            "path" =&gt; "resources/gfx/rhjb_eap_logo.png",
            "directory" =&gt; false,
            "file-size" =&gt; 2637L
        },
        {
            "path" =&gt; "META-INF/maven/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "META-INF/maven/org.wildfly.quickstarts/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "META-INF/maven/org.wildfly.quickstarts/wildfly-kitchensink-ear-web/",
            "directory" =&gt; true
        },
        {
            "path" =&gt; "META-INF/maven/org.wildfly.quickstarts/wildfly-kitchensink-ear-web/pom.xml",
            "directory" =&gt; false,
            "file-size" =&gt; 4128L
        },
        {
            "path" =&gt; "META-INF/maven/org.wildfly.quickstarts/wildfly-kitchensink-ear-web/pom.properties",
            "directory" =&gt; false,
            "file-size" =&gt; 146L
        }
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You also have a <strong>read-content</strong> operation but since it returns a binary
stream, this is not displayable from the CLI.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[domain@localhost:9990 /] /deployment=kitchensink.ear:read-content(path=META-INF/MANIFEST.MF)
{
    "outcome" =&gt; "success",
    "result" =&gt; {"uuid" =&gt; "b373d587-72ee-4b1e-a02a-71fbb0c85d32"},
    "response-headers" =&gt; {"attached-streams" =&gt; [{
        "uuid" =&gt; "b373d587-72ee-4b1e-a02a-71fbb0c85d32",
        "mime-type" =&gt; "text/plain"
    }]}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The management CLI however provides high level commands to display or
save binary stream attachments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[domain@localhost:9990 /] attachment display --operation=/deployment=kitchensink.ear:read-content(path=META-INF/MANIFEST.MF)
ATTACHMENT d052340a-abb7-4a66-aa24-4eeeb6b256be:
Manifest-Version: 1.0
Archiver-Version: Plexus Archiver
Built-By: mjurc
Created-By: Apache Maven 3.3.9
Build-Jdk: 1.8.0_91</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>[domain@localhost:9990 /] attachment save --operation=/deployment=kitchensink.ear:read-content(path=META-INF/MANIFEST.MF) --file=example
File saved to /home/mjurc/wildfly/build/target/wildfly-11.0.0.Alpha1-SNAPSHOT/example</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="xml-configuration-file">XML Configuration File</h3>
<div class="paragraph">
<p>When you deploy content, the domain controller adds two types of entries
to the <code>domain.xml</code> configuration file, one showing global information
about the deployment, and another for each relevant server group showing
how it is used by that server group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">[...]
&lt;deployments&gt;
   &lt;deployment name="test-application.war"
               runtime-name="test-application.war"&gt;
       &lt;content sha1="dda9881fa7811b22f1424b4c5acccb13c71202bd"/&gt;
   &lt;/deployment&gt;
&lt;/deployments&gt;
[...]
&lt;server-groups&gt;
   &lt;server-group name="main-server-group" profile="default"&gt;
       [...]
       &lt;deployments&gt;
           &lt;deployment name="test-application.war" runtime-name="test-application.war"/&gt;
       &lt;/deployments&gt;
   &lt;/server-group&gt;
&lt;/server-groups&gt;
[...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>~(See domain/configuration/domain.xml)~</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="standalone-server">Standalone Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Deployments on a standalone server work in a similar way to those on
managed domains. The main difference is that there are no server group
associations.</p>
</div>
<div class="sect2">
<h3 id="deployment-commands-1">Deployment Commands</h3>
<div class="paragraph">
<p>The same CLI commands used for managed domains work for standalone
servers when deploying and removing an application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[standalone@localhost:9990 /] deploy ~/Desktop/test-application.war
'test-application.war' deployed successfully.
 
[standalone@localhost:9990 /] undeploy test-application.war
Successfully undeployed test-application.war.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deploying-using-the-deployment-scanner">Deploying Using the Deployment Scanner</h3>
<div class="paragraph">
<p>Deployment content (for example, war, ear, jar, and sar files) can be
placed in the standalone/deployments directory of the WildFly
distribution, in order to be automatically deployed into the server
runtime. For this to work the <code>deployment-scanner</code> subsystem must be
present. The scanner periodically checks the contents of the deployments
directory and reacts to changes by updating the server.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Users are encouraged to use the WildFly management APIs to upload and
deploy deployment content instead of relying on the deployment scanner
that periodically scans the directory, particularly if running
production systems.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="deployment-scanner-modes">Deployment Scanner Modes</h4>
<div class="paragraph">
<p>The WildFly filesystem deployment scanner operates in one of two
different modes, depending on whether it will directly monitor the
deployment content in order to decide to deploy or redeploy it.</p>
</div>
<div class="paragraph">
<p>Auto-deploy mode:</p>
</div>
<div class="paragraph">
<p>The scanner will directly monitor the deployment content, automatically
deploying new content and redeploying content whose timestamp has
changed. This is similiar to the behavior of previous AS releases,
although there are differences:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A change in any file in an exploded deployment triggers redeploy.
Because EE 6+ applications do not require deployment descriptors,<br>
there is no attempt to monitor deployment descriptors and only redeploy
when a deployment descriptor changes.</p>
</li>
<li>
<p>The scanner will place marker files in this directory as an indication
of the status of its attempts to deploy or undeploy content. These are
detailed below.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Manual deploy mode:</p>
</div>
<div class="paragraph">
<p>The scanner will not attempt to directly monitor the deployment content
and decide if or when the end user wishes the content to be deployed.
Instead, the scanner relies on a system of marker files, with the user&#8217;s
addition or removal of a marker file serving as a sort of command
telling the scanner to deploy, undeploy or redeploy content.</p>
</div>
<div class="paragraph">
<p>Auto-deploy mode and manual deploy mode can be independently configured
for zipped deployment content and exploded deployment content. This is
done via the "auto-deploy" attribute on the deployment-scanner element
in the standalone.xml configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;deployment-scanner scan-interval="5000" relative-to="jboss.server.base.dir"
   path="deployments" auto-deploy-zipped="true" auto-deploy-exploded="false"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, auto-deploy of zipped content is enabled, and auto-deploy of
exploded content is disabled. Manual deploy mode is strongly recommended
for exploded content, as exploded content is inherently vulnerable to
the scanner trying to auto-deploy partially copied content.</p>
</div>
</div>
<div class="sect3">
<h4 id="marker-files">Marker Files</h4>
<div class="paragraph">
<p>The marker files always have the same name as the deployment content to
which they relate, but with an additional file suffix appended. For
example, the marker file to indicate the example.war file should be
deployed is named example.war.dodeploy. Different marker file suffixes
have different meanings.</p>
</div>
<div class="paragraph">
<p>The relevant marker file types are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">File</th>
<th class="tableblock halign-left valign-top">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.dodeploy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Placed by the user to indicate that the given content
shouldbe deployed into the runtime (or redeployed if alreadydeployed in
the runtime.)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.skipdeploy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disables auto-deploy of the content for as long as the
fileis present. Most useful for allowing updates to explodedcontent
without having the scanner initiate redeploy in themiddle of the update.
Can be used with zipped content aswell, although the scanner will detect
in-progress changesto zipped content and wait until changes are
complete.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.isdeploying</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Placed by the deployment scanner service to indicate that
ithas noticed a .dodeploy file or new or updated auto-deploymode content
and is in the process of deploying the content.This marker file will be
deleted when the deployment processcompletes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.deployed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Placed by the deployment scanner service to indicate that
thegiven content has been deployed into the runtime. If an enduser
deletes this file, the content will be undeployed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.failed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Placed by the deployment scanner service to indicate that
thegiven content failed to deploy into the runtime. The contentof the
file will include some information about the cause ofthe failure. Note
that with auto-deploy mode, removing thisfile will make the deployment
eligible for deployment again.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.isundeploying</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Placed by the deployment scanner service to indicate
that ithas noticed a .deployed file has been deleted and thecontent is
being undeployed. This marker file will be deletedwhen the undeployment
process completes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.undeployed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Placed by the deployment scanner service to indicate that
thegiven content has been undeployed from the runtime. If an enduser
deletes this file, it has no impact.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Placed by the deployment scanner service to indicate that
ithas noticed the need to deploy content but has not yetinstructed the
server to deploy it. This file is created ifthe scanner detects that
some auto-deploy content is still inthe process of being copied or if
there is some problem thatprevents auto-deployment. The scanner will not
instruct theserver to deploy or undeploy any content (not just
thedirectly affected content) as long as this condition holds.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="basic-workflows">Basic workflows:</h4>
<div class="paragraph">
<p>All examples assume variable $JBOSS_HOME points to the root of the
WildFly distribution.</p>
</div>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Add new zipped content and deploy it:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>cp target/example.war/ $JBOSS_HOME/standalone/deployments</p>
</li>
<li>
<p>(Manual mode only) touch
$JBOSS_HOME/standalone/deployments/example.war.dodeploy</p>
</li>
</ol>
</div>
</li>
<li>
<p>Add new unzipped content and deploy it:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>cp -r target/example.war/ $JBOSS_HOME/standalone/deployments</p>
</li>
<li>
<p>(Manual mode only) touch
$JBOSS_HOME/standalone/deployments/example.war.dodeploy</p>
</li>
</ol>
</div>
</li>
<li>
<p>Undeploy currently deployed content:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>rm $JBOSS_HOME/standalone/deployments/example.war.deployed</p>
</li>
</ol>
</div>
</li>
<li>
<p>Auto-deploy mode only: Undeploy currently deployed content:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>rm $JBOSS_HOME/standalone/deployments/example.war</p>
</li>
</ol>
</div>
</li>
<li>
<p>Replace currently deployed zipped content with a new version and deploy it:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>cp target/example.war/ $JBOSS_HOME/standalone/deployments</p>
</li>
<li>
<p>(Manual mode only) touch
$JBOSS_HOME/standalone/deployments/example.war.dodeploy</p>
</li>
</ol>
</div>
</li>
<li>
<p>Manual mode only: Replace currently deployed unzipped content with a
new version and deploy it:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>rm $JBOSS_HOME/standalone/deployments/example.war.deployed</p>
</li>
<li>
<p>wait for $JBOSS_HOME/standalone/deployments/example.war.undeployed
file to appear</p>
</li>
<li>
<p>cp -r target/example.war/ $JBOSS_HOME/standalone/deployments</p>
</li>
<li>
<p>touch $JBOSS_HOME/standalone/deployments/example.war.dodeploy</p>
</li>
</ol>
</div>
</li>
<li>
<p>Auto-deploy mode only: Replace currently deployed unzipped content
with a new version and deploy it:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>touch $JBOSS_HOME/standalone/deployments/example.war.skipdeploy</p>
</li>
<li>
<p>cp -r target/example.war/ $JBOSS_HOME/standalone/deployments</p>
</li>
<li>
<p>rm $JBOSS_HOME/standalone/deployments/example.war.skipdeploy</p>
</li>
</ol>
</div>
</li>
<li>
<p>Manual mode only: Live replace portions of currently deployed
unzipped content without redeploying:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>cp -r target/example.war/foo.html
$JBOSS_HOME/standalone/deployments/example.war</p>
</li>
</ol>
</div>
</li>
<li>
<p>Auto-deploy mode only: Live replace portions of currently deployed
unzipped content without redeploying:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>touch $JBOSS_HOME/standalone/deployments/example.war.skipdeploy</p>
</li>
<li>
<p>cp -r target/example.war/foo.html
$JBOSS_HOME/standalone/deployments/example.war</p>
</li>
</ol>
</div>
</li>
<li>
<p>Manual or auto-deploy mode: Redeploy currently deployed content
(i.e. bounce it with no content change):</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>touch $JBOSS_HOME/standalone/deployments/example.war.dodeploy</p>
</li>
</ol>
</div>
</li>
<li>
<p>Auto-deploy mode only: Redeploy currently deployed content (i.e.
bounce it with no content change):</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>touch $JBOSS_HOME/standalone/deployments/example.war</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The above examples use Unix shell commands. Windows equivalents are:
cp src dest -&#8594; xcopy /y src dest<br>
cp -r src dest -&#8594; xcopy /e /s /y src dest<br>
rm afile -&#8594; del afile<br>
touch afile -&#8594; echo&gt;&gt; afile
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that the behavior of 'touch' and 'echo' are different but the
differences are not relevant to the usages in the examples above.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="managed-and-unmanaged-deployments">Managed and Unmanaged Deployments</h2>
<div class="sectionbody">
<div class="paragraph">
<p>WildFly supports two mechanisms for dealing with deployment content –
managed and unmanaged deployments.</p>
</div>
<div class="paragraph">
<p>With a managed deployment the server takes the deployment content and
copies it into an internal content repository and thereafter uses that
copy of the content, not the original user-provided content. The server
is thereafter responsible for the content it uses.</p>
</div>
<div class="paragraph">
<p>With an unmanaged deployment the user provides the local filesystem path
of deployment content, and the server directly uses that content.
However the user is responsible for ensuring that content, e.g. for
making sure that no changes are made to it that will negatively impact
the functioning of the deployed application.</p>
</div>
<div class="paragraph">
<p>To help you differentiate managed from unmanaged deployments the
deployment model has a runtime boolean attribute 'managed'.</p>
</div>
<div class="paragraph">
<p>Managed deployments have a number of benefits over unmanaged:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They can be manipulated by remote management clients, not requiring
access to the server filesystem.</p>
</li>
<li>
<p>In a managed domain, WildFly/EAP will take responsibility for
replicating a copy of the deployment to all hosts/servers in the domain
where it is needed. With an unmanaged deployment, it is the user&#8217;s
responsibility to have the deployment available on the local filesystem
on all relevant hosts, at a consistent path.</p>
</li>
<li>
<p>The deployment content actually used is stored on the filesystem in
the internal content repository, which should help shelter it from
unintended changes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of the previous examples above illustrate using managed deployments,
except for any discussion of deployment scanner handling of exploded
deployments. In WildFly 10 and earlier exploded deployments are always
unmanaged, this is no longer the case since WildFly 11.</p>
</div>
<div class="sect2">
<h3 id="content-repository">Content Repository</h3>
<div class="paragraph">
<p>For a managed deployment, the actual file the server uses when creating
runtime services is not the file provided to the CLI <code>deploy</code> command or
to the web console. It is a copy of that file stored in an internal
content repository. The repository is located in the
<code>domain/data/content</code> directory for a managed domain, or in
<code>standalone/data/content</code> for a standalone server. Actual binaries are
stored in a subdirectory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">ls domain/data/content/
  |---/47
  |-----95cc29338b5049e238941231b36b3946952991
  |---/dd
  |-----a9881fa7811b22f1424b4c5acccb13c71202bd</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The location of the content repository and its internal structure is
subject to change at any time and should not be relied upon by end
users.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The description of a managed deployment in the domain or standalone
configuration file includes an attribute recording the SHA1 hash of the
deployment content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;deployments&gt;
   &lt;deployment name="test-application.war"
               runtime-name="test-application.war"&gt;
       &lt;content sha1="dda9881fa7811b22f1424b4c5acccb13c71202bd"/&gt;
   &lt;/deployment&gt;
&lt;/deployments&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The WildFly process calculates and records that hash when the user
invokes a management operation (e.g. CLI <code>deploy</code> command or using the
console) providing deployment content. The user is not expected to
calculate the hash.</p>
</div>
<div class="paragraph">
<p>The sha1 attribute in the content element tells the WildFly process
where to find the deployment content in its internal content repository.</p>
</div>
<div class="paragraph">
<p>In a domain each host will have a copy of the content needed by its
servers in its own local content repository. The WildFly domain
controller and slave host controller processes take responsibility for
ensuring each host has the needed content.</p>
</div>
</div>
<div class="sect2">
<h3 id="unmanaged-deployments">Unmanaged Deployments</h3>
<div class="paragraph">
<p>An unmanaged deployment is one where the server directly deploys the
content at a path you specify instead of making an internal copy and
then deploying the copy.</p>
</div>
<div class="paragraph">
<p>Initially deploying an unmanaged deployment is much like deploying a
managed one, except you tell WildFly that you do not want the deployment
to be managed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] deploy ~/Desktop/test-application.war --unmanaged
'test-application.war' deployed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you do this, instead of the server making a copy of the content at
<code>/Desktop/test-application.war</code>, calculating the hash of the content,
storing the hash in the configuration file and then installing the copy
into the runtime, instead it will convert
<code>/Desktop/test-application.war</code> to an absolute path, store the path in
the configuration file, and then install the original content in the
runtime.</p>
</div>
<div class="paragraph">
<p>You can also use unmanaged deployments in a domain:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[domain@localhost:9990 /] deploy /home/example/Desktop/test-application.war --server-group=main-server-group --unmanaged
'test-application.war' deployed successfully.</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, before you run this command you must ensure that a copy of the
content is present on all machines that have servers in the target
server groups, all at the same filesystem path. The domain will not copy
the file for you.</p>
</div>
<div class="paragraph">
<p>Undeploy is no different from a managed undeploy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[standalone@localhost:9990 /] undeploy test-application.war
Successfully undeployed test-application.war.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Doing a replacement of the deployment with a new version is a bit
different, the server is using the file you want to replace. You should
undeploy the deployment, replace the content, and then deploy again. Or
you can stop the server, replace the deployment and deploy again.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Deployment_Overlays">Deployment Overlays</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Deployment overlays are our way of 'overlaying' content into an existing
deployment, without physically modifying the contents of the deployment
archive. Possible use cases include swapping out deployment descriptors,
modifying static web resources to change the branding of an application,
or even replacing jar libraries with different versions.</p>
</div>
<div class="paragraph">
<p>Deployment overlays have a different lifecycle to a deployment. In order
to use a deployment overlay, you first create the overlay, using the CLI
or the management API. You then add files to the overlay, specifying the
deployment paths you want them to overlay. Once you have created the
overlay you then have to link it to a deployment name (which is done
slightly differently depending on if you are in standalone or domain
mode). Once you have created the link any deployment that matches the
specified deployment name will have the overlay applied.</p>
</div>
<div class="paragraph">
<p>When you modify or create an overlay it will not affect existing
deployments, they must be redeployed in order to take effect</p>
</div>
<div class="sect2">
<h3 id="creating-a-deployment-overlay">Creating a deployment overlay</h3>
<div class="paragraph">
<p>To create a deployment overlay the CLI provides a high level command to
do all the steps specified above in one go. An example command is given
below for both standalone and domain mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">deployment-overlay add --name=myOverlay --content=/WEB-INF/web.xml=/myFiles/myWeb.xml,/WEB-INF/ejb-jar.xml=/myFiles/myEjbJar.xml --deployments=test.war,*-admin.war --redeploy-affected</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">deployment-overlay add --name=myOverlay --content=/WEB-INF/web.xml=/myFiles/myWeb.xml,/WEB-INF/ejb-jar.xml=/myFiles/myEjbJar.xml --deployments=test.war,*-admin.war --server-groups=main-server-group --redeploy-affected</code></pre>
</div>
</div>
</div>
</div>
</div>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/wildflysite/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Wildfly</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Wildfly</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wildfly"><svg class="svg-icon"><use xlink:href="/wildflysite/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wildfly</span></a></li><li><a href="https://www.twitter.com/WildFlyAS"><svg class="svg-icon"><use xlink:href="/wildflysite/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">WildFlyAS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
