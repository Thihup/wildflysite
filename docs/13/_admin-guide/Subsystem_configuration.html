<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Subsystem configuration | Wildfly</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="Subsystem configuration" />
<meta name="author" content="tcerar@redhat.com" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/Subsystem_configuration.html" />
<meta property="og:url" content="https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/Subsystem_configuration.html" />
<meta property="og:site_name" content="Wildfly" />
<script type="application/ld+json">
{"@type":"WebPage","url":"https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/Subsystem_configuration.html","headline":"Subsystem configuration","author":{"@type":"Person","name":"tcerar@redhat.com"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/wildflysite/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://jbossorg.github.io/wildflysite/feed.xml" title="Wildfly" /></head>
<body><div class="header navigation">
  <div class="logo-wrapper">
    <a href="/wildflysite/"><img class="wf-logo" src="/wildflysite/assets/img/wildfly_icons_one-color-logo.png"></a>
  </div>
  <div class="nav-container">
    <nav>
      <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
      <ul class="nav-list">
        <li>
          <a href="/wildflysite/" class="">Home</a>
        </li>
        <li>
          <a href="/wildflysite/downloads/" class="">Downloads</a>
        </li>
        <li>
          <a href="/wildflysite/blog/" class="">Blog</a>
        </li>
        <li>
          <a href="/wildflysite/about/" class="">About</a>
        </li>
        <li>
          <a href="/wildflysite/contribute/" class="">Contribute</a>
        </li>
        <li>
          <a href="/wildflysite/docs/" class="">Docs</a>
        </li>
        <li>
          <a class="button-cta secondary" href="https://github.com/wildfly/wildfly/fork" target="_blank">Fork</a>
        </li>
      </ul>
    </nav>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#EE">EE Subsystem Configuration</a>
<ul class="sectlevel2">
<li><a href="#EE_Application_Deployment_Configuration">Java EE Application Deployment</a></li>
<li><a href="#EE_Concurrency_Utilities_Configuration">EE Concurrency Utilities</a></li>
<li><a href="#EE_Default_Bindings_Configuration">Default EE Bindings</a></li>
</ul>
</li>
<li><a href="#Naming">Naming Subsystem Configuration</a>
<ul class="sectlevel2">
<li><a href="#Naming_Global_Bindings_Configuration">Global Bindings Configuration</a></li>
<li><a href="#Naming_Remote_JNDI_Configuration">Remote JNDI Configuration</a></li>
</ul>
</li>
<li><a href="#DataSource">DataSource configuration</a>
<ul class="sectlevel2">
<li><a href="#jdbc-driver-installation">JDBC Driver Installation</a></li>
<li><a href="#datasource-definitions">Datasource Definitions</a></li>
<li><a href="#ds-using-security-domains">Using security domains</a></li>
<li><a href="#ds-component-reference">Component Reference</a></li>
</ul>
</li>
<li><a href="#Logging">Logging Configuration</a>
<ul class="sectlevel2">
<li><a href="#logging-attributes">Attributes</a></li>
<li><a href="#per-deployment-logging">Per-deployment Logging</a></li>
<li><a href="#logging-profiles">Logging Profiles</a></li>
<li><a href="#default-log-file-locations">Default Log File Locations</a></li>
<li><a href="#filter-expressions">Filter Expressions</a></li>
<li><a href="#list-log-files-and-reading-log-files">List Log Files and Reading Log Files</a></li>
<li><a href="#faq">FAQ</a></li>
<li><a href="#logging-formatters">Logging Formatters</a></li>
<li><a href="#Logging_Handlers">Handlers</a></li>
<li><a href="#Logging_How_To">How To</a></li>
<li><a href="#Logging_Loggers">Loggers</a></li>
</ul>
</li>
<li><a href="#EJB3">EJB3 subsystem configuration guide</a>
<ul class="sectlevel2">
<li><a href="#session-bean">&lt;session-bean&gt;</a></li>
<li><a href="#mdb">&lt;mdb&gt;</a></li>
<li><a href="#entity-bean">&lt;entity-bean&gt;</a></li>
<li><a href="#pools">&lt;pools&gt;</a></li>
<li><a href="#caches">&lt;caches&gt;</a></li>
<li><a href="#passivation-stores">&lt;passivation-stores&gt;</a></li>
<li><a href="#async">&lt;async&gt;</a></li>
<li><a href="#timer-service">&lt;timer-service&gt;</a></li>
<li><a href="#remote">&lt;remote&gt;</a></li>
<li><a href="#thread-pools">&lt;thread-pools&gt;</a></li>
<li><a href="#iiop">&lt;iiop&gt;</a></li>
<li><a href="#in-vm-remote-interface-invocation">&lt;in-vm-remote-interface-invocation&gt;</a></li>
</ul>
</li>
<li><a href="#Undertow">Undertow subsystem configuration</a>
<ul class="sectlevel2">
<li><a href="#buffer-cache-configuration">Buffer cache configuration</a></li>
<li><a href="#server-configuration">Server configuration</a></li>
<li><a href="#servlet-container-configuration">Servlet container configuration</a></li>
<li><a href="#Undertow_AJP_listeners">AJP listeners</a></li>
<li><a href="#Undertow_using_as_a_Load_Balancer">Using Wildfly as a Load Balancer</a></li>
</ul>
</li>
<li><a href="#Messaging">Messaging configuration</a>
<ul class="sectlevel2">
<li><a href="#required-extension">Required Extension</a></li>
<li><a href="#connectors">Connectors</a></li>
<li><a href="#jms-connection-factories">JMS Connection Factories</a></li>
<li><a href="#jms-queues-and-topics">JMS Queues and Topics</a></li>
<li><a href="#dead-letter-redelivery">Dead Letter &amp; Redelivery</a></li>
<li><a href="#security-settings-for-artemis-addresses-and-jms-destinations">Security Settings for Artemis addresses and JMS destinations</a></li>
<li><a href="#security-domain-for-users">Security Domain for Users</a></li>
<li><a href="#using-the-elytron-subsystem">Using the Elytron Subsystem</a></li>
<li><a href="#cluster-authentication">Cluster Authentication</a></li>
<li><a href="#deployment-of--jms.xml-files">Deployment of -jms.xml files</a></li>
<li><a href="#jms-bridge">JMS Bridge</a></li>
<li><a href="#component-reference">Component Reference</a></li>
<li><a href="#Messaging_Connect_a_pooled-connection-factory_to_a_Remote_Artemis_Server">Connect a pooled-connection-factory to a Remote Artemis Server</a></li>
<li><a href="#Mesaging_AIO_-_NIO_for_messaging_journal">AIO - NIO for messaging journal</a></li>
<li><a href="#Messaging_JDBC_Store_for_Messaging_Journal">JDBC Store for Messaging Journal</a></li>
<li><a href="#Messaging_Discovery_Configuration">Configuring Broadcast/Discovery</a></li>
</ul>
</li>
<li><a href="#Security">Security subsystem configuration</a>
<ul class="sectlevel2">
<li><a href="#structure-of-the-security-subsystem">Structure of the Security Subsystem</a></li>
<li><a href="#security-subsystem-configuration">Security Subsystem Configuration</a></li>
<li><a href="#Security_Authentication_Modules">Authentication Modules</a></li>
</ul>
</li>
<li><a href="#Web_services">Web services configuration</a>
<ul class="sectlevel2">
<li><a href="#structure-of-the-webservices-subsystem">Structure of the webservices subsystem</a></li>
<li><a href="#runtime-information">Runtime information</a></li>
<li><a href="#ws-component-reference">Component Reference</a></li>
</ul>
</li>
<li><a href="#Resource_adapters">Resource adapters</a>
<ul class="sectlevel2">
<li><a href="#resource-adapter-definitions">Resource Adapter Definitions</a></li>
<li><a href="#ra-using-security-domains">Using security domains</a></li>
<li><a href="#automatic-activation-of-resource-adapter-archives">Automatic activation of resource adapter archives</a></li>
<li><a href="#ra-component-reference">Component Reference</a></li>
<li><a href="#default-subsystem-configuration">Default Subsystem Configuration</a></li>
<li><a href="#security">Security</a></li>
<li><a href="#deployment-descriptors">Deployment Descriptors</a></li>
<li><a href="#deployment-resources">Deployment Resources</a></li>
</ul>
</li>
<li><a href="#JSF">JSF Configuration</a>
<ul class="sectlevel2">
<li><a href="#installing-a-new-jsf-implementation-manually">Installing a new JSF implementation manually</a></li>
<li><a href="#changing-the-default-jsf-implementation">Changing the default JSF implementation</a></li>
<li><a href="#configuring-a-jsf-app-to-use-a-non-default-jsf-implementation">Configuring a JSF app to use a non-default JSF implementation</a></li>
<li><a href="#disallowing-doctype-declarations">Disallowing DOCTYPE declarations</a></li>
</ul>
</li>
<li><a href="#JMX">JMX subsystem configuration</a>
<ul class="sectlevel2">
<li><a href="#audit-logging">Audit logging</a></li>
</ul>
</li>
<li><a href="#Deployment_Scanner">Deployment Scanner configuration</a></li>
<li><a href="#Core_Management">Core Management Subsystem Configuration</a>
<ul class="sectlevel2">
<li><a href="#lifecycle-listener">Lifecycle listener</a></li>
<li><a href="#configuration-changes">Configuration changes</a></li>
</ul>
</li>
<li><a href="#Simple_configuration_subsystems">Simple configuration subsystems</a></li>
</ul>
</div>
<div class="paragraph">
<p>The following chapters will focus on the high level management use cases
that are available through the CLI and the web interface. For a detailed
description of each subsystem configuration property, please consult the
respective component reference.</p>
</div>
<div class="paragraph">
<p>Schema Location</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The configuration schemas can found in <code>$JBOSS_HOME/docs/schema</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="EE">EE Subsystem Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The EE subsystem provides common functionality in the Java EE platform,
such as the EE Concurrency Utilities (JSR 236) and <code>@Resource</code>
injection. The subsystem is also responsible for managing the lifecycle
of Java EE application&#8217;s deployments, that is, <code>.ear</code> files.</p>
</div>
<div class="paragraph">
<p>The EE subsystem configuration may be used to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>customise the deployment of Java EE applications</p>
</li>
<li>
<p>create EE Concurrency Utilities instances</p>
</li>
<li>
<p>define the default bindings</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The subsystem name is ee and this document covers EE subsystem version
<code>2.0</code>, which XML namespace within WildFly XML configurations is
<code>urn:jboss:domain:ee:2.0</code>. The path for the subsystem&#8217;s XML schema,
within WildFly&#8217;s distribution, is <code>docs/schema/jboss-as-ee_2_0.xsd</code>.</p>
</div>
<div class="paragraph">
<p>Subsystem XML configuration example with all elements and attributes
specified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:ee:2.0" &gt;
    &lt;global-modules&gt;
        &lt;module name="org.jboss.logging"
                slot="main"/&gt;
        &lt;module name="org.apache.log4j"
                annotations="true"
                meta-inf="true"
                services="false" /&gt;
    &lt;/global-modules&gt;
    &lt;ear-subdeployments-isolated&gt;true&lt;/ear-subdeployments-isolated&gt;
    &lt;spec-descriptor-property-replacement&gt;false&lt;/spec-descriptor-property-replacement&gt;
    &lt;jboss-descriptor-property-replacement&gt;false&lt;/jboss-descriptor-property-replacement&gt;
    &lt;annotation-property-replacement&gt;false&lt;/annotation-property-replacement&gt;
    &lt;concurrent&gt;
        &lt;context-services&gt;
            &lt;context-service
                    name="default"
                    jndi-name="java:jboss/ee/concurrency/context/default"
                    use-transaction-setup-provider="true" /&gt;
        &lt;/context-services&gt;
        &lt;managed-thread-factories&gt;
            &lt;managed-thread-factory
                    name="default"
                    jndi-name="java:jboss/ee/concurrency/factory/default"
                    context-service="default"
                    priority="1" /&gt;
        &lt;/managed-thread-factories&gt;
        &lt;managed-executor-services&gt;
            &lt;managed-executor-service
                    name="default"
                    jndi-name="java:jboss/ee/concurrency/executor/default"
                    context-service="default"
                    thread-factory="default"
                    hung-task-threshold="60000"
                    core-threads="5"
                    max-threads="25"
                    keepalive-time="5000"
                    queue-length="1000000"
                    reject-policy="RETRY_ABORT" /&gt;
        &lt;/managed-executor-services&gt;
        &lt;managed-scheduled-executor-services&gt;
            &lt;managed-scheduled-executor-service
                    name="default"
                    jndi-name="java:jboss/ee/concurrency/scheduler/default"
                    context-service="default"
                    thread-factory="default"
                    hung-task-threshold="60000"
                    core-threads="5"
                    keepalive-time="5000"
                    reject-policy="RETRY_ABORT" /&gt;
        &lt;/managed-scheduled-executor-services&gt;
    &lt;/concurrent&gt;
    &lt;default-bindings
            context-service="java:jboss/ee/concurrency/context/default"
            datasource="java:jboss/datasources/ExampleDS"
            jms-connection-factory="java:jboss/DefaultJMSConnectionFactory"
            managed-executor-service="java:jboss/ee/concurrency/executor/default"
            managed-scheduled-executor-service="java:jboss/ee/concurrency/scheduler/default"
            managed-thread-factory="java:jboss/ee/concurrency/factory/default" /&gt;
&lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="EE_Application_Deployment_Configuration">Java EE Application Deployment</h3>
<div class="paragraph">
<p>The EE subsystem configuration allows the customisation of the
deployment behaviour for Java EE Applications.</p>
</div>
<div class="sect3">
<h4 id="global-modules">Global Modules</h4>
<div class="paragraph">
<p>Global modules is a set of JBoss Modules that will be added as
dependencies to the JBoss Module of every Java EE deployment. Such
dependencies allows Java EE deployments to see the classes exported by
the global modules.</p>
</div>
<div class="paragraph">
<p>Each global module is defined through the <code>module</code> resource, an example
of its XML configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  &lt;global-modules&gt;
    &lt;module name="org.jboss.logging" slot="main"/&gt;
    &lt;module name="org.apache.log4j" annotations="true" meta-inf="true" services="false" /&gt;
  &lt;/global-modules&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The only mandatory attribute is the JBoss Module <code>name</code>, the <code>slot</code>
attribute defaults to <code>main</code>, and both define the JBoss Module ID to
reference.</p>
</div>
<div class="paragraph">
<p>The optional <code>annotations</code> attribute, which defaults to <code>false</code>,
indicates if a pre-computed annotation index should be imported from
META-INF/jandex.idx</p>
</div>
<div class="paragraph">
<p>The optional <code>services</code> attribute indicates if any services exposed in
META-INF/services should be made available to the deployments class
loader, and defaults to <code>false</code>.</p>
</div>
<div class="paragraph">
<p>The optional <code>meta-inf</code> attribute, which defaults to <code>true</code>, indicates
if the Module&#8217;s <code>META-INF</code> path should be available to the deployment&#8217;s
class loader.</p>
</div>
</div>
<div class="sect3">
<h4 id="ear-subdeployments-isolation">EAR Subdeployments Isolation</h4>
<div class="paragraph">
<p>A flag indicating whether each of the subdeployments within a <code>.ear</code> can
access classes belonging to another subdeployment within the same
<code>.ear</code>. The default value is <code>false</code>, which allows the subdeployments to
see classes belonging to other subdeployments within the <code>.ear</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  &lt;ear-subdeployments-isolated&gt;true&lt;/ear-subdeployments-isolated&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>myapp.ear
|
|--- web.war
|
|--- ejb1.jar
|
|--- ejb2.jar</pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>ear-subdeployments-isolated</code> is set to false, then the classes
in <code>web.war</code> can access classes belonging to <code>ejb1.jar</code> and <code>ejb2.jar</code>.
Similarly, classes from <code>ejb1.jar</code> can access classes from <code>ejb2.jar</code>
(and vice-versa).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This flag has no effect on the isolated classloader of the <code>.war</code>
file(s), i.e. irrespective of whether this flag is set to <code>true</code> or
<code>false</code>, the <code>.war</code> within a <code>.ear</code> will have a isolated classloader,
and other subdeployments within that <code>.ear</code> will not be able to access
classes from that <code>.war</code>. This is as per spec.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="property-replacement">Property Replacement</h4>
<div class="paragraph">
<p>The EE subsystem configuration includes flags to configure whether
system property replacement will be done on XML descriptors and Java
Annotations included in Java EE deployments.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
System properties etc are resolved in the security context of the
application server itself, not the deployment that contains the file.
This means that if you are running with a security manager and enable
this property, a deployment can potentially access system properties or
environment entries that the security manager would have otherwise
prevented.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="spec-descriptor-property-replacement">Spec Descriptor Property Replacement</h5>
<div class="paragraph">
<p>Flag indicating whether system property replacement will be performed on
standard Java EE XML descriptors. If not configured this defaults to
<code>true</code>, however it is set to <code>false</code> in the standard configuration files
shipped with WildFly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  &lt;spec-descriptor-property-replacement&gt;false&lt;/spec-descriptor-property-replacement&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="jboss-descriptor-property-replacement">JBoss Descriptor Property Replacement</h5>
<div class="paragraph">
<p>Flag indicating whether system property replacement will be performed on
WildFly proprietary XML descriptors, such as <code>jboss-app.xml</code>. This
defaults to <code>true</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  &lt;jboss-descriptor-property-replacement&gt;false&lt;/jboss-descriptor-property-replacement&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="annotation-property-replacement">Annotation Property Replacement</h5>
<div class="paragraph">
<p>Flag indicating whether system property replacement will be performed on
Java annotations. The default value is <code>false</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  &lt;annotation-property-replacement&gt;false&lt;/annotation-property-replacement&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="EE_Concurrency_Utilities_Configuration">EE Concurrency Utilities</h3>
<div class="paragraph">
<p>EE Concurrency Utilities (JSR 236) were introduced with Java EE 7, to
ease the task of writing multithreaded Java EE applications. Instances
of these utilities are managed by WildFly, and the related configuration
provided by the EE subsystem.</p>
</div>
<div class="sect3">
<h4 id="context-services">Context Services</h4>
<div class="paragraph">
<p>The Context Service is a concurrency utility which creates contextual
proxies from existent objects. WildFly Context Services are also used to
propagate the context from a Java EE application invocation thread, to
the threads internally used by the other EE Concurrency Utilities.
Context Service instances may be created using the subsystem XML
configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  &lt;context-services&gt;
    &lt;context-service
 name="default"
 jndi-name="java:jboss/ee/concurrency/context/default"
 use-transaction-setup-provider="true" /&gt;
  &lt;/context-services&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> attribute is mandatory, and it&#8217;s value should be a unique
name within all Context Services.</p>
</div>
<div class="paragraph">
<p>The <code>jndi-name</code> attribute is also mandatory, and defines where in the
JNDI the Context Service should be placed.</p>
</div>
<div class="paragraph">
<p>The optional <code>use-trasaction-setup-provider</code> attribute indicates if the
contextual proxies built by the Context Service should suspend
transactions in context, when invoking the proxy objects, and its value
defaults to true.</p>
</div>
<div class="paragraph">
<p>Management clients, such as the WildFly CLI, may also be used to
configure Context Service instances. An example to <code>add</code> and <code>remove</code>
one named <code>other</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=ee/context-service=other:add(jndi-name=java\:jboss\/ee\/concurrency\/other)
/subsystem=ee/context-service=other:remove</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="managed-thread-factories">Managed Thread Factories</h4>
<div class="paragraph">
<p>The Managed Thread Factory allows Java EE applications to create new
threads. WildFly Managed Thread Factory instances may also, optionally,
use a Context Service instance to propagate the Java EE application
thread&#8217;s context to the new threads. Instance creation is done through
the EE subsystem, by editing the subsystem XML configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  &lt;managed-thread-factories&gt;
    &lt;managed-thread-factory
 name="default"
 jndi-name="java:jboss/ee/concurrency/factory/default"
 context-service="default"
 priority="1" /&gt;
  &lt;/managed-thread-factories&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> attribute is mandatory, and it&#8217;s value should be a unique
name within all Managed Thread Factories.</p>
</div>
<div class="paragraph">
<p>The <code>jndi-name</code> attribute is also mandatory, and defines where in the
JNDI the Managed Thread Factory should be placed.</p>
</div>
<div class="paragraph">
<p>The optional <code>context-service</code> references an existent Context Service by
its <code>name</code>. If specified then thread created by the factory will
propagate the invocation context, present when creating the thread.</p>
</div>
<div class="paragraph">
<p>The optional <code>priority</code> indicates the priority for new threads created
by the factory, and defaults to <code>5</code>.</p>
</div>
<div class="paragraph">
<p>Management clients, such as the WildFly CLI, may also be used to
configure Managed Thread Factory instances. An example to <code>add</code> and
<code>remove</code> one named <code>other</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=ee/managed-thread-factory=other:add(jndi-name=java\:jboss\/ee\/factory\/other)
/subsystem=ee/managed-thread-factory=other:remove</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="managed-executor-services">Managed Executor Services</h4>
<div class="paragraph">
<p>The Managed Executor Service is the Java EE adaptation of Java SE
Executor Service, providing to Java EE applications the functionality of
asynchronous task execution. WildFly is responsible to manage the
lifecycle of Managed Executor Service instances, which are specified
through the EE subsystem XML configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;managed-executor-services&gt;
    &lt;managed-executor-service
        name="default"
        jndi-name="java:jboss/ee/concurrency/executor/default"
        context-service="default"
        thread-factory="default"
        hung-task-threshold="60000"
        core-threads="5"
        max-threads="25"
        keepalive-time="5000"
        queue-length="1000000"
        reject-policy="RETRY_ABORT" /&gt;
&lt;/managed-executor-services&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> attribute is mandatory, and it&#8217;s value should be a unique
name within all Managed Executor Services.</p>
</div>
<div class="paragraph">
<p>The <code>jndi-name</code> attribute is also mandatory, and defines where in the
JNDI the Managed Executor Service should be placed.</p>
</div>
<div class="paragraph">
<p>The optional <code>context-service</code> references an existent Context Service by
its <code>name</code>. If specified then the referenced Context Service will
capture the invocation context present when submitting a task to the
executor, which will then be used when executing the task.</p>
</div>
<div class="paragraph">
<p>The optional <code>thread-factory</code> references an existent Managed Thread
Factory by its <code>name</code>, to handle the creation of internal threads. If
not specified then a Managed Thread Factory with default configuration
will be created and used internally.</p>
</div>
<div class="paragraph">
<p>The mandatory <code>core-threads</code> provides the number of threads to keep in
the executor&#8217;s pool, even if they are idle. A value of <code>0</code> means there
is no limit.</p>
</div>
<div class="paragraph">
<p>The optional <code>queue-length</code> indicates the number of tasks that can be
stored in the input queue. The default value is <code>0</code>, which means the
queue capacity is unlimited.</p>
</div>
<div class="paragraph">
<p>The executor&#8217;s task queue is based on the values of the attributes
<code>core-threads</code> and <code>queue-length</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <code>queue-length</code> is <code>0</code>, or <code>queue-length</code> is
<code>Integer.MAX_VALUE (2147483647)</code> and <code>core-threads</code> is <code>0</code>, direct
handoff queuing strategy will be used and a synchronous queue will be
created.</p>
</li>
<li>
<p>If <code>queue-length</code> is <code>Integer.MAX_VALUE</code> but <code>core-threads</code> is not
<code>0</code>, an unbounded queue will be used.</p>
</li>
<li>
<p>For any other valid value for <code>queue-length</code>, a bounded queue wil be
created.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The optional <code>hung-task-threshold</code> defines a threshold value, in
milliseconds, to hung a possibly blocked task. A value of <code>0</code> will never
hung a task, and is the default.</p>
</div>
<div class="paragraph">
<p>The optional <code>long-running-tasks</code> is a hint to optimize the execution of
long running tasks, and defaults to <code>false</code>.</p>
</div>
<div class="paragraph">
<p>The optional <code>max-threads</code> defines the the maximum number of threads
used by the executor, which defaults to Integer.MAX_VALUE (2147483647).</p>
</div>
<div class="paragraph">
<p>The optional <code>keepalive-time</code> defines the time, in milliseconds, that an
internal thread may be idle. The attribute default value is <code>60000</code>.</p>
</div>
<div class="paragraph">
<p>The optional reject-policy defines the policy to use when a task is
rejected by the executor. The attribute value may be the default
<code>ABORT</code>, which means an exception should be thrown, or <code>RETRY_ABORT</code>,
which means the executor will try to submit it once more, before
throwing an exception.</p>
</div>
<div class="paragraph">
<p>Management clients, such as the WildFly CLI, may also be used to
configure Managed Executor Service instances. An example to <code>add</code> and
<code>remove</code> one named <code>other</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=ee/managed-executor-service=other:add(jndi-name=java\:jboss\/ee\/executor\/other, core-threads=2)
/subsystem=ee/managed-executor-service=other:remove</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="managed-scheduled-executor-services">Managed Scheduled Executor Services</h4>
<div class="paragraph">
<p>The Managed Scheduled Executor Service is the Java EE adaptation of Java
SE Scheduled Executor Service, providing to Java EE applications the
functionality of scheduling task execution. WildFly is responsible to
manage the lifecycle of Managed Scheduled Executor Service instances,
which are specified through the EE subsystem XML configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;managed-scheduled-executor-services&gt;
    &lt;managed-scheduled-executor-service
        name="default"
        jndi-name="java:jboss/ee/concurrency/scheduler/default"
        context-service="default"
        thread-factory="default"
        hung-task-threshold="60000"
        core-threads="5"
        keepalive-time="5000"
        reject-policy="RETRY_ABORT" /&gt;
&lt;/managed-scheduled-executor-services&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> attribute is mandatory, and it&#8217;s value should be a unique
name within all Managed Scheduled Executor Services.</p>
</div>
<div class="paragraph">
<p>The <code>jndi-name</code> attribute is also mandatory, and defines where in the
JNDI the Managed Scheduled Executor Service should be placed.</p>
</div>
<div class="paragraph">
<p>The optional <code>context-service</code> references an existent Context Service by
its <code>name</code>. If specified then the referenced Context Service will
capture the invocation context present when submitting a task to the
executor, which will then be used when executing the task.</p>
</div>
<div class="paragraph">
<p>The optional <code>thread-factory</code> references an existent Managed Thread
Factory by its <code>name</code>, to handle the creation of internal threads. If
not specified then a Managed Thread Factory with default configuration
will be created and used internally.</p>
</div>
<div class="paragraph">
<p>The mandatory <code>core-threads</code> provides the number of threads to keep in
the executor&#8217;s pool, even if they are idle. A value of <code>0</code> means there
is no limit.</p>
</div>
<div class="paragraph">
<p>The optional <code>hung-task-threshold</code> defines a threshold value, in
milliseconds, to hung a possibly blocked task. A value of <code>0</code> will never
hung a task, and is the default.</p>
</div>
<div class="paragraph">
<p>The optional <code>long-running-tasks</code> is a hint to optimize the execution of
long running tasks, and defaults to <code>false</code>.</p>
</div>
<div class="paragraph">
<p>The optional <code>keepalive-time</code> defines the time, in milliseconds, that an
internal thread may be idle. The attribute default value is <code>60000</code>.</p>
</div>
<div class="paragraph">
<p>The optional reject-policy defines the policy to use when a task is
rejected by the executor. The attribute value may be the default
<code>ABORT</code>, which means an exception should be thrown, or <code>RETRY_ABORT</code>,
which means the executor will try to submit it once more, before
throwing an exception.</p>
</div>
<div class="paragraph">
<p>Management clients, such as the WildFly CLI, may also be used to
configure Managed Scheduled Executor Service instances. An example to
<code>add</code> and <code>remove</code> one named <code>other</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=ee/managed-scheduled-executor-service=other:add(jndi-name=java\:jboss\/ee\/scheduler\/other, core-threads=2)
/subsystem=ee/managed-scheduled-executor-service=other:remove</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="EE_Default_Bindings_Configuration">Default EE Bindings</h3>
<div class="paragraph">
<p>The Java EE Specification mandates the existence of a default instance
for each of the following resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Context Service</p>
</li>
<li>
<p>Datasource</p>
</li>
<li>
<p>JMS Connection Factory</p>
</li>
<li>
<p>Managed Executor Service</p>
</li>
<li>
<p>Managed Scheduled Executor Service</p>
</li>
<li>
<p>Managed Thread Factory</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The EE subsystem looks up the default instances from JNDI, using the
names in the default bindings configuration, before placing those in the
standard JNDI names, such as <code>java:comp/DefaultManagedExecutorService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  &lt;default-bindings
 context-service="java:jboss/ee/concurrency/context/default"
 datasource="java:jboss/datasources/ExampleDS"
 jms-connection-factory="java:jboss/DefaultJMSConnectionFactory"
 managed-executor-service="java:jboss/ee/concurrency/executor/default"
 managed-scheduled-executor-service="java:jboss/ee/concurrency/scheduler/default"
 managed-thread-factory="java:jboss/ee/concurrency/factory/default" /&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The default bindings are optional, if the jndi name for a default
binding is not configured then the related resource will not be
available to Java EE applications.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Naming">Naming Subsystem Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Naming subsystem provides the JNDI implementation on WildFly, and
its configuration allows to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>bind entries in global JNDI namespaces</p>
</li>
<li>
<p>turn off/on the remote JNDI interface</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The subsystem name is naming and this document covers Naming subsystem
version <code>2.0</code>, which XML namespace within WildFly XML configurations is
<code>urn:jboss:domain:naming:2.0</code>. The path for the subsystem&#8217;s XML schema,
within WildFly&#8217;s distribution, is <code>docs/schema/jboss-as-naming_2_0.xsd</code>.</p>
</div>
<div class="paragraph">
<p>Subsystem XML configuration example with all elements and attributes
specified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:naming:2.0"&gt;
    &lt;bindings&gt;
        &lt;simple name="java:global/a" value="100" type="int" /&gt;
        &lt;simple name="java:global/jboss.org/docs/url" value="https://docs.jboss.org" type="java.net.URL" /&gt;
        &lt;object-factory name="java:global/foo/bar/factory" module="org.foo.bar" class="org.foo.bar.ObjectFactory" /&gt;
        &lt;external-context name="java:global/federation/ldap/example" class="javax.naming.directory.InitialDirContext" cache="true"&gt;
            &lt;environment&gt;
                &lt;property name="java.naming.factory.initial" value="com.sun.jndi.ldap.LdapCtxFactory" /&gt;
                &lt;property name="java.naming.provider.url" value="ldap://ldap.example.com:389" /&gt;
                &lt;property name="java.naming.security.authentication" value="simple" /&gt;
                &lt;property name="java.naming.security.principal" value="uid=admin,ou=system" /&gt;
                &lt;property name="java.naming.security.credentials" value="secret" /&gt;
            &lt;/environment&gt;
        &lt;/external-context&gt;
        &lt;lookup name="java:global/c" lookup="java:global/b" /&gt;
    &lt;/bindings&gt;
    &lt;remote-naming/&gt;
&lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="Naming_Global_Bindings_Configuration">Global Bindings Configuration</h3>
<div class="paragraph">
<p>The Naming subsystem configuration allows binding entries into the
following global JNDI namespaces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java:global</code></p>
</li>
<li>
<p><code>java:jboss</code></p>
</li>
<li>
<p><code>java:</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If WildFly is to be used as a Java EE application server, then it&#8217;s
recommended to opt for <code>java:global</code>, since it is a standard (i.e.
portable) namespace.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Four different types of bindings are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Simple</p>
</li>
<li>
<p>Object Factory</p>
</li>
<li>
<p>External Context</p>
</li>
<li>
<p>Lookup</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the subsystem&#8217;s XML configuration, global bindings are configured
through the <code>&lt;bindings /&gt;</code> XML element, as an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;bindings&gt;
    &lt;simple name="java:global/a" value="100" type="int" /&gt;
    &lt;object-factory name="java:global/foo/bar/factory" module="org.foo.bar" class="org.foo.bar.ObjectFactory" /&gt;
    &lt;external-context name="java:global/federation/ldap/example" class="javax.naming.directory.InitialDirContext" cache="true"&gt;
        &lt;environment&gt;
            &lt;property name="java.naming.factory.initial" value="com.sun.jndi.ldap.LdapCtxFactory" /&gt;
            &lt;property name="java.naming.provider.url" value="ldap://ldap.example.com:389" /&gt;
            &lt;property name="java.naming.security.authentication" value="simple" /&gt;
            &lt;property name="java.naming.security.principal" value="uid=admin,ou=system" /&gt;
            &lt;property name="java.naming.security.credentials" value="secret" /&gt;
        &lt;/environment&gt;
    &lt;/external-context&gt;
    &lt;lookup name="java:global/c" lookup="java:global/b" /&gt;
&lt;/bindings&gt;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="simple-bindings">Simple Bindings</h4>
<div class="paragraph">
<p>A simple binding is a primitive or java.net.URL entry, and it is defined
through the <code>simple</code> XML element. An example of its XML configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;simple name="java:global/a" value="100" type="int" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> attribute is mandatory and specifies the target JNDI name for
the entry.</p>
</div>
<div class="paragraph">
<p>The <code>value</code> attribute is mandatory and defines the entry&#8217;s value.</p>
</div>
<div class="paragraph">
<p>The optional <code>type</code> attribute, which defaults to <code>java.lang.String</code>,
specifies the type of the entry&#8217;s value. Besides java.lang.String,
allowed types are all the primitive types and their corresponding object
wrapper classes, such as int or java.lang.Integer, and java.net.URL.</p>
</div>
<div class="paragraph">
<p>Management clients, such as the WildFly CLI, may be used to configure
simple bindings. An example to <code>add</code> and <code>remove</code> the one in the XML
example above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=naming/binding=java\:global\/a:add(binding-type=simple, type=int, value=100)
/subsystem=naming/binding=java\:global\/a:remove</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="object-factories">Object Factories</h4>
<div class="paragraph">
<p>The Naming subsystem configuration allows the binding of
<code>javax.naming.spi.ObjectFactory</code> entries, through the <code>object-factory</code>
XML element, for instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;object-factory name="java:global/foo/bar/factory" module="org.foo.bar" class="org.foo.bar.ObjectFactory"&gt;
    &lt;environment&gt;
        &lt;property name="p1" value="v1" /&gt;
        &lt;property name="p2" value="v2" /&gt;
    &lt;/environment&gt;
&lt;/object-factory&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> attribute is mandatory and specifies the target JNDI name for
the entry.</p>
</div>
<div class="paragraph">
<p>The <code>class</code> attribute is mandatory and defines the object factory&#8217;s Java
type.</p>
</div>
<div class="paragraph">
<p>The <code>module</code> attribute is mandatory and specifies the JBoss Module ID
where the object factory Java class may be loaded from.</p>
</div>
<div class="paragraph">
<p>The optional <code>environment</code> child element may be used to provide a custom
environment to the object factory.</p>
</div>
<div class="paragraph">
<p>Management clients, such as the WildFly CLI, may be used to configure
object factory bindings. An example to <code>add</code> and <code>remove</code> the one in the
XML example above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=naming/binding=java\:global\/foo\/bar\/factory:add(binding-type=object-factory, module=org.foo.bar, class=org.foo.bar.ObjectFactory, environment=[p1=v1, p2=v2])
/subsystem=naming/binding=java\:global\/foo\/bar\/factory:remove</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="external-context-federation">External Context Federation</h4>
<div class="paragraph">
<p>Federation of external JNDI contexts, such as a LDAP context, are
achieved by adding External Context bindings to the global bindings
configuration, through the <code>external-context</code> XML element. An example of
its XML configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;external-context name="java:global/federation/ldap/example" class="javax.naming.directory.InitialDirContext" cache="true"&gt;
    &lt;environment&gt;
        &lt;property name="java.naming.factory.initial" value="com.sun.jndi.ldap.LdapCtxFactory" /&gt;
        &lt;property name="java.naming.provider.url" value="ldap://ldap.example.com:389" /&gt;
        &lt;property name="java.naming.security.authentication" value="simple" /&gt;
        &lt;property name="java.naming.security.principal" value="uid=admin,ou=system" /&gt;
        &lt;property name="java.naming.security.credentials" value="secret" /&gt;
    &lt;/environment&gt;
&lt;/external-context&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> attribute is mandatory and specifies the target JNDI name for
the entry.</p>
</div>
<div class="paragraph">
<p>The <code>class</code> attribute is mandatory and indicates the Java initial naming
context type used to create the federated context. Note that such type
must have a constructor with a single environment map argument.</p>
</div>
<div class="paragraph">
<p>The optional <code>module</code> attribute specifies the JBoss Module ID where any
classes required by the external JNDI context may be loaded from.</p>
</div>
<div class="paragraph">
<p>The optional <code>cache</code> attribute, which value defaults to <code>false</code>,
indicates if the external context instance should be cached.</p>
</div>
<div class="paragraph">
<p>The optional <code>environment</code> child element may be used to provide the
custom environment needed to lookup the external context.</p>
</div>
<div class="paragraph">
<p>Management clients, such as the WildFly CLI, may be used to configure
external context bindings. An example to <code>add</code> and <code>remove</code> the one in
the XML example above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=naming/binding=java\:global\/federation\/ldap\/example:add(binding-type=external-context, cache=true, class=javax.naming.directory.InitialDirContext, environment=[java.naming.factory.initial=com.sun.jndi.ldap.LdapCtxFactory, java.naming.provider.url=ldap\:\/\/ldap.example.com\:389, java.naming.security.authentication=simple, java.naming.security.principal=uid\=admin\,ou\=system, java.naming.security.credentials= secret])
Â 
/subsystem=naming/binding=java\:global\/federation\/ldap\/example:remove</code></pre>
</div>
</div>
<div class="paragraph">
<p>Some JNDI providers may fail when their resources are looked up if they
do not implement properly the lookup(Name) method. Their errors would
look like:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">11:31:49,047 ERROR org.jboss.resource.adapter.jms.inflow.JmsActivation
(default-threads -1) javax.naming.InvalidNameException: Only support
CompoundName namesat
com.tibco.tibjms.naming.TibjmsContext.lookup(TibjmsContext.java:504)at
javax.naming.InitialContext.lookup(InitialContext.java:421)</th>
</tr>
</thead>
</table>
<div class="paragraph">
<p>To work around their shortcomings, the
<code>org.jboss.as.naming.lookup.by.string</code> property can be specified in the
external-context&#8217;s environment to use instead the lookup(String) method
(with a performance degradation):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;property name="org.jboss.as.naming.lookup.by.string" value="true"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Binding Aliases</strong></p>
</div>
<div class="paragraph">
<p>The Naming subsystem configuration allows the binding of existent
entries into additional names, i.e. aliases. Binding aliases are
specified through the <code>lookup</code> XML element. An example of its XML
configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;lookup name="java:global/c" lookup="java:global/b" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> attribute is mandatory and specifies the target JNDI name for
the entry.</p>
</div>
<div class="paragraph">
<p>The <code>lookup</code> attribute is mandatory and indicates the source JNDI name.
It can chain lookups on external contexts. For example, having an
external context bounded to <em>java:global/federation/ldap/example</em>,
searching can be done there by setting <code>lookup</code> attribute to
<em>java:global/federation/ldap/example/subfolder</em>.</p>
</div>
<div class="paragraph">
<p>Management clients, such as the WildFly CLI, may be used to configure
binding aliases. An example to <code>add</code> and <code>remove</code> the one in the XML
example above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=naming/binding=java\:global\/c:add(binding-type=lookup, lookup=java\:global\/b)
/subsystem=naming/binding=java\:global\/c:remove</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Naming_Remote_JNDI_Configuration">Remote JNDI Configuration</h3>
<div class="paragraph">
<p>The Naming subsystem configuration may be used to (de)activate the
remote JNDI interface, which allows clients to lookup entries present in
a remote WildFly instance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Only entries within the <code>java:jboss/exported</code> context are accessible
over remote JNDI.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the subsystem&#8217;s XML configuration, remote JNDI access bindings are
configured through the <code>&lt;remote-naming /&gt;</code> XML element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;remote-naming /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Management clients, such as the WildFly CLI, may be used to add/remove
the remote JNDI interface. An example to <code>add</code> and <code>remove</code> the one in
the XML example above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=naming/service=remote-naming:add
/subsystem=naming/service=remote-naming:remove</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="DataSource">DataSource configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Datasources are configured through the <em>datasource</em> subsystem. Declaring
a new datasource consists of two separate steps: You would need to
provide a JDBC driver and define a datasource that references the driver
you installed.</p>
</div>
<div class="sect2">
<h3 id="jdbc-driver-installation">JDBC Driver Installation</h3>
<div class="paragraph">
<p>The recommended way to install a JDBC driver into WildFly {wildflyVersion} is to deploy
it as a regular JAR deployment. The reason for this is that when you run
WildFly in domain mode, deployments are automatically propagated to all
servers to which the deployment applies; thus distribution of the driver
JAR is one less thing for you to worry about!</p>
</div>
<div class="paragraph">
<p>Any JDBC 4-compliant driver will automatically be recognized and
installed into the system by name and version. A JDBC JAR is identified
using the Java service provider mechanism. Such JARs will contain a text
a file named <code>META-INF/services/java.sql.Driver</code>, which contains the
name of the class(es) of the Drivers which exist in that JAR. If your
JDBC driver JAR is not JDBC 4-compliant, it can be made deployable in
one of a few ways.</p>
</div>
<div class="paragraph">
<p><strong>Modify the JAR</strong></p>
</div>
<div class="paragraph">
<p>The most straightforward solution is to simply modify the JAR and add
the missing file. You can do this from your command shell by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change to, or create, an empty temporary directory.</p>
</li>
<li>
<p>Create a <code>META-INF</code> subdirectory.</p>
</li>
<li>
<p>Create a <code>META-INF/services</code> subdirectory.</p>
</li>
<li>
<p>Create a <code>META-INF/services/java.sql.Driver</code> file which contains one
line - the fully-qualified class name of the JDBC driver.</p>
</li>
<li>
<p>Use the <code>jar</code> command-line tool to update the JAR like this:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>jar \-uf jdbc-driver.jar META-INF/services/java.sql.Driver</code></pre>
</div>
</div>
<div class="paragraph">
<p>For a detailed explanation how to deploy JDBC 4 compliant driver jar,
please refer to the chapter " <a href="#application-deployment">Application Deployment</a>".</p>
</div>
</div>
<div class="sect2">
<h3 id="datasource-definitions">Datasource Definitions</h3>
<div class="paragraph">
<p>The datasource itself is defined within the subsystem <em>datasources</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:datasources:4.0"&gt;
    &lt;datasources&gt;
        &lt;datasource jndi-name="java:jboss/datasources/ExampleDS" pool-name="ExampleDS"&gt;
            &lt;connection-url&gt;jdbc:h2:mem:test;DB_CLOSE_DELAY=-1&lt;/connection-url&gt;
            &lt;driver&gt;h2&lt;/driver&gt;
            &lt;pool&gt;
                &lt;min-pool-size&gt;10&lt;/min-pool-size&gt;
                &lt;max-pool-size&gt;20&lt;/max-pool-size&gt;
                &lt;prefill&gt;true&lt;/prefill&gt;
            &lt;/pool&gt;
            &lt;security&gt;
                &lt;user-name&gt;sa&lt;/user-name&gt;
                &lt;password&gt;sa&lt;/password&gt;
            &lt;/security&gt;
        &lt;/datasource&gt;
        &lt;xa-datasourceÂ jndi-name="java:jboss/datasources/ExampleXADS"Â pool-name="ExampleXADS"&gt;
          Â &lt;driver&gt;h2&lt;/driver&gt;
       Â Â Â  &lt;xa-datasource-propertyÂ name="URL"&gt;jdbc:h2:mem:test&lt;/xa-datasource-property&gt;
           &lt;xa-pool&gt;
                &lt;min-pool-size&gt;10&lt;/min-pool-size&gt;
                &lt;max-pool-size&gt;20&lt;/max-pool-size&gt;
                &lt;prefill&gt;true&lt;/prefill&gt;
           &lt;/xa-pool&gt;
       Â Â Â  &lt;security&gt;
          Â Â Â Â Â  &lt;user-name&gt;sa&lt;/user-name&gt;
          Â Â Â Â Â  &lt;password&gt;sa&lt;/password&gt;
       Â Â Â  &lt;/security&gt;
      Â  &lt;/xa-datasource&gt;
        &lt;drivers&gt;
           Â &lt;driver name="h2" module="com.h2database.h2"&gt;
                &lt;xa-datasource-class&gt;org.h2.jdbcx.JdbcDataSource&lt;/xa-datasource-class&gt;
            &lt;/driver&gt;
        &lt;/drivers&gt;
  &lt;/datasources&gt;
Â 
&lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><sub>(See</sub> <code>standalone/configuration/standalone.xml</code> <sub>)</sub></p>
</div>
<div class="paragraph">
<p>As you can see the datasource references a driver by it&#8217;s logical name.</p>
</div>
<div class="paragraph">
<p>You can easily query the same information through the CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /subsystem=datasources:read-resource(recursive=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "data-source" =&gt; {"H2DS" =&gt; {
            "connection-url" =&gt; "jdbc:h2:mem:test;DB_CLOSE_DELAY=-1",
            "jndi-name" =&gt; "java:/H2DS",
            "driver-name" =&gt; "h2",
            "pool-name" =&gt; "H2DS",
            "use-java-context" =&gt; true,
            "enabled" =&gt; true,
            "jta" =&gt; true,
            "pool-prefill" =&gt; true,
            "pool-use-strict-min" =&gt; false,
            "user-name" =&gt; "sa",
            "password" =&gt; "sa",
            "flush-strategy" =&gt; "FailingConnectionOnly",
            "background-validation" =&gt; false,
            "use-fast-fail" =&gt; false,
            "validate-on-match" =&gt; false,
            "use-ccm" =&gt; true
        }},
        "xa-data-source" =&gt; undefined,
        "jdbc-driver" =&gt; {"h2" =&gt; {
            "driver-name" =&gt; "h2",
            "driver-module-name" =&gt; "com.h2database.h2",
            "driver-xa-datasource-class-name" =&gt; "org.h2.jdbcx.JdbcDataSource"
        }}
    }
}
Â 
Â 
[standalone@localhost:9990 /] /subsystem=datasources:installed-drivers-list
{
Â Â  Â "outcome" =&gt; "success",
Â Â  Â "result" =&gt; [{
Â Â  Â  Â  Â "driver-name" =&gt; "h2",
        "datasource-class-info" =&gt; [{"org.h2.jdbcx.JdbcDataSource" =&gt; {
            "URL" =&gt; "java.lang.String",
            "description" =&gt; "java.lang.String",
            "loginTimeout" =&gt; "int",
            "password" =&gt; "java.lang.String",
            "url" =&gt; "java.lang.String",
            "user" =&gt; "java.lang.String"
        }}],
Â Â  Â  Â  Â "deployment-name" =&gt; undefined,
Â Â  Â  Â  Â "driver-module-name" =&gt; "com.h2database.h2",
Â Â  Â  Â  Â "module-slot" =&gt; "main",
Â Â  Â  Â  Â "driver-xa-datasource-class-name" =&gt; "org.h2.jdbcx.JdbcDataSource",
Â Â  Â  Â  Â "driver-class-name" =&gt; "org.h2.Driver",
Â Â  Â  Â  Â "driver-major-version" =&gt; 1,
Â Â  Â  Â  Â "driver-minor-version" =&gt; 3,
Â Â  Â  Â  Â "jdbc-compliant" =&gt; true
Â Â  Â }]
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>datasource-class-info</code> shows connection properties defined in the <code>(xa-)datasource-class</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Using the web console or the CLI greatly simplifies the deployment of
JDBC drivers and the creation of datasources.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The CLI offers a set of commands to create and modify datasources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] data-source --help
Â 
SYNOPSIS
Â  data-source --help [--properties | --commands] |
Â Â Â Â Â Â Â Â Â Â Â Â Â  (--name=&lt;resource_id&gt; (--&lt;property&gt;=&lt;value&gt;)*) |
Â Â Â Â Â Â Â Â Â Â Â Â Â  (&lt;command&gt; --name=&lt;resource_id&gt; (--&lt;parameter&gt;=&lt;value&gt;)*)
Â Â Â Â Â Â Â Â Â Â Â Â Â  [--headers={&lt;operation_header&gt; (;&lt;operation_header&gt;)*}]
DESCRIPTION
Â  The command is used to manage resources of type /subsystem=datasources/data-source.
[...]
Â 
Â 
[standalone@localhost:9990 /] xa-data-source --help
Â 
SYNOPSIS
Â  xa-data-source --help [--properties | --commands] |
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  (--name=&lt;resource_id&gt; (--&lt;property&gt;=&lt;value&gt;)*) |
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  (&lt;command&gt; --name=&lt;resource_id&gt; (--&lt;parameter&gt;=&lt;value&gt;)*)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  [--headers={&lt;operation_header&gt; (;&lt;operation_header&gt;)*}]
Â 
DESCRIPTION
Â  The command is used to manage resources of type /subsystem=datasources/xa-data-source.
Â 
RESOURCE DESCRIPTION
Â  A JDBC XA data-source configuration
Â 
[...]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ds-using-security-domains">Using security domains</h3>
<div class="paragraph">
<p>Information can be found at
<a href="https://community.jboss.org/wiki/JBossAS7SecurityDomainModel" class="bare">https://community.jboss.org/wiki/JBossAS7SecurityDomainModel</a></p>
</div>
</div>
<div class="sect2">
<h3 id="ds-component-reference">Component Reference</h3>
<div class="paragraph">
<p>The datasource subsystem is provided by the
<a href="http://www.jboss.org/ironjacamar">IronJacamar</a> project. For a detailed
description of the available configuration properties, please consult
the project documentation.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>IronJacamar homepage: <a href="http://ironjacamar.org/" class="bare">http://ironjacamar.org/</a></p>
</li>
<li>
<p>Project Documentation: <a href="http://ironjacamar.org/documentation.html" class="bare">http://ironjacamar.org/documentation.html</a></p>
</li>
<li>
<p>Schema description:
<a href="http://www.ironjacamar.org/doc/userguide/1.1/en-US/html_single/index.html#deployingds_descriptor" class="bare">http://www.ironjacamar.org/doc/userguide/1.1/en-US/html_single/index.html#deployingds_descriptor</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Logging">Logging Configuration</h2>
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
The overall server logging configuration is represented by the logging
subsystem. It consists of four notable parts: <code>handler</code> configurations,
<code>logger</code>, the <code>root logger</code> declarations (aka log categories) and
logging profiles. Each logger does reference a handler (or set of
handlers). Each handler declares the log format and output:
</blockquote>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:logging:3.0"&gt;
   &lt;console-handler name="CONSOLE" autoflush="true"&gt;
       &lt;level name="DEBUG"/&gt;
       &lt;formatter&gt;
Â Â Â Â Â Â Â Â Â Â  &lt;named-formatter name="COLOR-PATTERN"/&gt;
Â Â Â Â Â Â  &lt;/formatter&gt;
   &lt;/console-handler&gt;
   &lt;periodic-rotating-file-handler name="FILE" autoflush="true"&gt;
       &lt;formatter&gt;
           &lt;named-formatter name="PATTERN"/&gt;
       &lt;/formatter&gt;
       &lt;file relative-to="jboss.server.log.dir" path="server.log"/&gt;
       &lt;suffix value=".yyyy-MM-dd"/&gt;
   &lt;/periodic-rotating-file-handler&gt;
   &lt;logger category="com.arjuna"&gt;
       &lt;level name="WARN"/&gt;
   &lt;/logger&gt;
   [...]
   &lt;root-logger&gt;
       &lt;level name="DEBUG"/&gt;
       &lt;handlers&gt;
           &lt;handler name="CONSOLE"/&gt;
           &lt;handler name="FILE"/&gt;
       &lt;/handlers&gt;
   &lt;/root-logger&gt;
   &lt;formatter name="PATTERN"&gt;
Â Â Â Â Â Â  &lt;pattern-formatter pattern="%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n"/&gt;
Â Â  &lt;/formatter&gt;
Â Â  &lt;formatter name="COLOR-PATTERN"&gt;
Â Â Â Â Â Â  &lt;pattern-formatter pattern="%K{level}%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%e%n"/&gt;
Â Â  &lt;/formatter&gt;
&lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="logging-attributes">Attributes</h3>
<div class="paragraph">
<p>The root resource contains two notable attributes
<code>add-logging-api-dependencies</code> and <code>use-deployment-logging-config</code>.</p>
</div>
<div class="sect3">
<h4 id="add-logging-api-dependencies">add-logging-api-dependencies</h4>
<div class="paragraph">
<p>The <code>add-logging-api-dependencies</code> controls whether or not the container
adds
<a href="Implicit_module_dependencies_for_deployments.html#src-557203_safe-id-SW1wbGljaXRtb2R1bGVkZXBlbmRlbmNpZXNmb3JkZXBsb3ltZW50cy1JbXBsaWNpdG1vZHVsZWRlcGVuZGVuY2llc2ZvcmRlcGxveW1lbnRzLVdoaWNoYXJldGhlaW1wbGljaXRtb2R1bGVkZXBlbmRlbmNpZXMlM0Y">implicit</a>
logging API dependencies to your deployments. If set to <code>true</code>, the
default, all the implicit logging API dependencies are added. If set to
<code>false</code> the dependencies are not added to your deployments.</p>
</div>
</div>
<div class="sect3">
<h4 id="use-deployment-logging-config">use-deployment-logging-config</h4>
<div class="paragraph">
<p>The <code>use-deployment-logging-config</code> controls whether or not your
deployment is scanned for
<a href="#per-deployment-logging">per-deployment
logging</a>. If set to <code>true</code>, the default,
<a href="#per-deployment-logging">per-deployment
logging</a> is enabled. Set to <code>false</code> to disable this feature.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="per-deployment-logging">Per-deployment Logging</h3>
<div class="paragraph">
<p>Per-deployment logging allows you to add a logging configuration file to
your deployment and have the logging for that deployment configured
according to the configuration file. In an EAR the configuration should
be in the <code>META-INF</code> directory. In a WAR or JAR deployment the
configuration file can be in either the <code>META-INF</code> or <code>WEB-INF/classes</code>
directories.</p>
</div>
<div class="paragraph">
<p>The following configuration files are allowed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>logging.properties</p>
</li>
<li>
<p>jboss-logging.properties</p>
</li>
<li>
<p>log4j.properties</p>
</li>
<li>
<p>log4j.xml</p>
</li>
<li>
<p>jboss-log4j.xml</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also disable this functionality by changing the
<code>use-deployment-logging-config</code> attribute to <code>false</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="logging-profiles">Logging Profiles</h3>
<div class="paragraph">
<p>Logging profiles are like additional logging subsystems. Each logging
profile constists of three of the four notable parts listed above:
<code>handler</code> configurations, <code>logger</code> and the <code>root logger</code> declarations.</p>
</div>
<div class="paragraph">
<p>You can assign a logging profile to a deployment via the deployments
manifest. Add a <code>Logging-Profile</code> entry to the <code>MANIFEST.MF</code> file with a
value of the logging profile id. For example a logging profile defined
on <code>/subsystem=logging/logging-profile=ejbs</code> the MANIFEST.MF would look
like:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Manifest-Version: 1.0
Logging-Profile: ejbs</pre>
</div>
</div>
<div class="paragraph">
<p>A logging profile can be assigned to any number of deployments. Using a
logging profile also allows for runtime changes to the configuration.
This is an advantage over the per-deployment logging configuration as
the redeploy is not required for logging changes to take affect.</p>
</div>
</div>
<div class="sect2">
<h3 id="default-log-file-locations">Default Log File Locations</h3>
<div class="sect3">
<h4 id="logging-managed-domain">Managed Domain</h4>
<div class="paragraph">
<p>In a managed domain two types of log files do exist: Controller and
server logs. The controller components govern the domain as whole. It&#8217;s
their responsibility to start/stop server instances and execute managed
operations throughout the domain. Server logs contain the logging
information for a particular server instance. They are co-located with
the host the server is running on.</p>
</div>
<div class="paragraph">
<p>For the sake of simplicity we look at the default setup for managed
domain. In this case, both the domain controller components and the
servers are located on the same host:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Process</th>
<th class="tableblock halign-left valign-top">Log File</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Host Controller</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">./domain/log/host-controller.log</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process Controller</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">./domain/log/process-controller.log</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Server One"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">./domain/servers/server-one/log/server.log</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Server Two"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">./domain/servers/server-two/log/server.log</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Server Three"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">./domain/servers/server-three/log/server.log</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="logging-standalone-server">Standalone Server</h4>
<div class="paragraph">
<p>The default log files for a standalone server can be found in the log
subdirectory of the distribution:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Process</th>
<th class="tableblock halign-left valign-top">Log File</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">./standalone/log/server.log</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="filter-expressions">Filter Expressions</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Filter Type</th>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Parameter(s)</th>
<th class="tableblock halign-left valign-top">Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">accept</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">accept</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accepts all log messages.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">accept</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deny</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deny</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">enies all log messages.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deny</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">not</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not(filterExpression)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accepts a filter as an argument and inverts
the returned value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The expression takes a single filter for it&#8217;s
argument.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not(match("JBAS"))</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">all</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all(filterExpressions)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A filter consisting of several filters in
a chain. If any filter find the log message to be unloggable, the
message will not be logged and subsequent filters will not be checked.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The expression takes a comma delimited list of filters for it&#8217;s
argument.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all(match("JBAS"), match("WELD"))</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any(filterExpressions)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A filter consisting of several filters in
a chain. If any filter fins the log message to be loggable, the message
will be logged and the subsequent filters will not be checked.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The
expression takes a comma delimited list of filters for it&#8217;s argument.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any(match("JBAS"), match("WELD"))</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">levelChange</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">levelChange(level)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A filter which modifies the log record
with a new level.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The expression takes a single string based level for
it&#8217;s argument.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">levelChange(WARN)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">levels</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">levels(levels)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A filter which includes log messages with a
level that is listed in the list of levels.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The expression takes a
comma delimited list of string based levels for it&#8217;s argument.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">levels(DEBUG, INFO, WARN, ERROR)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">levelRange</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">levelRange([minLevel,maxLevel])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A filter which logs
records that are within the level range.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The filter expression uses a
"[" to indicate a minimum inclusive level and a "]" to indicate a
maximum inclusive level. Otherwise use "(" or ")" respectively indicate
exclusive. The first argument for the expression is the minimum level
allowed, the second argument is the maximum level allowed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">minimum
level must be less than ERROR and the maximum level must be greater than
DEBUGlevelRange(ERROR, DEBUG) minimum level must be less than or equal
to ERROR and the maximum level must be greater than
DEBUGlevelRange[ERROR, DEBUG) minimum level must be less than or equal
to ERROR and the maximum level must be greater or equal to
INFOlevelRange[ERROR, INFO]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">match</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match("pattern")</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A regular-expression based filter. The raw
unformatted message is used against the pattern.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The expression takes a
regular expression for it&#8217;s argument. match("JBAS\d+")</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">substitute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">substitute("pattern", "replacement value")</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A filter which
replaces the first match to the pattern with the replacement value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The
first argument for the expression is the pattern the second argument is
the replacement text.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">substitute("JBAS", "EAP")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">substituteAll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">substituteAll("pattern", "replacement value")</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A filter
which replaces all matches of the pattern with the replacement value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The first argument for the expression is the pattern the second
argument is the replacement text.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">substituteAll("JBAS", "EAP")</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="list-log-files-and-reading-log-files">List Log Files and Reading Log Files</h3>
<div class="paragraph">
<p>Log files can be listed and viewed via management operations. The log
files allowed to be viewed are intentionally limited to files that exist
in the <code>jboss.server.log.dir</code> and are associated with a known file
handler. Known file handler types include <code>file-handler</code>,
<code>periodic-rotating-file-handler</code> and <code>size-rotating-file-handler</code>. The
operations are valid in both standalone and domain modes.</p>
</div>
<div class="sect3">
<h4 id="list-log-files">List Log Files</h4>
<div class="paragraph">
<p>The logging subsystem has a <code>log-file</code> resource off the subsystem root
resource and off each <code>logging-profile</code> resource to list each log file.</p>
</div>
<div class="listingblock">
<div class="title">CLI command and output</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /subsystem=logging:read-children-names(child-type=log-file)
{
    "outcome" =&gt; "success",
    "result" =&gt; [
        "server.log",
        "server.log.2014-02-12",
        "server.log.2014-02-13"
    ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="read-log-file">Read Log File</h4>
<div class="paragraph">
<p>The <code>read-log-file</code> operation is available on each <code>log-file</code> resource.
This operation has 4 optional parameters.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">encoding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the encoding the file should be read in</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lines</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the number of lines from the file. A value of -1 indicates all
lines should be read.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">skip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the number of lines to skip before reading.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true to read from the end of the file up or false to read top
down.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">CLI command and output</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /subsystem=logging/log-file=server.log:read-log-file
{
    "outcome" =&gt; "success",
    "result" =&gt; [
        "2014-02-14 14:16:48,781 INFO  [org.jboss.as.server.deployment.scanner] (MSC service thread 1-11) JBAS015012: Started FileSystemDeploymentService for directory /home/jperkins/servers/wildfly-8.0.0.Final/standalone/deployments",
        "2014-02-14 14:16:48,782 INFO  [org.jboss.as.connector.subsystems.datasources] (MSC service thread 1-8) JBAS010400: Bound data source [java:jboss/myDs]",
        "2014-02-14 14:16:48,782 INFO  [org.jboss.as.connector.subsystems.datasources] (MSC service thread 1-15) JBAS010400: Bound data source [java:jboss/datasources/ExampleDS]",
        "2014-02-14 14:16:48,786 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-9) JBAS015876: Starting deployment of \"simple-servlet.war\" (runtime-name: \"simple-servlet.war\")",
        "2014-02-14 14:16:48,978 INFO  [org.jboss.ws.common.management] (MSC service thread 1-10) JBWS022052: Starting JBoss Web Services - Stack CXF Server 4.2.3.Final",
        "2014-02-14 14:16:49,160 INFO  [org.wildfly.extension.undertow] (MSC service thread 1-16) JBAS017534: Registered web context: /simple-servlet",
        "2014-02-14 14:16:49,189 INFO  [org.jboss.as.server] (Controller Boot Thread) JBAS018559: Deployed \"simple-servlet.war\" (runtime-name : \"simple-servlet.war\")",
        "2014-02-14 14:16:49,224 INFO  [org.jboss.as] (Controller Boot Thread) JBAS015961: Http management interface listening on http://127.0.0.1:9990/management",
        "2014-02-14 14:16:49,224 INFO  [org.jboss.as] (Controller Boot Thread) JBAS015951: Admin console listening on http://127.0.0.1:9990",
        "2014-02-14 14:16:49,225 INFO  [org.jboss.as] (Controller Boot Thread) JBAS015874: WildFly {wildflyVersion}.0.0.Final \"WildFly\" started in 1906ms - Started 258 of 312 services (90 services are lazy, passive or on-demand)"
    ]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="faq">FAQ</h3>
<div class="sect3">
<h4 id="why-is-there-a-logging.properties-file">Why is there a logging.properties file?</h4>
<div class="paragraph">
<p>You may have noticed that there is a <code>logging.properties</code> file in the
configuration directory. This is logging configuration is used when the
server boots up until the logging subsystem kicks in. If the logging
subsystem is not included in your configuration, then this would act as
the logging configuration for the entire server.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>logging.properties</code> file is overwritten at boot and with each
change to the logging subsystem. Any changes made to the file are not
persisted. Any changes made to the XML configuration or via management
operations will be persisted to the <code>logging.properties</code> file and used
on the next boot.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="logging-formatters">Logging Formatters</h3>
<div class="paragraph">
<p>Formatters are used to format a log message. A formatter can be assigned to a logging handler.</p>
</div>
<div class="paragraph">
<p>The logging subsystem includes 4 types of handlers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#json-formatter">JSON Formatter</a></p>
</li>
<li>
<p><a href="#pattern-formatter">Pattern Formatter</a></p>
</li>
<li>
<p><a href="#xml-formatter">XML Formatter</a></p>
</li>
<li>
<p><a href="#custom-formatter">Custom Formatter</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="json-formatter">JSON Formatter</h4>
<div class="paragraph">
<p>A formatter used to format log messages in JSON.</p>
</div>
<div class="sect4">
<h5 id="examples">Examples</h5>
<div class="listingblock">
<div class="title">Simple JSON Formatter</div>
<div class="content">
<pre>/subsystem=logging/json-formatter=json:add(pretty-print=true, exception-output-type=formatted)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Logstash Formatter</div>
<div class="content">
<pre>/subsystem=logging/json-formatter=logstash:add(exception-output-type=formatted, key-overrides=[timestamp="@timestamp"],
meta-data=[@version=1])</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="pattern-formatter">Pattern Formatter</h4>
<div class="paragraph">
<p>A formatter used to format log messages in plain text. The following table describes the format characters for the
pattern formatter.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<mark>Highlighted</mark> symbols indicate the calculation of the caller is required which can be expensive to resolve.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Pattern Syntax</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 62.5%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Symbol</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The category of the logging event. A precision specifier can be used to alter the dot delimited category</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>%c      org.jboss.example.Foo
%c{1}   Foo
%c{2}   example.Foo
%c{.}   ...Foo
%c{1.}  o.j.e.Foo
%c{1~.} o.~.~.Foo</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><mark>%C</mark></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The class of the code calling the log method. A precision specifier can be used to alter the dot delimited class name.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>%C      org.jboss.example.Foo
%C{1}   Foo
%C{2}   example.Foo
%C{.}   ...Foo
%C{1.}  o.j.e.Foo
%C{1~.} o.~.~.Foo</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a id="timestamp"></a>%d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The timestamp the log message. Any valid <a href="https://docs.oracle.com/javase/8/docs/api/java/text/SimpleDateFormat.html"><code>SimpleDateFormat</code></a> pattern. The
 default is <code>yyyy-MM-dd HH:mm:ss,SSS</code>.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>%d{HH:mm:ss,SSS}
%d{yyyy-MM-dd'T'HH:mm:ss.SSSXXX}</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><mark>%D</mark></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the module the log message came from. A precision specifier can be used to alter the dot delimited module
 name.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>%D      org.jboss.example
%D{1}   example
%D{2}   jboss.example
%D{.}   ..example
%D{1.}  o.j.example
%D{1~.} o.~.example</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The exception stack trace. Accepts an argument to indicate how many levels of suppressed messages to print.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%e</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints the full stack trace.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%e{0}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints the stack trace ignoring any suppressed messages.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%e{1}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prints the stack trace with a maximum of one suppressed message.</p></td>
</tr>
</tbody>
</table></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><mark>%F</mark></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the file the class that logged the message.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host name. A precision specifier can be used to alter the dot delimited host name.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>%h     localhost
%h{2}  localdomain.localhost</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%H</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The qualified host name. A precision specifier can be used to alter the dot delimited host name.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>%H    developer.jboss.org
%H{2} jboss.org</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%i</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process id.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%k</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The resource bundle key.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%K</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If colored output is supported defines the colors to map to the log message.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%K{level}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The level determines the color of the output.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>%K{red}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All messages will be colored red.</p></td>
</tr>
</tbody>
</table></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><mark>%l</mark></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The location information. This includes the callers class name, method name, file name and line number.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>%l    org.jboss.example.Foo.bar(Foo.java:33)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><mark>%L</mark></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The line number of the caller.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%m</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The formatted message including any stack traces.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><mark>%M</mark></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The callers method name.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A platform independent line separator.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the process.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%p</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The level of the logged message.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%P</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The localized level of the logged message.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%r</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The relative number of milliseconds since the given base time from the log message.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The simple formatted message. This will not include the stack trace if a cause was logged.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%t</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the callers thread.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><mark>%v</mark></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The version of the module. A precision specifier can be used to alter the dot delimited module version.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The nested diagnostic context entries. A precision specifier can be used to specify the number of entries to print.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>%x      value1.value2.value3
%x{1}   value3
%x{2}   value2.value3</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The mapped diagnostic context entry. The entry must be followed by the key for the MDC entry.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>%X{key}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows the timezone to be overridden when formatting the <a href="#timestamp">timestamp</a>. This must precede the
 <a href="#timestamp">timestamp</a>.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>%z{GMT}%d{yyyy-MM-dd&#8217;T&#8217;HH:mm:ssSSSXXX}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%#</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows a system property to be appended to the log message.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>%#{jboss.server.name}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%$</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows a system property to be appended to the log message.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>%${jboss.server.name}</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Escapes the <code>%</code> symbol.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>&nbsp;</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can also modify the format by placing the optional format modifier between the percent sign and the symbol.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Format Modifier Examples</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 42.8572%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Modifier</th>
<th class="tableblock halign-center valign-top">Left Justify</th>
<th class="tableblock halign-right valign-top">Min Width</th>
<th class="tableblock halign-right valign-top">Max Width</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">[%20c]</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">&nbsp;</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>[  org.jboss.example]</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">[%-20c]</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">&nbsp;</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>[org.jboss.example  ]</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">[%.10c]</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&nbsp;</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">&nbsp;</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>[org.jboss]</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">[%20.30c]</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">30</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>[  org.jboss.example]</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">[%-20.30c]</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">30</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>[org.jboss.example  ]</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="examples-2">Examples</h5>
<div class="listingblock">
<div class="title">Simple Pattern Formatter</div>
<div class="content">
<pre>/subsystem=logging/pattern-formatter=DEFAULT:add(pattern="%d{HH:mm:ssSSSXXX} %-5p [%c] (%t) %10.10#{jboss.node.name} %s%e%n")</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Color Pattern Formatter</div>
<div class="content">
<pre>/subsystem=logging/pattern-formatter=DEFAULT:add(color-map="info:cyan,warn:brightyellow,error:brightred,debug:magenta", pattern="%K{level}%d{yyyy-MM-dd'T'HH:mm:ssSSSXXX} %-5p [%c] (%t) %s%e%n")</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="xml-formatter">XML Formatter</h4>
<div class="paragraph">
<p>A formatter used to format log messages in XML.</p>
</div>
<div class="sect4">
<h5 id="examples-3">Examples</h5>
<div class="listingblock">
<div class="title">Simple XML Formatter</div>
<div class="content">
<pre>/subsystem=logging/xml-formatter=xml:add(pretty-print=true, exception-output-type=detailed-and-formatted)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Key Overrides XML Formatter</div>
<div class="content">
<pre>/subsystem=logging/xml-formatter=xml:add(pretty-print=true, print-namespace=true, namespace-uri="urn:custom:1.0", key-overrides={message=msg, record=logRecord, timestamp=date}, print-details=true)</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="custom-formatter">Custom Formatter</h4>
<div class="paragraph">
<p>A custom formatter to be used with handlers. Note that most log records are formatted in the printf format. Formatters
may require invocation of the <code>org.jboss.logmanager.ExtLogRecord#getFormattedMessage()</code> for the message to be properly
formatted.</p>
</div>
<div class="sect4">
<h5 id="examples-4">Examples</h5>
<div class="listingblock">
<div class="content">
<pre>/subsystem=logging/custom-formatter=custom:add(class=org.jboss.example.CustomFormatter, module=org.jboss.example, properties={prettyPrint=true,printDetails=true,bufferSize=1024})</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Logging_Handlers">Handlers</h3>
<div class="paragraph">
<p>WIP</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This is still a work in progress. Please feel free to edit any mistakes
you find <span class="icon yellow"><i class="fa fa-smile-o"></i></span>
</td>
</tr>
</table>
</div>
<div class="quoteblock abstract">
<blockquote>
Handlers are used to determine what happens with a log message if the
<a href="Logging_Loggers.html#Logging_Loggers">logger</a> determines the
message is loggable.
</blockquote>
</div>
<div class="paragraph">
<p>There are 6 main handlers provided with WildFly and 1 generic handler;</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#async-handler">async-handler</a></p>
</li>
<li>
<p><a href="#console-handler">console-handler</a></p>
</li>
<li>
<p><a href="#file-handler">file-handler</a></p>
</li>
<li>
<p><a href="#periodic-rotating-file-handler">periodic-rotating-file-handler</a></p>
</li>
<li>
<p><a href="#size-rotating-file-handler">size-rotating-file-handler</a></p>
</li>
<li>
<p><a href="#syslog-handler">syslog-handler</a></p>
</li>
<li>
<p><a href="#enabled">custom-handler</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="async-handler">async-handler</h5>
<div class="paragraph">
<p>An <code>async-handler</code> is a handler that asynchronously writes log messages
to it&#8217;s child handlers. This type of handler is generally used for other
handlers that take a substantial time to write logged messages.</p>
</div>
<div class="sect5">
<h6 id="attributes">Attributes</h6>
<div class="ulist">
<ul>
<li>
<p><a href="#enabled">#enabled</a></p>
</li>
<li>
<p><a href="#filter-spec">#filter-spec</a></p>
</li>
<li>
<p><a href="#level">#level</a></p>
</li>
<li>
<p><a href="#overflow-action">#overflow-action</a></p>
</li>
<li>
<p><a href="#queue-length">#queue-length</a></p>
</li>
<li>
<p><a href="#subhandlers">#subhandlers</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="console-handler">console-handler</h5>
<div class="paragraph">
<p>A <code>console-handler</code> is a handler that writes log messages to the
console. Generally this writes to <code>stdout</code>, but can be set to write to
<code>stderr</code>.</p>
</div>
<div class="sect5">
<h6 id="attributes-1">Attributes</h6>
<div class="ulist">
<ul>
<li>
<p><a href="#autoflush">#autoflush</a></p>
</li>
<li>
<p><a href="#enabled">#enabled</a></p>
</li>
<li>
<p><a href="#encoding">#encoding</a></p>
</li>
<li>
<p><a href="#filter-spec">#filter-spec</a></p>
</li>
<li>
<p><a href="#formatter">#formatter</a></p>
</li>
<li>
<p><a href="#level">#level</a></p>
</li>
<li>
<p><a href="#named-formatter">#named-formatter</a></p>
</li>
<li>
<p><a href="#target">#target</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="file-handler">file-handler</h5>
<div class="paragraph">
<p>A <code>file-handler</code> is a handler that writes log messages to the specified
file.</p>
</div>
<div class="sect5">
<h6 id="attributes-2">Attributes</h6>
<div class="ulist">
<ul>
<li>
<p><a href="#autoflush">#autoflush</a></p>
</li>
<li>
<p><a href="#enabled">#enabled</a></p>
</li>
<li>
<p><a href="#encoding">#encoding</a></p>
</li>
<li>
<p><a href="#filter-spec">#filter-spec</a></p>
</li>
<li>
<p><a href="#formatter">#formatter</a></p>
</li>
<li>
<p><a href="#level">#level</a></p>
</li>
<li>
<p><a href="#named-formatter">#named-formatter</a></p>
</li>
<li>
<p><a href="#file">#file</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="periodic-rotating-file-handler">periodic-rotating-file-handler</h5>
<div class="paragraph">
<p>A <code>periodic-rotating-file-handler</code> is a handler that writes log messages
to the specified file. The file rotates on the date pattern specified in
the <a href="#suffix">#suffix</a> attribute. The suffix must
be a valid pattern recognized by the
<a href="http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html"><code>java.text.SimpleDateFormat</code></a>
and must not rotate on seconds or milliseconds.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The rotate happens before the next message is written by the handler.
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="attributes-3">Attributes</h6>
<div class="ulist">
<ul>
<li>
<p><a href="#autoflush">#autoflush</a></p>
</li>
<li>
<p><a href="#enabled">#enabled</a></p>
</li>
<li>
<p><a href="#encoding">#encoding</a></p>
</li>
<li>
<p><a href="#filter-spec">#filter-spec</a></p>
</li>
<li>
<p><a href="#formatter">#formatter</a></p>
</li>
<li>
<p><a href="#level">#level</a></p>
</li>
<li>
<p><a href="#named-formatter">#named-formatter</a></p>
</li>
<li>
<p><a href="#file">#file</a></p>
</li>
<li>
<p><a href="#suffix">#suffix</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="size-rotating-file-handler">size-rotating-file-handler</h5>
<div class="paragraph">
<p>A <code>size-rotating-file-handler</code> is a handler that writes log messages to
the specified file. The file rotates when the file size is greater than
the <a href="#rotate-size">#rotate-size</a> attribute. The
rotated file will be kept and the index appended to the name moving
previously rotated file indexes up by 1 until the
<a href="#max-backup-index">#max-backup-index</a> is
reached. Once the
<a href="#max-backup-index">#max-backup-index</a> is
reached, the indexed files will be overwritten.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The rotate happens before the next message is written by the handler.
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="attributes-4">Attributes</h6>
<div class="ulist">
<ul>
<li>
<p><a href="#autoflush">#autoflush</a></p>
</li>
<li>
<p><a href="#enabled">#enabled</a></p>
</li>
<li>
<p><a href="#encoding">#encoding</a></p>
</li>
<li>
<p><a href="#filter-spec">#filter-spec</a></p>
</li>
<li>
<p><a href="#formatter">#formatter</a></p>
</li>
<li>
<p><a href="#level">#level</a></p>
</li>
<li>
<p><a href="#named-formatter">#named-formatter</a></p>
</li>
<li>
<p><a href="#file">#file</a></p>
</li>
<li>
<p><a href="#max-backup-index">#max-backup-index</a></p>
</li>
<li>
<p><a href="#rotate-size">#rotate-size</a></p>
</li>
<li>
<p><a href="#rotate-on-boot">#rotate-on-boot</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="syslog-handler">syslog-handler</h5>
<div class="paragraph">
<p>A <code>syslog-handler</code> is a handler that writes to a syslog server. The
handler support <a href="http://www.ietf.org/rfc/rfc3164.txt">RFC3164</a> or
<a href="http://www.ietf.org/rfc/rfc5424.txt">RFC5424</a> formats.</p>
</div>
<div class="sect5">
<h6 id="attributes-5">Attributes</h6>
<div class="ulist">
<ul>
<li>
<p><a href="#src-557084_Handlers-port">#port</a></p>
</li>
<li>
<p><a href="#src-557084_Handlers-app-name">#app-name</a></p>
</li>
<li>
<p><a href="#enabled">#enabled</a></p>
</li>
<li>
<p><a href="#level">#level</a></p>
</li>
<li>
<p><a href="#src-557084_Handlers-facility">#facility</a></p>
</li>
<li>
<p><a href="#src-557084_Handlers-server-address">#server-address</a></p>
</li>
<li>
<p><a href="#src-557084_Handlers-hostname">#hostname</a></p>
</li>
<li>
<p><a href="#src-557084_Handlers-syslog-format">#syslog-format</a></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The syslog-handler is missing some configuration properties that may be
useful in some scenarios like setting a formatter. Use the
<code>org.jboss.logmanager.handlers.SyslogHandler</code> in module
<code>org.jboss.logmanager</code> as a
<a href="#custom-handler">#custom-handler</a> to exploit
these benefits. Additional attributes will be added at some point so
this will no longer be necessary.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4">
<h5 id="custom-handler">custom-handler</h5>

</div>
<div class="sect4">
<h5 id="attributes-6">Attributes</h5>
<div class="sect5">
<h6 id="autoflush">autoflush</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">Indicates whether a flush should happen after each write.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true or false</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="enabled">enabled</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">If set to true the handler is enabled and functioning as
normal, if set to false the handler is ignored when processing log
messages.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true or false</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="encoding">encoding</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">The character encoding used by this Handler.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any valid encoding</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="file">file</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">An object describing the file the handler should write
to.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An object optionally containing a relative-to property
and a path. The path is a required property of the object.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="named-formatter">named-formatter</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">The name of a defined formatter to be used on the
handler.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TODO add link</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="formatter">formatter</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">Defines a pattern for a pattern formatter.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">%d\{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TODO add link</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="filter-spec">filter-spec</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">A filter expression value to define a filter.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See Filter Expression</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="level">level</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description :</th>
<th class="tableblock halign-left valign-top">The log level specifying which message levels will be
logged by this logger. Message levels lower than this value will be
discarded.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL FINEST FINER TRACE DEBUG FINE CONFIG INFO WARN
WARNING ERROR SEVERE FATAL OFF</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="max-backup-index">max-backup-index</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">The maximum number of rotated files to keep.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any integer greater than 0</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="overflow-action">overflow-action</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">Specify what action to take when the overflowing.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BLOCK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BLOCK or DISCARD</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="queue-length">queue-length</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">The queue length to use before flushing writing</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any positive integer</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="rotate-on-boot">rotate-on-boot</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">Indicates whether or not the file should be rotated each
time the #file attribute is changed. If set to true will rotate on each
boot of the server.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true or false</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="rotate-size">rotate-size</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">The size at which the file should be rotated.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2m</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any positive integer with a size type appended to the
end. Valid types are b for bytes, k for kilobytes, m for megabytes, g
for gigabytes or t for terabytes. Type character is not case sensitive.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="subhandlers">subhandlers</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">The handlers to associate with the async handler</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">list of strings</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An array of valid handler names</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="suffix">suffix</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">The pattern used to determine when the file should be
rotated.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any valid java.text.SimpleDateFormat pattern.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect5">
<h6 id="target">target</h6>
<div class="sidebarblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Description:</th>
<th class="tableblock halign-left valign-top">Defines the target of the console handler.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Value:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">System.out</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allowed Values:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">System.out or System.err</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Logging_How_To">How To</h3>
<div class="sect3">
<h4 id="how-do-i-add-a-log-category">How do I add a log category?</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=logging/logger=com.your.category:add</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="how-do-i-change-a-log-level">How do I change a log level?</h4>
<div class="paragraph">
<p>To change a handlers log level:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=logging/console-handler=CONSOLE:write-attribute(name=level,value=DEBUG)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Changing the level on a log category is the same:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=logging/logger=com.your.category:write-attribute(name=level,value=ALL)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="how-do-i-log-my-applications-messages-to-their-own-file">How do I log my applications messages to their own file?</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a file handler. There are 3 different types of file handlers
to choose from; <code>file-handler</code>, <code>periodic-rotating-file-handler</code> and
<code>size-rotating-file-handler</code>. In this example we&#8217;ll just use a simple
<code>file-handler</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=logging/file-handler=fh:add(level=INFO, file={"relative-to"=&gt;"jboss.server.log.dir", "path"=&gt;"fh.log"}, append=false, autoflush=true)</code></pre>
</div>
</div>
</li>
<li>
<p>Now create the log category.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=logging/logger=org.your.company:add(use-parent-handlers=false,handlers=["fh"])</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="how-do-i-use-log4j.properties-or-log4j.xml-instead-of-using-the-logging-subsystem-configuration">How do I use log4j.properties or log4j.xml instead of using the</h4>
<div class="paragraph">
<p>logging subsystem configuration?</p>
</div>
<div class="paragraph">
<p>First note that if you choose to use a log4j configuration file, you
will no longer be able to make runtime logging changes to your
deployments logging configuration.</p>
</div>
<div class="paragraph">
<p>If that is acceptable you can use
<a href="Logging_Configuration.html#src-557095_LoggingConfiguration-Per-deploymentLogging">per-deployment
logging</a> and just include a configuration file in your deployment.</p>
</div>
</div>
<div class="sect3">
<h4 id="how-do-i-use-my-own-version-of-log4j">How do I use my own version of log4j?</h4>
<div class="paragraph">
<p>If you need/want to include your version of log4j then you need to do
the following two steps.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Disable the adding of the logging dependencies to all your
deployments with the
<a href="Logging_Configuration.html#src-557095_LoggingConfiguration-add-logging-api-dependencies">add-logging-api-dependencies</a>
attribute and disable the
<a href="Logging_Configuration.html#src-557095_LoggingConfiguration-use-deployment-logging-config">use-deployment-logging-config</a>
attribute <strong>OR</strong> exclude the logging subsystem in a
<a href="Class_Loading_in_WildFly.html#src-557206_ClassLoadinginWildFly-JBossDeploymentStructureFile">jboss-deployment-structure.xml</a>.</p>
</li>
<li>
<p>Then need to include a log4j library in your deployment.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This only works for logging in your deployment. Server logs will
continue to use the logging subsystem configuration.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Logging_Loggers">Loggers</h3>
<div class="paragraph">
<p>WIP</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This is still a work in progress. Please feel free to edit any mistakes
you find <span class="icon yellow"><i class="fa fa-smile-o"></i></span>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="overview">Overview</h4>
<div class="paragraph">
<p>Loggers are used to log messages. A logger is defined by a category
generally consisting of a package name or a class name.</p>
</div>
<div class="paragraph">
<p>A logger is the first step to determining if a messages should be logged
or not. If a logger is defined with a level, the level of the message
must be greater than the level defined on the logger. The filter is then
checked next and the rules of the filter will determine whether or not
the messages is said to be loggable.</p>
</div>
<div class="sect4">
<h5 id="logger-resource">Logger Resource</h5>
<div class="paragraph">
<p>A logger resource uses the path <code>subsystem=logging/logger=$category</code>
where <code>$category</code> is the of the logger. For example to a logger named
org.wildfly.example would have a resource path of
<code>subsystem=logging/logger=org.wildfly.example</code>.</p>
</div>
<div class="paragraph">
<p>A logger as 4 writeable attributes;</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#filter-spec">filter-spec</a></p>
</li>
<li>
<p><a href="#level">#handlers</a></p>
</li>
<li>
<p><a href="#level">#level</a></p>
</li>
<li>
<p><a href="#Loggers-use-parent-handlers">use-parent-handlers</a></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You may notice that the <code>category</code> and <code>filter</code> attributes are missing.
While <code>filter</code> is writable it may be deprecated and removed in the
future. Both attributes are still on the resource for legacy reasons.
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="filter-spec-2">filter-spec</h6>
<div class="paragraph">
<p>The <code>filter-spec</code> attribute is an expression based string to define
filters for the logger.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Filters on loggers are not inherited.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="handlers">handlers</h6>
<div class="paragraph">
<p>The <code>handlers</code> attribute is a list of handler names that should be
attached to the logger. If the
<a href="#use-parent-handlers">use-parent-handlers</a>
attribute is set to <code>true</code> and the log messages is determined to be
loggable, parent loggers will continue to be processed.</p>
</div>
</div>
<div class="sect5">
<h6 id="level-2">level</h6>
<div class="paragraph">
<p>The <code>level</code> attribute allows the minimum level to allow messages to be
logged at for the logger.</p>
</div>
</div>
<div class="sect5">
<h6 id="use-parent-handlers">use-parent-handlers</h6>
<div class="paragraph">
<p>The <code>use-parent-handlers</code> attribute is a boolean attribute to determine
whether or not parent loggers should also process the log message.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="root-logger-resource">Root Logger Resource</h5>
<div class="paragraph">
<p>The <code>root-logger</code> is similar to a
<a href="#logger-resource">#Logger Resource</a> only it has no
category and it&#8217;s name is must be <code>ROOT</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="logger-hierarchy">Logger Hierarchy</h5>
<div class="paragraph">
<p>A logger hierarchy is defined by it&#8217;s category. The category is a <code>.</code>
(dot) delimited string generally consisting of the package name or a
class name. For example the logger <code>org.wildfly</code> is the parent logger of
<code>org.wildfly.example</code>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="EJB3">EJB3 subsystem configuration guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This page lists the options that are available for configuring the EJB
subsystem.</p>
</div>
<div class="paragraph">
<p>A complete example of the config is shown below, with a full explanation
of each</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:ejb3:1.2"&gt;
  &lt;session-bean&gt;
    &lt;stateless&gt;
      &lt;bean-instance-pool-ref pool-name="slsb-strict-max-pool"/&gt;
    &lt;/stateless&gt;
    &lt;stateful default-access-timeout="5000" cache-ref="simple" clustered-cache-ref="clustered"/&gt;
    &lt;singleton default-access-timeout="5000"/&gt;
  &lt;/session-bean&gt;
  &lt;mdb&gt;
    &lt;resource-adapter-ref resource-adapter-name="hornetq-ra"/&gt;
    &lt;bean-instance-pool-ref pool-name="mdb-strict-max-pool"/&gt;
  &lt;/mdb&gt;
  &lt;entity-bean&gt;
    &lt;bean-instance-pool-ref pool-name="entity-strict-max-pool"/&gt;
  &lt;/entity-bean&gt;
Â  &lt;pools&gt;
    &lt;bean-instance-pools&gt;
      &lt;strict-max-pool name="slsb-strict-max-pool" max-pool-size="20" instance-acquisition-timeout="5" instance-acquisition-timeout-unit="MINUTES"/&gt;
      &lt;strict-max-pool name="mdb-strict-max-pool" max-pool-size="20" instance-acquisition-timeout="5" instance-acquisition-timeout-unit="MINUTES"/&gt;
      &lt;strict-max-pool name="entity-strict-max-pool" max-pool-size="100" instance-acquisition-timeout="5" instance-acquisition-timeout-unit="MINUTES"/&gt;
 Â &lt;/bean-instance-pools&gt;
  &lt;/pools&gt;
  &lt;caches&gt;
    &lt;cache name="simple" aliases="NoPassivationCache"/&gt;
    &lt;cache name="passivating" passivation-store-ref="file" aliases="SimpleStatefulCache"/&gt;
    &lt;cache name="clustered" passivation-store-ref="infinispan" aliases="StatefulTreeCache"/&gt;
  &lt;/caches&gt;
  &lt;passivation-stores&gt;
    &lt;file-passivation-store name="file"/&gt;
    &lt;cluster-passivation-store name="infinispan" cache-container="ejb"/&gt;
  &lt;/passivation-stores&gt;
  &lt;async thread-pool-name="default"/&gt;
  &lt;timer-service thread-pool-name="default"&gt;
    &lt;data-store path="timer-service-data" relative-to="jboss.server.data.dir"/&gt;
  &lt;/timer-service&gt;
  &lt;remote connector-ref="remoting-connector" thread-pool-name="default"/&gt;
  &lt;thread-pools&gt;
    &lt;thread-pool name="default"&gt;
      &lt;max-threads count="10"/&gt;
      &lt;keepalive-time time="100" unit="milliseconds"/&gt;
      &lt;/thread-pool&gt;
  &lt;/thread-pools&gt;
  &lt;iiop enable-by-default="false" use-qualified-name="false"/&gt;
  &lt;in-vm-remote-interface-invocation pass-by-value="false"/&gt; &lt;!-- Warning see notes below about possible issues --&gt;
&lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="session-bean">&lt;session-bean&gt;</h3>
<div class="sect3">
<h4 id="stateless">&lt;stateless&gt;</h4>
<div class="paragraph">
<p>This element is used to configure the instance pool that is used by
default for stateless session beans. If it is not present stateless
session beans are not pooled, but are instead created on demand for
every invocation. The instance pool can be overridden on a per
deployment or per bean level using <code>jboss-ejb3.xml</code> or the
<code>org.jboss.ejb3.annotation.Pool</code> annotation. The instance pools
themselves are configured in the <code>&lt;pools&gt;</code> element.</p>
</div>
</div>
<div class="sect3">
<h4 id="stateful">&lt;stateful&gt;</h4>
<div class="paragraph">
<p>This element is used to configure Stateful Session Beans.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>default-access-timeout</code> This attribute specifies the default time
concurrent invocations on the same bean instance will wait to acquire
the instance lock. It can be overridden via the deployment descriptor or
via the <code>javax.ejb.AccessTimeout</code> annotation.</p>
</li>
<li>
<p><code>cache-ref</code> This attribute is used to set the default cache for
non-clustered beans. It can be overridden by <code>jboss-ejb3.xml</code>, or via
the <code>org.jboss.ejb3.annotation.Cache</code> annotation.</p>
</li>
<li>
<p><code>clustered-cache-ref</code> This attribute is used to set the default cache
for clustered beans.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="singleton">&lt;singleton&gt;</h4>
<div class="paragraph">
<p>This element is used to configure Singleton Session Beans.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>default-access-timeout</code> This attribute specifies the default time
concurrent invocations will wait to acquire the instance lock. It can be
overridden via the deployment descriptor or via the
<code>javax.ejb.AccessTimeout</code> annotation.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mdb">&lt;mdb&gt;</h3>
<div class="sect3">
<h4 id="resource-adaptor-ref">&lt;resource-adaptor-ref&gt;</h4>
<div class="paragraph">
<p>This element sets the default resource adaptor for Message Driven Beans.</p>
</div>
</div>
<div class="sect3">
<h4 id="bean-instance-pool-ref">&lt;bean-instance-pool-ref&gt;</h4>
<div class="paragraph">
<p>This element is used to configure the instance pool that is used by
default for Message Driven Beans. If it is not present they are not
pooled, but are instead created on demand for every invocation. The
instance pool can be overridden on a per deployment or per bean level
using <code>jboss-ejb3.xml</code> or the <code>org.jboss.ejb3.annotation.Pool</code>
annotation. The instance pools themselves are configured in the
<code>&lt;pools&gt;</code> element.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="entity-bean">&lt;entity-bean&gt;</h3>
<div class="paragraph">
<p>This element is used to configure the behavior for EJB2 EntityBeans.</p>
</div>
<div class="sect3">
<h4 id="bean-instance-pool-ref-1">&lt;bean-instance-pool-ref&gt;</h4>
<div class="paragraph">
<p>This element is used to configure the instance pool that is used by
default for Entity Beans. If it is not present they are not pooled, but
are instead created on demand for every invocation. The instance pool
can be overridden on a per deployment or per bean level using
<code>jboss-ejb3.xml</code> or the <code>org.jboss.ejb3.annotation.Pool</code> annotation. The
instance pools themselves are configured in the <code>&lt;pools&gt;</code> element.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pools">&lt;pools&gt;</h3>

</div>
<div class="sect2">
<h3 id="caches">&lt;caches&gt;</h3>

</div>
<div class="sect2">
<h3 id="passivation-stores">&lt;passivation-stores&gt;</h3>

</div>
<div class="sect2">
<h3 id="async">&lt;async&gt;</h3>
<div class="paragraph">
<p>This element enables async EJB invocations. It is also used to specify
the thread pool that these invocations will use.</p>
</div>
</div>
<div class="sect2">
<h3 id="timer-service">&lt;timer-service&gt;</h3>
<div class="paragraph">
<p>This element enables the EJB timer service. It is also used to specify
the thread pool that these invocations will use.</p>
</div>
<div class="sect3">
<h4 id="data-store">&lt;data-store&gt;</h4>
<div class="paragraph">
<p>This is used to configure the directory that persistent timer
information is saved to.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="remote">&lt;remote&gt;</h3>
<div class="paragraph">
<p>This is used to enable remote EJB invocations. It specifies the remoting
connector to use (as defined in the remoting subsystem configuration),
and the thread pool to use for remote invocations.</p>
</div>
</div>
<div class="sect2">
<h3 id="thread-pools">&lt;thread-pools&gt;</h3>
<div class="paragraph">
<p>This is used to configure the thread pools used by async, timer and
remote invocations.</p>
</div>
</div>
<div class="sect2">
<h3 id="iiop">&lt;iiop&gt;</h3>
<div class="paragraph">
<p>This is used to enable IIOP (i.e. CORBA) invocation of EJB&#8217;s. If this
element is present then the JacORB subsystem must also be installed. It
supports the following two attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>enable-by-default</code> If this is true then all EJB&#8217;s with EJB2.x home
interfaces are exposed via IIOP, otherwise they must be explicitly
enabled via <code>jboss-ejb3.xml</code>.</p>
</li>
<li>
<p><code>use-qualified-name</code> If this is true then EJB&#8217;s are bound to the corba
naming context with a binding name that contains the application and
modules name of the deployment (e.g. myear/myejbjar/MyBean), if this is
false the default binding name is simply the bean name.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="in-vm-remote-interface-invocation">&lt;in-vm-remote-interface-invocation&gt;</h3>
<div class="paragraph">
<p>By default remote interface invocations use pass by value, as required
by the EJB spec. This element can use used to enable pass by reference,
which can give you a performance boost. Note WildFly will do a shallow
check to see if the caller and the EJB have access to the same class
definitions, which means if you are passing something such as a
List&lt;MyObject&gt;, WildFly only checks the List to see if it is the same
class definition on the call &amp; EJB side. If the top level class
definition is the same, JBoss will make the call using pass by
reference, which means that if MyObject or any objects beneath it are
loaded from different classloaders, you would get a ClassCastException.
If the top level class definitions are loaded from different
classloaders, JBoss will use pass by value. JBoss cannot do a deep check
of all of the classes to ensure no ClassCastExceptions will occur
because doing a deep check would eliminate any performance boost you
would have received by using call by reference. It is recommended that
you configure pass by reference only on callers that you are sure will
use the same class definitions and not globally. This can be done via a
configuration in the jboss-ejb-client.xml as shown below.</p>
</div>
<div class="paragraph">
<p>To configure a caller/client use pass by reference, you configure your
top level deployment with a META-INF/jboss-ejb-client.xml containing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;jboss-ejb-client xmlns="urn:jboss:ejb-client:1.0"&gt;
Â Â Â Â &lt;client-context&gt;
Â Â Â Â Â Â Â Â &lt;ejb-receivers local-receiver-pass-by-value="false"/&gt;
Â Â Â Â &lt;/client-context&gt;
&lt;/jboss-ejb-client&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Undertow">Undertow subsystem configuration</h2>
<div class="sectionbody">
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Web subsystem was replaced in WildFly 8 with Undertow.</strong></p>
</div>
</div>
</div>
<div class="paragraph">
<p>There are two main parts to the undertow subsystem, which are server and
Servlet container configuration, as well as some ancillary items.
Advanced topics like load balancing and failover are covered on the
"High Availability Guide". The default configuration does is suitable
for most use cases and provides reasonable performance settings.</p>
</div>
<div class="paragraph">
<p><strong>Required extension:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;extension module="org.wildfly.extension.undertow" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Basic subsystem configuration example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:undertow:1.0"&gt;
        &lt;buffer-caches&gt;
            &lt;buffer-cache name="default" buffer-size="1024" buffers-per-region="1024" max-regions="10"/&gt;
        &lt;/buffer-caches&gt;
        &lt;server name="default-server"&gt;
            &lt;http-listener name="default" socket-binding="http" /&gt;
            &lt;host name="default-host" alias="localhost"&gt;
                &lt;location name="/" handler="welcome-content" /&gt;
            &lt;/host&gt;
        &lt;/server&gt;
        &lt;servlet-container name="default" default-buffer-cache="default" stack-trace-on-error="local-only" &gt;
            &lt;jsp-config/&gt;
            &lt;persistent-sessions/&gt;
        &lt;/servlet-container&gt;
        &lt;handlers&gt;
            &lt;file name="welcome-content" path="${jboss.home.dir}/welcome-content" directory-listing="true"/&gt;
        &lt;/handlers&gt;
    &lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Dependencies on other subsystems:</strong></p>
</div>
<div class="paragraph">
<p>IO Subsystem</p>
</div>
<div class="sect2">
<h3 id="buffer-cache-configuration">Buffer cache configuration</h3>
<div class="paragraph">
<p>The buffer cache is used for caching content, such as static files.
Multiple buffer caches can be configured, which allows for separate
servers to use different sized caches.</p>
</div>
<div class="paragraph">
<p>Buffers are allocated in regions, and are of a fixed size. If you are
caching many small files then using a smaller buffer size will be
better.</p>
</div>
<div class="paragraph">
<p>The total amount of space used can be calculated by multiplying the
buffer size by the number of buffers per region by the maximum number of
regions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">  &lt;buffer-caches&gt;
    &lt;buffer-cache name="default" buffer-size="1024" buffers-per-region="1024" max-regions="10"/&gt;
  &lt;/buffer-caches&gt;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">buffer-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The size of the buffers. Smaller buffers allow space to be
utilised more effectively</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">buffers-per-region</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The numbers of buffers per region</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-regions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of regions. This controls the maximum
amount of memory that can be used for caching</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="server-configuration">Server configuration</h3>
<div class="paragraph">
<p>A server represents an instance of Undertow. Basically this consists of
a set of connectors and some configured handlers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;server name="default-server" default-host="default-host" servlet-container="default" &gt;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the virtual host that will be used if an incoming request
as no Host: header</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">servlet-container</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the servlet container that will be used by this
server, unless is is explicitly overriden by the deployment</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="connector-configuration">Connector configuration</h4>
<div class="paragraph">
<p>Undertow provides HTTP, HTTPS and AJP connectors, which are configured
per server.</p>
</div>
<div class="sect4">
<h5 id="common-settings">Common settings</h5>
<div class="paragraph">
<p>The following settings are common to all connectors:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">socket-binding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The socket binding to use. This determines the address
and port the listener listens on.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">worker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A reference to an XNIO worker, as defined in the IO subsystem.
The worker that is in use controls the IO and blocking thread pool.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">buffer-pool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A reference to a buffer pool as defined in the IO
subsystem. These buffers are used internally to read and write requests.
In general these should be at least 8k, unless you are in a memory
constrained environment.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the connector is enabled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-post-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum size of incoming post requests that is
allowed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">buffer-pipelined-data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If responses to HTTP pipelined requests should
be buffered, and send out in a single write. This can improve
performance if HTTP pipe lining is in use and responses are small.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-header-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum size of a HTTP header block that is
allowed. Responses with to much data in their header block will have the
request terminated and a bad request response send.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of query or path parameters that are
allowed. This limit exists to prevent hash collision based DOS attacks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-headers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of headers that are allowed. This limit
exists to prevent hash collision based DOS attacks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-cookies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of cookies that are allowed. This limit
exists to prevent hash collision based DOS attacks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allow-encoded-slash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set this to true if you want the server to decode
percent encoded slash characters. This is probably a bad idea, as it can
have security implications, due to different servers interpreting the
slash differently. Only enable this if you have a legacy application
that requires it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">decode-url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the URL should be decoded. If this is not set to true
then percent encoded characters in the URL will be left as is.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">url-charset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The charset to decode the URL to.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">always-set-keep-alive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the 'Connection: keep-alive' header should be
added to all responses, even if not required by spec.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">disallowed-methods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A comma separated list of HTTP methods that are not
allowed. HTTP TRACE is disabled by default.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="http-connector">HTTP Connector</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;http-listener name="default" socket-binding="http"  /&gt;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">certificate-forwarding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If this is set to true then the HTTP listener
will read a client certificate from the SSL_CLIENT_CERT header. This
allows client cert authentication to be used, even if the server does
not have a direct SSL connection to the end user. This should only be
enabled for servers behind a proxy that has been configured to always
set these headers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">redirect-socket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The socket binding to redirect requests that require
security too.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">proxy-address-forwarding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If this is enabled then the X-Forwarded-For
and X-Forwarded-Proto headers will be used to determine the peer
address. This allows applications that are behind a proxy to see the
real address of the client, rather than the address of the proxy.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="https-listener">HTTPS listener</h5>
<div class="paragraph">
<p>Https listener provides secure access to the server. The most important
configuration option is security realm which defines SSL secure context.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;https-listener name="default" socket-binding="https" security-realm="ssl-realm" /&gt;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">security-realm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The security realm to use for the SSL configuration.
See Security realm examples for how to configure it: Examples</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">verify-client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One of either NOT_REQUESTED, REQUESTED or REQUIRED. If
client cert auth is in use this should be either REQUESTED or REQUIRED.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enabled-cipher-suites</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A list of cypher suit names that are allowed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="ajp-listener">AJP listener</h5>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;ajp-listener name="default" socket-binding="ajp" /&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="host-configuration">Host configuration</h4>
<div class="paragraph">
<p>The host element corresponds to a virtual host.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The virtual host name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">alias</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A whitespace separated list of additional host names that should
be matched</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-web-module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a deployment that should be used to
serve up requests that do not match anything.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="servlet-container-configuration">Servlet container configuration</h3>
<div class="paragraph">
<p>The servlet-container element corresponds to an instance of an Undertow
Servlet container. Most servers will only need a single servlet
container, however there may be cases where it makes sense to define
multiple containers (in particular if you want applications to be
isolated, so they cannot dispatch to each other using the
RequestDispatcher. You can also use multiple Servlet containers to serve
different applications from the same context path on different virtual
hosts).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allow-non-standard-wrappers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Servlet specification requires
applications to only wrap the request/response using wrapper classes
that extend from the ServletRequestWrapper and ServletResponseWrapper
classes. If this is set to true then this restriction is relaxed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-buffer-cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The buffer cache that is used to cache static
resources in the default Servlet.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stack-trace-on-error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can be either all, none, or local-only. When set
to none Undertow will never display stack traces. When set to All
Undertow will always display them (not recommended for production use).
When set to local-only Undertow will only display them for requests from
local addresses, where there are no headers to indicate that the request
has been proxied. Note that this feature means that the Undertow error
page will be displayed instead of the default error page specified in
web.xml.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-encoding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default encoding to use for requests and
responses.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">use-listener-encoding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If this is true then the default encoding will
be the same as that used by the listener that received the request.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="jsp-configuration">JSP configuration</h4>

</div>
<div class="sect3">
<h4 id="session-cookie-configuration">Session Cookie Configuration</h4>
<div class="paragraph">
<p>This allows you to change the attributes of the session cookie.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cookie name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cookie domain</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">comment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cookie comment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">http-only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the cookie is HTTP only</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">secure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the cookie is marked secure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-age</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The max age of the cookie</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="persistent-session-configuration">Persistent Session Configuration</h4>
<div class="paragraph">
<p>Persistent sessions allow session data to be saved across redeploys and
restarts. This feature is enabled by adding the persistent-sessions
element to the server config. This is mostly intended to be a
development time feature.</p>
</div>
<div class="paragraph">
<p>If the path is not specified then session data is stored in memory, and
will only be persistent across redeploys, rather than restarts.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path to the persistent sessions data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relative-to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The location that the path is relevant to</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="Undertow_AJP_listeners">AJP listeners</h3>
<div class="paragraph">
<p>The AJP listeners are child resources of the subsystem undertow. They
are used with mod_jk, mod_proxy and mod_cluster of the Apache httpd
front-end. Each listener does reference a particular socket binding:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9999 /] /subsystem=undertow/server=default-server:read-children-names(child-type=ajp-listener)
{
    "outcome" =&gt; "success",
    "result" =&gt; [
        "ajp-listener",
    ]
}
Â 
[standalone@localhost:9999 /] /subsystem=undertow/server=default-server/ajp-listener=*:read-resource(recursive=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "enabled" =&gt; "true",
        "scheme" =&gt; "http",
        "socket-binding" =&gt; "ajp",
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Creating a new <code>ajp-listener</code> requires you to declare a new
<code>socket binding</code> first:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9999 /] /socket-binding-group=standard-sockets/socket-binding=ajp:add(port=8009)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The newly created, unused socket binding can then be used to create a
new connector configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9999 /] /subsystem=undertow/server=default-server/ajp-listener=myListener:add(socket-binding=ajp, scheme=http, enabled=true)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Undertow_using_as_a_Load_Balancer">Using Wildfly as a Load Balancer</h3>
<div class="paragraph">
<p>Wildfly 10 adds support for using the Undertow subsystem as a load
balancer. Wildfly supports two different approaches, you can either
define a static load balancer, and specify the back end hosts in your
configuration, or use it as a mod_cluster frontend, and use mod_cluster
to dynamically update the hosts.</p>
</div>
<div class="sect3">
<h4 id="general-overview">General Overview</h4>
<div class="paragraph">
<p>Wildly uses Undertow&#8217;s proxy capabilities to act as a load balancer.
Undertow will connect to the back end servers using its built in client,
and proxies requests.</p>
</div>
<div class="paragraph">
<p>The following protocols are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>http</p>
</li>
<li>
<p>ajp</p>
</li>
<li>
<p>http2</p>
</li>
<li>
<p>h2c (clear text HTTP2)<br>
Of these protocols h2c should give the best performance, if the back end
servers support it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Undertow proxy uses async IO, the only threads that are involved in
the request is the IO thread that is responsible for the connection. The
connection to the back end server is made from the same thread, which
removes the need for any thread safety constructs.<br>
If both the front and back end servers support server push, and HTTP2 is
in use then the proxy also supports pushing responses to the client. In
cases where proxy and backend are capable of server push, but the client
does not support it the server will send a X-Disable-Push header to let
the backend know that it should not attempt to push for this request.</p>
</div>
<div class="sect4">
<h5 id="load-balancer-server-profiles">Load balancer server profiles</h5>
<div class="paragraph">
<p>WildFly 11 adds load balancer profiles for both standalone and domain modes.</p>
</div>
<div class="sect5">
<h6 id="example-start-standalone-load-balancer">Example: Start standalone load balancer</h6>
<div class="listingblock">
<div class="content">
<pre># configure correct path to WildFly installation
WILDFLY_HOME=/path/to/wildfly
# configure correct IP of the node
MY_IP=192.168.1.1

# run the load balancer profile
$WILDFLY_HOME/bin/standalone.sh -b $MY_IP -bprivate $MY_IP -c standalone-load-balancer.xml</pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s highly recommended to use private/internal network for communication between load balancer and nodes. To do this set the correct IP address to the {{private}} interface ({{-bprivate}} argument).</p>
</div>
</div>
<div class="sect5">
<h6 id="example-start-worker-node">Example: Start worker node</h6>
<div class="paragraph">
<p>Run the server with the HA (or Full HA) profile, which has {{mod_cluster}} component included. If the UDP multicast is working in your environment, the workers should work out of the box without any change. If it&#8217;s not the case, then configure the IP address of the load-balancer statically.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># configure correct path to WildFly installation
WILDFLY_HOME=/path/to/wildfly
# configure correct IP of the node
MY_IP=192.168.1.2

# Configure static load balancer IP address.
# This is necessary when UDP multicast doesn't work in your environment.
LOAD_BALANCER_IP=192.168.1.1
$WILDFLY_HOME/bin/jboss-cli.sh &lt;&lt;EOT
embed-server -c=standalone-ha.xml
/subsystem=modcluster/mod-cluster-config=configuration:write-attribute(name=advertise,value=false)
/socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=proxy1:add(host=$LOAD_BALANCER_IP,port=8090)
/subsystem=modcluster/mod-cluster-config=configuration:list-add(name=proxies,value=proxy1)
EOT

# start the woker node with HA profile
$WILDFLY_HOME/bin/standalone.sh -c standalone-ha.xml -b $MY_IP -bprivate $MY_IP</pre>
</div>
</div>
<div class="paragraph">
<p>Again, to make it safe, users should configure private/internal IP address into {{MY_IP}} variable.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-wildly-as-a-static-load-balancer">Using Wildly as a static load balancer</h4>
<div class="paragraph">
<p>To use WildFly as a static load balancer the first step is to create a
proxy handler in the Undertow subsystem. For the purposes of this
example we are going to assume that our load balancer is going to load
balance between two servers, sv1.foo.com and sv2.foo.com, and will be
using the AJP protocol.</p>
</div>
<div class="paragraph">
<p>The first step is to add a reverse proxy handler to the Undertow
subsystem:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=undertow/configuration=handler/reverse-proxy=my-handler:add()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we need to define outbound socket bindings for remote hosts</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=remote-host1/:add(host=sv1.foo.com, port=8009)
/socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=remote-host2/:add(host=sv2.foo.com, port=8009)</code></pre>
</div>
</div>
<div class="paragraph">
<p>and than we add them as hosts to reverse proxy handler</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=undertow/configuration=handler/reverse-proxy=my-handler/host=host1:add(outbound-socket-binding=remote-host1, scheme=ajp, instance-id=myroute, path=/test)
/subsystem=undertow/configuration=handler/reverse-proxy=my-handler/host=host2:add(outbound-socket-binding=remote-host2, scheme=ajp, instance-id=myroute, path=/test)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we need to actually add the reverse proxy to a location. I am going
to assume we are serving the path <code>/app</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=undertow/server=default-server/host=default-host/location=\/app:add(handler=my-handler)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is all there is to it. If you point your browser to
<code><a href="http://localhost:8080/app" class="bare">http://localhost:8080/app</a></code> you should be able to see the proxied
content.</p>
</div>
<div class="paragraph">
<p>The full details of all configuration options available can be found in
the <a href="https://wildscribe.github.io/WildFly/10.1/subsystem/undertow/index.html">subsystem reference</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Messaging">Messaging configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The JMS server configuration is done through the <em>messaging-activemq</em>
subsystem. In this chapter we are going outline the frequently used
configuration options. For a more detailed explanation please consult
the Artemis user guide (See "Component Reference").</p>
</div>
<div class="sect2">
<h3 id="required-extension">Required Extension</h3>
<div class="paragraph">
<p>The configuration options discussed in this section assume that the the
<code>org.wildfly.extension.messaging-activemq</code> extension is present in your
configuration. This extension is not included in the standard
<code>standalone.xml</code> and <code>standalone-ha.xml</code> configurations included in the
WildFly distribution. It is, however, included with the
<code>standalone-full.xml</code> and <code>standalone-full-ha.xml</code> configurations.</p>
</div>
<div class="paragraph">
<p>You can add the extension to a configuration without it either by adding
an <code>&lt;extension module="org.wildfly.extension.messaging-activemq"/&gt;</code>
element to the xml or by using the following CLI operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /]/extension=org.wildfly.extension.messaging-activemq:add</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="connectors">Connectors</h3>
<div class="paragraph">
<p>There are three kind of connectors that can be used to connect to
WildFly JMS Server</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>invm-connector</code> can be used by a local client (i.e. one running in
the same JVM as the server)</p>
</li>
<li>
<p><code>netty-connector</code> can be used by a remote client (and uses Netty over
TCP for the communication)</p>
</li>
<li>
<p><code>http-connector</code> can be used by a remote client (and uses Undertow Web
Server to upgrade from a HTTP connection)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="jms-connection-factories">JMS Connection Factories</h3>
<div class="paragraph">
<p>There are three kinds of <em>basic</em> JMS <code>connection-factory</code> that depends
on the type of connectors that is used.</p>
</div>
<div class="paragraph">
<p>There is also a <code>pooled-connection-factory</code> which is special in that it
is essentially a configuration facade for <em>both</em> the inbound and
outbound connectors of the the Artemis JCA Resource Adapter. An MDB can
be configured to use a <code>pooled-connection-factory</code> (e.g. using
<code>@ResourceAdapter</code>). In this context, the MDB leverages the <em>inbound
connector</em> of the Artemis JCA RA. Other kinds of clients can look up the
pooled-connection-factory in JNDI (or inject it) and use it to send
messages. In this context, such a client would leverage the <em>outbound
connector</em> of the Artemis JCA RA. A <code>pooled-connection-factory</code> is also
special because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is only available to local clients, although it can be configured
to point to a remote server.</p>
</li>
<li>
<p>As the name suggests, it is pooled and therefore provides superior
performance to the clients which are able to use it. The pool size can
be configured via the <code>max-pool-size</code> and <code>min-pool-size</code> attributes.</p>
</li>
<li>
<p>It should only be used to <em>send</em> (i.e. produce) messages when looked
up in JNDI or injected.</p>
</li>
<li>
<p>It can be configured to use specific security credentials via the
<code>user</code> and <code>password</code> attributes. This is useful if the remote server to
which it is pointing is secured.</p>
</li>
<li>
<p>Resources acquired from it will be automatically enlisted any on-going
JTA transaction. If you want to send a message from an EJB using CMT
then this is likely the connection factory you want to use so the send
operation will be atomically committed along with the rest of the EJB&#8217;s
transaction operations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To be clear, the <em>inbound connector</em> of the Artemis JCA RA (which is for
consuming messages) is only used by MDBs and other JCA-based components.
It is not available to traditional clients.</p>
</div>
<div class="paragraph">
<p>Both a <code>connection-factory</code> and a <code>pooled-connection-factory</code> reference
a <code>connector</code> declaration.</p>
</div>
<div class="paragraph">
<p>A <code>netty-connector</code> is associated with a <code>socket-binding</code> which tells
the client using the <code>connection-factory</code> where to connect.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>connection-factory</code> referencing a <code>netty-connector</code> is suitable to
be used by a <em>remote</em> client to send messages to or receive messages
from the server (assuming the connection-factory has an appropriately
exported <code>entry</code>).</p>
</li>
<li>
<p>A <code>pooled-connection-factory</code> looked up in JNDI or injected which is
referencing a <code>netty-connector</code> is suitable to be used by a <em>local</em>
client to send messages to a remote server granted the <code>socket-binding</code>
references an <code>outbound-socket-binding</code> pointing to the remote server in
question.</p>
</li>
<li>
<p>A <code>pooled-connection-factory</code> used by an MDB which is referencing a
<code>remote-connector</code> is suitable to consume messages from a remote server
granted the <code>socket-binding</code> references an <code>outbound-socket-binding</code>
pointing to the remote server in question.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An <code>in-vm-connector</code> is associated with a <code>server-id</code> which tells the
client using the <code>connection-factory</code> where to connect (since multiple
Artemis servers can run in a single JVM).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>connection-factory</code> referencing an <code>in-vm-connector</code> is suitable to
be used by a <em>local</em> client to either send messages to or receive
messages from a local server.</p>
</li>
<li>
<p>A <code>pooled-connection-factory</code> looked up in JNDI or injected which is
referencing an <code>in-vm-connector</code> is suitable to be used by a <em>local</em>
client only to send messages to a local server.</p>
</li>
<li>
<p>A <code>pooled-connection-factory</code> used by an MDB which is referencing an
<code>in-vm-connector</code> is suitable only to consume messages from a local
server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <code>http-connector</code> is associated with the <code>socket-binding</code> that
represents the HTTP socket (by default, named <code>http</code>).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>connection-factory</code> referencing a <code>http-connector</code> is suitable to
be used by a remote client to send messages to or receive messages from
the server by connecting to its HTTP port before upgrading to the
messaging protocol.</p>
</li>
<li>
<p>A <code>pooled-connection-factory</code> referencing a <code>http-connector</code> is
suitable to be used by a local client to send messages to a remote
server granted the <code>socket-binding</code> references an
<code>outbound-socket-binding</code> pointing to the remote server in question.</p>
</li>
<li>
<p>A <code>pooled-connection-factory</code> used by an MDB which is referencing a
<code>http-connector</code> is suitable only to consume messages from a remote
server granted the <code>socket-binding</code> references an
<code>outbound-socket-binding</code> pointing to the remote server in question.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>entry</code> declaration of a <code>connection-factory</code> or a
<code>pooled-connection-factory</code> specifies the JNDI name under which the
factory will be exposed. Only JNDI names bound in the
<code>"java:jboss/exported"</code> namespace are available to remote clients. If a
<code>connection-factory</code> has an entry bound in the <code>"java:jboss/exported"</code>
namespace a remote client would look-up the <code>connection-factory</code> using
the text <em>after</em> <code>"java:jboss/exported"</code>. For example, the "
<code>RemoteConnectionFactory`" is bound by default to
`"java:jboss/exported/jms/RemoteConnectionFactory"</code> which means a remote
client would look-up this <code>connection-factory</code> using "
<code>jms/RemoteConnectionFactory`". A `pooled-connection-factory</code> should
<em>not</em> have any <code>entry</code> bound in the " <code>java:jboss/exported`" namespace
because a `pooled-connection-factory</code> is not suitable for remote
clients.</p>
</div>
<div class="paragraph">
<p>Since JMS 2.0, a default JMS connection factory is accessible to EE
application under the JNDI name <code>java:comp/DefaultJMSConnectionFactory.</code>
WildFly messaging subsystem defines a <code>pooled-connection-factory</code> that
is used to provide this default connection factory. Any parameter change
on this <code>pooled-connection-factory</code> will be take into account by any EE
application looking the default JMS provider under the JNDI name
<code>java:comp/DefaultJMSConnectionFactory.</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:1.0"&gt;
    &lt;server name="default"&gt;
        [...]
        &lt;http-connector name="http-connector"
                        socket-binding="http"
                        endpoint="http-acceptor" /&gt;
        &lt;http-connector name="http-connector-throughput"
                        socket-binding="http"
                        endpoint="http-acceptor-throughput"&gt;
            &lt;param name="batch-delay"
                   value="50"/&gt;
        &lt;/http-connector&gt;
        &lt;in-vm-connector name="in-vm"
                         server-id="0"/&gt;
      [...]
      &lt;connection-factory name="InVmConnectionFactory"
                            connectors="in-vm"
                            entries="java:/ConnectionFactory" /&gt;
      &lt;pooled-connection-factory name="activemq-ra"
                            transaction="xa"
                            connectors="in-vm"
                            entries="java:/JmsXA java:jboss/DefaultJMSConnectionFactory"/&gt;
      [...]
   &lt;/server&gt;
&lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>~(See standalone/configuration/standalone-full.xml)~</p>
</div>
</div>
<div class="sect2">
<h3 id="jms-queues-and-topics">JMS Queues and Topics</h3>
<div class="paragraph">
<p>JMS queues and topics are sub resources of the messaging-actively
subsystem. One can define either a <code>jms-queue</code> or <code>jms-topic</code>. Each
destination <em>must</em> be given a <code>name</code> and contain at least one entry in
its <code>entries</code> element (separated by whitespace).</p>
</div>
<div class="paragraph">
<p>Each entry refers to a JNDI name of the queue or topic. Keep in mind
that any <code>jms-queue</code> or <code>jms-topic</code> which needs to be accessed by a
remote client needs to have an entry in the "java:jboss/exported"
namespace. As with connection factories, if a <code>jms-queue</code> or or
<code>jms-topic</code> has an entry bound in the "java:jboss/exported" namespace a
remote client would look it up using the text <em>after</em>
<code>"java:jboss/exported`". For example, the following `jms-queue</code>
"testQueue" is bound to "java:jboss/exported/jms/queue/test" which means
a remote client would look-up this \{{kms-queue} using
"jms/queue/test". A local client could look it up using
"java:jboss/exported/jms/queue/test", "java:jms/queue/test", or more
simply "jms/queue/test":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:1.0"&gt;
    &lt;server name="default"&gt;
    [...]
    &lt;jms-queue name="testQueue"
               entries="jms/queue/test java:jboss/exported/jms/queue/test" /&gt;
    &lt;jms-topic name="testTopic"
               entries="jms/topic/test java:jboss/exported/jms/topic/test" /&gt;
&lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>~(See standalone/configuration/standalone-full.xml)~</p>
</div>
<div class="paragraph">
<p>JMS endpoints can easily be created through the CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] jms-queue add --queue-address=myQueue --entries=queues/myQueue</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /subsystem=messaging-activemq/server=default/jms-queue=myQueue:read-resource
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "durable" =&gt; true,
        "entries" =&gt; ["queues/myQueue"],
        "selector" =&gt; undefined
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A number of additional commands to maintain the JMS subsystem are
available as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] jms-queue --help --commands
add
...
remove
To read the description of a specific command execute 'jms-queue command_name --help'.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dead-letter-redelivery">Dead Letter &amp; Redelivery</h3>
<div class="paragraph">
<p>Some of the settings are applied against an address wild card instead of
a specific messaging destination. The dead letter queue and redelivery
settings belong into this group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:1.0"&gt;
   &lt;server name="default"&gt;
      [...]
      &lt;address-setting name="#"
                       dead-letter-address="jms.queue.DLQ"
                       expiry-address="jms.queue.ExpiryQueue"
                       [...] /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>~(See standalone/configuration/standalone-full.xml)~</p>
</div>
</div>
<div class="sect2">
<h3 id="security-settings-for-artemis-addresses-and-jms-destinations">Security Settings for Artemis addresses and JMS destinations</h3>
<div class="paragraph">
<p>Security constraints are matched against an address wildcard, similar to
the DLQ and redelivery settings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:1.0"&gt;
   &lt;server name="default"&gt;
      [...]
      &lt;security-setting name="#"&gt;
          &lt;role name="guest"
                send="true"
                consume="true"
                create-non-durable-queue="true"
                delete-non-durable-queue="true"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>~(See standalone/configuration/standalone-full.xml)~</p>
</div>
</div>
<div class="sect2">
<h3 id="security-domain-for-users">Security Domain for Users</h3>
<div class="paragraph">
<p>By default, Artemis will use the " <code>other`" JAAS security domain. This
domain is used to authenticate users making connections to Artemis and
then they are authorized to perform specific functions based on their
role(s) and the `security-settings</code> described above. This domain can be
changed by using the <code>security-domain</code>, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:1.0"&gt;
   &lt;server name="default"&gt;
       &lt;security domain="mySecurityDomain" /&gt;
      [...]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-the-elytron-subsystem">Using the Elytron Subsystem</h3>
<div class="paragraph">
<p>You can also use the elytron subsystem to secure the messaging-activemq
subsystem.</p>
</div>
<div class="paragraph">
<p>To use an Elytron security domain:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Undefine the legacy security domain.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=messaging-activemq/server=default:undefine-attribute(name=security-domain)</code></pre>
</div>
</div>
</li>
<li>
<p>Set an Elytron security domain.</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=messaging-activemq/server=default:write-attribute(name=elytron-domain, value=myElytronSecurityDomain)</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You can only define either <code>security-domain</code> or <code>elytron-domain</code>, but
you cannot have both defined at the same time. If neither is defined,
WildFly will use the <code>security-domain</code> default value of <code>other</code>, which
maps to the <code>other</code> legacy security domain.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cluster-authentication">Cluster Authentication</h3>
<div class="paragraph">
<p>If the Artemis server is configured to be clustered, it will use the
<code>cluster</code> 's <code>user</code> and <code>password</code> attributes to connect to other
Artemis nodes in the cluster.</p>
</div>
<div class="paragraph">
<p>If you do not change the default value of &lt;cluster-password&gt;, Artemis
will fail to authenticate with the error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>HQ224018: Failed to create session: HornetQExceptionerrorType=CLUSTER_SECURITY_EXCEPTION message=HQ119099: Unable to authenticate cluster user: HORNETQ.CLUSTER.ADMIN.USER</code></pre>
</div>
</div>
<div class="paragraph">
<p>To prevent this error, you must specify a value for
<code>&lt;cluster-password&gt;</code>. It is possible to encrypt this value by following
<a href="https://access.redhat.com/site/documentation/en-US/JBoss_Enterprise_Application_Platform/6.1/html/Security_Guide/sect-Password_Vaults_for_Sensitive_Strings.html">this
guide</a>.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can use the system property
jboss.messaging.cluster.password to specify the cluster password from
the command line.</p>
</div>
</div>
<div class="sect2">
<h3 id="deployment-of--jms.xml-files">Deployment of -jms.xml files</h3>
<div class="paragraph">
<p>Starting with WildFly 10.1, you have the ability to deploy a -jms.xml file
defining JMS destinations, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;messaging-deployment xmlns="urn:jboss:messaging-activemq-deployment:1.0"&gt;
   &lt;server name="default"&gt;
      &lt;jms-destinations&gt;
         &lt;jms-queue name="sample"&gt;
            &lt;entry name="jms/queue/sample"/&gt;
            &lt;entry name="java:jboss/exported/jms/queue/sample"/&gt;
         &lt;/jms-queue&gt;
      &lt;/jms-destinations&gt;
   &lt;/server&gt;
&lt;/messaging-deployment&gt;</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This feature <strong>is primarily intended for development</strong> as destinations
deployed this way can not be managed with any of the provided management
tools (e.g. console, CLI, etc).
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="jms-bridge">JMS Bridge</h3>
<div class="paragraph">
<p>The function of a JMS bridge is to consume messages from a source JMS
destination, and send them to a target JMS destination. Typically either
the source or the target destinations are on different servers.
The bridge can also be used to bridge messages from other non Artemis
JMS servers, as long as they are JMS 1.1 compliant.</p>
</div>
<div class="paragraph">
<p>The JMS Bridge is provided by the Artemis project. For a detailed
description of the available configuration properties, please consult
the project documentation.</p>
</div>
<div class="sect3">
<h4 id="modules-for-other-messaging-brokers">Modules for other messaging brokers</h4>
<div class="paragraph">
<p>Source and target JMS resources (destination and connection factories)
are looked up using JNDI.
If either the source or the target resources are managed by another
messaging server than WildFly, the required client classes must be
bundled in a module. The name of the module must then be declared when
the JMS Bridge is configured.</p>
</div>
<div class="paragraph">
<p>The use of a JMS bridges with any messaging provider will require to
create a module containing the jar of this provider.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s suppose we want to use an hypothetical messaging provider named
AcmeMQ. We want to bridge messages coming from a source AcmeMQ
destination to a target destination on the local WildFly messaging
server. To lookup AcmeMQ resources from JNDI, 2 jars are required,
acmemq-1.2.3.jar, mylogapi-0.0.1.jar (please note these jars do not
exist, this is just for the example purpose). We must <em>not</em> include a
JMS jar since it will be provided by a WildFly module directly.</p>
</div>
<div class="paragraph">
<p>To use these resources in a JMS bridge, we must bundle them in a WildFly
module:</p>
</div>
<div class="paragraph">
<p>in JBOSS_HOME/modules, we create the layout:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>modules/
`-- org
    `-- acmemq
        `-- main
            |-- acmemq-1.2.3.jar
            |-- mylogapi-0.0.1.jar
            `-- module.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>We define the module in <code>module.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;module xmlns="urn:jboss:module:1.1" name="org.acmemq"&gt;
    &lt;properties&gt;
        &lt;property name="jboss.api" value="private"/&gt;
    &lt;/properties&gt;
Â 
Â 
    &lt;resources&gt;
        &lt;!-- insert resources required to connect to the source or target   --&gt;
        &lt;!-- messaging brokers if it not another WildFly instance           --&gt;
        &lt;resource-root path="acmemq-1.2.3.jar" /&gt;
        &lt;resource-root path="mylogapi-0.0.1.jar" /&gt;
    &lt;/resources&gt;
Â 
Â 
    &lt;dependencies&gt;
       &lt;!-- add the dependencies required by JMS Bridge code                --&gt;
       &lt;module name="javax.api" /&gt;
       &lt;module name="javax.jms.api" /&gt;
       &lt;module name="javax.transaction.api"/&gt;
       &lt;module name="org.jboss.remote-naming"/&gt;
       &lt;!-- we depend on org.apache.activemq.artemis module since we will send messages to  --&gt;
       &lt;!-- the Artemis server embedded in the local WildFly instance       --&gt;
       &lt;module name="org.apache.activemq.artemis" /&gt;
    &lt;/dependencies&gt;
&lt;/module&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuration">Configuration</h4>
<div class="paragraph">
<p>A JMS bridge is defined inside a <code>jms-bridge</code> section of the
<code>messaging-activemq</code> subsystem in the XML configuration files.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:1.0"&gt;
   &lt;jms-bridge name="myBridge" module="org.acmemq"&gt;
      &lt;source connection-factory="ConnectionFactory"
              destination="sourceQ"
              user="user1"
              password="pwd1"
              quality-of-service="AT_MOST_ONCE"
              failure-retry-interval="500"
              max-retries="1"
              max-batch-size="500"
              max-batch-time="500"
              add-messageID-in-header="true"&gt;
         &lt;source-context&gt;
            &lt;property name="java.naming.factory.initial"
                      value="org.acmemq.jndi.AcmeMQInitialContextFactory"/&gt;
            &lt;property name="java.naming.provider.url"
                      value="tcp://127.0.0.1:9292"/&gt;
         &lt;/source-context&gt;
      &lt;/source&gt;
      &lt;target connection-factory"/jms/invmTargetCF"
              destination="/jms/targetQ" /&gt;
      &lt;/target&gt;
   &lt;/jms-bridge&gt;
&lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>source</code> and <code>target</code> sections contain the name of the JMS resource
( <code>connection-factory</code> and <code>destination</code>) that will be looked up in
JNDI.
It optionally defines the <code>user</code> and <code>password</code> credentials. If they are
set, they will be passed as arguments when creating the JMS connection
from the looked up ConnectionFactory.
It is also possible to define JNDI context properties in the
<code>source-context</code> and <code>target-context</code> sections. If these sections are
absent, the JMS resources will be looked up in the local WildFly
instance (as it is the case in the <code>target</code> section in the example
above).</p>
</div>
</div>
<div class="sect3">
<h4 id="management-commands">Management commands</h4>
<div class="paragraph">
<p>A JMS Bridge can also be managed using the WildFly command line
interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /subsystem=messaging/jms-bridge=myBridge/:add(module="org.acmemq",
      source-destination="sourceQ",
      source-connection-factory="ConnectionFactory",
      source-user="user1",
      source-password="pwd1",
      source-context={"java.naming.factory.initial" =&gt; "org.acmemq.jndi.AcmeMQInitialContextFactory",
                      "java.naming.provider.url" =&gt; "tcp://127.0.0.1:9292"},
      target-destination="/jms/targetQ",
      target-connection-factory="/jms/invmTargetCF",
      quality-of-service=AT_MOST_ONCE,
      failure-retry-interval=500,
      max-retries=1,
      max-batch-size=500,
      max-batch-time=500,
      add-messageID-in-header=true)
{"outcome" =&gt; "success"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also see the complete JMS Bridge resource description from the
CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /subsystem=messaging/jms-bridge=*/:read-resource-description
{
    "outcome" =&gt; "success",
    "result" =&gt; [{
        "address" =&gt; [
            ("subsystem" =&gt; "messaging"),
            ("jms-bridge" =&gt; "*")
        ],
        "outcome" =&gt; "success",
        "result" =&gt; {
            "description" =&gt; "A JMS bridge instance.",
            "attributes" =&gt; {
                ...
        }
    }]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="component-reference">Component Reference</h3>
<div class="paragraph">
<p>The messaging-activemq subsystem is provided by the Artemis project. For
a detailed description of the available configuration properties, please
consult the project documentation.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Artemis Homepage: <a href="http://activemq.apache.org/artemis/" class="bare">http://activemq.apache.org/artemis/</a></p>
</li>
<li>
<p>Artemis User Documentation:
<a href="http://activemq.apache.org/artemis/docs.html" class="bare">http://activemq.apache.org/artemis/docs.html</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Messaging_Connect_a_pooled-connection-factory_to_a_Remote_Artemis_Server">Connect a pooled-connection-factory to a Remote Artemis Server</h3>
<div class="paragraph">
<p>The <code>messaging-activemq</code> subsystem allows to configure a
<code>pooled-connection-factory</code> resource to let a local client deployed in
WildFly connect to a remote Artemis server.</p>
</div>
<div class="paragraph">
<p>The configuration of such a <code>pooled-connection-factory</code> is done in 3
steps:</p>
</div>
<div class="paragraph">
<p>\1. create an outbound-socket-binding pointing to the remote messaging
server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">   /socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=remote-artemis:add(host=&lt;server host&gt;, port=61616)</code></pre>
</div>
</div>
<div class="paragraph">
<p>\2. create a remote-connector referencing the outbound-socket-binding
created at step (1).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">  /subsystem=messaging-activemq/server=default/remote-connector=remote-artemis:add(socket-binding=remote-artemis)</code></pre>
</div>
</div>
<div class="paragraph">
<p>\3. create a pooled-connection-factory referencing the remote-connector
created at step (2).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">  /subsystem=messaging-activemq/server=default/pooled-connection-factory=remote-artemis:add(connectors=[remote-artemis], entries=[java:/jms/remoteCF])</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="configuration-of-a-mdb-using-a-pooled-connection-factory">Configuration of a MDB using a pooled-connection-factory</h4>
<div class="paragraph">
<p>When a <code>pooled-connection-factory</code> is configured to connect to a remote
Artemis, it is possible to configure Message-Driven Beans (MDB) to have
them consume messages from this remote server.</p>
</div>
<div class="paragraph">
<p>The MDB must be annotated with the <code>@ResourceAdapter</code> annotation using
the <strong>name</strong> of the <code>pooled-connection-factory resource</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">import org.jboss.ejb3.annotation.ResourceAdapter;
Â 
  @ResourceAdapter("remote-artemis")
  @MessageDriven(name = "MyMDB", activationConfig = {
    ...
})
public class MyMDB implements MessageListener {
      public void onMessage(Message message) {
       ...
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the MDB needs to produce messages to the remote server, it must
inject the <code>pooled-connection-factory</code> by looking it up in JNDI using
one of its <code>entries</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">@Inject
@JMSConnectionFactory("java:/jms/remoteCF")
private JMSContext context;</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="configuration-of-the-destination">Configuration of the destination</h5>
<div class="paragraph">
<p>A MDB must also specify which destination it will consume messages from.</p>
</div>
<div class="paragraph">
<p>The standard way is to define a <code>destinationLookup</code> activation config
property that corresponds to a JNDI lookup on the local server.<br>
When the MDB is consuming from a remote Artemis server, there may not
have such a JNDI binding in the local WildFly.<br>
It is possible to use the naming subsystem to configure
<a href="#Naming">external context federation</a> to have local JNDI
bindings delegating to external bindings.</p>
</div>
<div class="paragraph">
<p>However there is a simpler solution to configure the destination when
using the Artemis Resource Adapter.<br>
Instead of using JDNI to lookup the JMS Destination resource, you can
just specify the <strong>name</strong> of the destination (as configured in the remote
Artemis server) using the <code>destination</code> activation config property and
set the <code>useJNDI</code> activation config property to false to let the Artemis
Resource Adapter create automatically the JMS destination without
requiring any JNDI lookup.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">@ResourceAdapter("remote-artemis")
@MessageDriven(name = "MyMDB", activationConfig = {
    @ActivationConfigProperty(propertyName = "useJNDI",         propertyValue = "false"),
    @ActivationConfigProperty(propertyName = "destination",     propertyValue = "myQueue"),
    @ActivationConfigProperty(propertyName = "destinationType", propertyValue = "javax.jms.Queue"),â¨
    @ActivationConfigProperty(propertyName = "acknowledgeMode", propertyValue = "Auto-acknowledge")
})
public class MyMDB implements MessageListener {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>These properties configure the MDB to consume messages from the JMS
Queue named <code>myQueue</code> hosted on the remote Artemis server.<br>
In most cases, such a MDB does not need to lookup other destinations to
process the consumed messages and it can use the JMSReplyTo destination
if it is defined on the message.<br>
If the MDB needs any other JMS destinations defined on the remote
server, it must use client-side JNDI by following the
<a href="http://activemq.apache.org/artemis/docs/1.1.0/using-jms.html#jndi-configuration">Artemis
documentation</a> or configure external configuration context in the naming
subsystem (which allows to inject the JMS resources using the
<code>@Resource</code> annotation).</p>
</div>
<div class="paragraph">
<p>[[Messaging_Backward_&amp;_Forward_Compatibility]]
= Backward &amp; Forward Compatibility</p>
</div>
<div class="paragraph">
<p>WildFly 10 supports both backwards and forwards compatibility with
legacy versions that were using HornetQ as their messaging brokers (such
as JBoss AS7, WildFly 10.1 &amp; 9).<br>
These two compatibility modes are provided by the ActiveMQ Artemis
project that supports the HornetQ&#8217;s CORE protocol:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>backward compatibility: WildFly 10 JMS clients (using Artemis) can
connect to legacy app server (running HornetQ)</p>
</li>
<li>
<p>forward compatibility: legacy JMS clients (using HornetQ) can connect
to WildFly 10 app server (running Artemis).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="forward-compatibility">Forward Compatibility</h4>
<div class="paragraph">
<p>Forward compatibility requires no code change in legacy JMS clients. It
is provided by WildFly 10 messaging-activemq subsystem and its
resources.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>legacy-connection-factory</code> is a subresource of the
<code>messaging-activemq&#8217;s `server</code> and can be used to store in JNDI a
HornetQ-based JMS ConnectionFactory.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:messaging-activemq:1.0"&gt;â¨
    &lt;server name="default"&gt;
        ...
        &lt;legacy-connection-factory name="legacyConnectionFactory-discovery"â¨
                                   entries="java:jboss/exported/jms/RemoteConnectionFactory"
                                   ... /&gt;
    &lt;/server&gt;
&lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Legacy HornetQ-based JMS destinations can also be configured by
providing a <code>legacy-entries</code> attribute to the <code>jms-queue</code> and
<code>jms-topic</code> resource.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">    &lt;jms-queue name="myQueue"
               entries="java:jboss/exported/jms/myQueue-new"
               legacy-entries="java:jboss/exported/jms/myQueue" /&gt;
    &lt;jms-topic name="testTopic"
               entries="java:jboss/exported/jms/myTopic-new"
               legacy-entries="java:jboss/exported/jms/myTopic" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>legacy-entries</code> must be used by legacy JMS clients (using HornetQ)
while the regular <code>entries</code> are for WildFly 10 JMS clients (using
Artemis).</p>
</div>
<div class="paragraph">
<p>The legacy JMS client will then lookup this <code>legacy</code> JMS resources to
communicate with WildFly 10.<br>
To avoid any code change in the legacy JMS clients, the legacy JNDI
entries must match the lookup expected by the legacy JMS client.</p>
</div>
<div class="sect4">
<h5 id="migration">Migration</h5>
<div class="paragraph">
<p>During migration, the legacy <code>messaging</code> subsystem will create
<code>legacy-connection-factory</code> resource and add <code>legacy-entries</code> to the
<code>jms-queue</code> and <code>jms-topic</code> resource if the boolean attribute
<code>add-legacy-entries</code> is set to <code>true</code> for its <code>migrate</code> operation. If
that is the case, the legacy entries in the migrated
<code>messaging-activemq</code> subsystem will correspond to the entries specified
in the legacy <code>messaging</code> subsystem and the regular entries will be
created with a <code>-new</code> suffix.<br>
If <code>add-legacy-entries</code> is set to <code>false</code> during migration, no legacy
resources will be created in the <code>messaging-activemq</code> subsystem and
legacy JMS clients will not be able to communicate with WildFly 10
servers.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="backward-compatibility">Backward Compatibility</h4>
<div class="paragraph">
<p>Backward compatibility requires no configuration change in the legacy
server.<br>
WildFly 10 JMS clients do not look up resources on the legacy server but
uses client-side JNDI to create their JMS resources. Artemis JMS client
can then uses these resources to communicate with the legacy server
using the HornetQ CORE protocol.</p>
</div>
<div class="paragraph">
<p>Artemis supports
<a href="http://activemq.apache.org/artemis/docs/1.1.0/using-jms.html#jndi-configuration">Client-side
JNDI</a> to create JMS resources ( <code>ConnectionFactory</code> and <code>Destination</code>).</p>
</div>
<div class="paragraph">
<p>For example, if a WidFly 10 JMS clients wants to communicate with a
legacy server using a JMS queue named <code>myQueue</code>, it must use the
following properties to configure its JNDI <code>InitialContext</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>java.naming.factory.initial=org.apache.activemq.artemis.jndi.ActiveMQInitialContextFactory
connectionFactory.jms/ConnectionFactory=tcp://&lt;legacy server address&gt;:5445? \
    protocolManagerFactoryStr=org.apache.activemq.artemis.core.protocol.hornetq.client.HornetQClientProtocolManagerFactory
queue.jms/myQueue=myQueue</code></pre>
</div>
</div>
<div class="paragraph">
<p>It can then use the <code>jms/ConnectionFactory</code> name to create the JMS
ConnectionFactory and <code>jms/myQueue</code> to create the JMS Queue.<br>
Note that the property
<code>protocolManagerFactoryStr=org.apache.activemq.artemis.core.protocol.hornetq.client.HornetQClientProtocolManagerFactory</code>
is mandatory when specifying the URL of the legacy connection factory so
that the Artemis JMS client can communicate with the HornetQ broker in
the legacy server.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Mesaging_AIO_-_NIO_for_messaging_journal">AIO - NIO for messaging journal</h3>
<div class="paragraph">
<p>Apache ActiveMQ Artemis (like HornetQ beforehand) ships with a <strong>high
performance journal</strong>. Since Apache ActiveMQ Artemis handles its own
persistence, rather than relying on a database or other 3rd party
persistence engine it is very highly optimised for the specific
messaging use cases. The majority of the journal is written in Java,
however we abstract out the interaction with the actual file system to
allow different pluggable implementations.</p>
</div>
<div class="paragraph">
<p>Apache ActiveMQ Artemis ships with two implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Java NIO.</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first implementation uses standard Java NIO to interface with the
file system. This provides extremely good performance and runs on any
platform where there&#8217;s a Java 6+ runtime.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Linux Asynchronous IO</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The second implementation uses a thin native code wrapper to talk to the
Linux asynchronous IO library (AIO). With AIO, Apache ActiveMQ Artemis
will be called back when the data has made it to disk, allowing us to
avoid explicit syncs altogether and simply send back confirmation of
completion when AIO informs us that the data has been persisted.</p>
</div>
<div class="paragraph">
<p>Using AIO will typically provide even better performance than using Java
NIO.</p>
</div>
<div class="paragraph">
<p>The AIO journal is only available when running Linux kernel 2.6 or later
and after having installed libaio (if it&#8217;s not already installed).</p>
</div>
<div class="paragraph">
<p>Also, please note that AIO will only work with the following file
systems: ext2, ext3, ext4, jfs, xfs. With other file systems, e.g. NFS
it may appear to work, but it will fall back to a slower synchronous
behaviour. Don&#8217;t put the journal on a NFS share!</p>
</div>
<div class="paragraph">
<p><strong>One point that should be added is that AIO doesn&#8217;t work well with
encrypted partitions, thus you have to move to NIO on those.</strong></p>
</div>
<div class="paragraph">
<p>What are the symptoms of an AIO isssue ?</p>
</div>
<div class="sect3">
<h4 id="aio-issue-on-wildfly-10">AIO issue on WildFly 10</h4>
<div class="paragraph">
<p>If you see the following exception in your WildFly log file / console</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[org.apache.activemq.artemis.core.server] (ServerService Thread Pool -- 64) AMQ222010: Critical IO Error, shutting down the server. file=AIOSequentialFile:/home/wildfly/wildfly-10.0.0.Final/standalone/data/activemq/journal/activemq-data-2.amq, message=Cannot open file:The Argument is invalid: java.io.IOException: Cannot open file:The Argument is invalid
 at org.apache.activemq.artemis.jlibaio.LibaioContext.open(Native Method)</pre>
</div>
</div>
<div class="paragraph">
<p>that means that AIO isn&#8217;t working properly on your system.</p>
</div>
<div class="paragraph">
<p>To use NIO instead execute the following commnd using jboss-cli :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=messaging-activemq/server=default:write-attribute(name=journal-type, value=NIO)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You need to reload or restart your server and you should see the
following trace in your server console :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>INFOÂ  [org.apache.activemq.artemis.core.server] (ServerService Thread Pool -- 64) AMQ221013: Using NIO Journal</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="aio-issue-on-wildfly-9">AIO issue on WildFly 9</h4>
<div class="literalblock">
<div class="content">
<pre>[org.hornetq.core.server] (ServerService Thread Pool -- 64) HQ222010: Critical IO Error, shutting down the server. file=AIOSequentialFile:/home/wildfly/wildfly-9.0.2.Final/standalone/data/messagingjournal/hornetq-data-1.hq, message=Can't open file: HornetQException[errorType=NATIVE_ERROR_CANT_OPEN_CLOSE_FILE message=Can't open file]
 at org.hornetq.core.libaio.Native.init(Native Method)</pre>
</div>
</div>
<div class="paragraph">
<p>that means that AIO isn&#8217;t working properly on your system.</p>
</div>
<div class="paragraph">
<p>To use NIO instead execute the following commnd using jboss-cli :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=messaging/hornetq-server=default:write-attribute(name=journal-type,value=NIO)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You need to reload or restart your server and you see the following
trace in your server console :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>INFOÂ  [org.hornetq.core.server] (ServerService Thread Pool -- 64) HQ221013: Using NIO Journal</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Messaging_JDBC_Store_for_Messaging_Journal">JDBC Store for Messaging Journal</h3>
<div class="paragraph">
<p>The Artemis server that are integrated to WildFly can be configured to
use a JDBC store for its messaging journal instead of its file-based
journal.<br>
The <code>server resource</code> of the messaging-activemq subsystem needs to
configure its <code>journal-datasource</code> attribute to be able to use JDBC
store. If this attribute is not defined, the regular file-base journal
will be used for the Artemis server.<br>
This attribute value must correspond to a data source defined in the
datasource subsystem.</p>
</div>
<div class="paragraph">
<p>For example, if the datasources subsystem defines an <code>ExampleDS</code> data
source at <code>/subsystem=datasources/data-source=ExampleDS</code>, the Artemis
server can use it for its JDBC store with the operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=messaging-activemq/server=default:write-attribute(name=journal-datasource, value=ExampleDS)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Artemis JDBC store uses SQL commands to create the tables used to
persist its information.<br>
These SQL commands may differ depending on the type of database. The SQL
commands used by the JDBC store are located in the file at:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$JBOSS_HOME/modules/system/layers/base/org/wildfly/extension/messaging-activemq/main/database/journal-sql.properties</pre>
</div>
</div>
<div class="paragraph">
<p>By default, "vanilla" SQL commands are used to communicate with the
database. However some databases requires specific commands to create
table, update content, etc.</p>
</div>
<div class="paragraph">
<p>The journal-sql.properties can also specify these provider-specific
commands. You can customize them by adding a suffix to the vanilla SQL
properties.</p>
</div>
<div class="paragraph">
<p>The suffix is determined based on information from the JDBC driver and
the connection metadata. If the type of database is not supported by the
code, you can specify it explicitly with the journal-database property
on the server resource.</p>
</div>
<div class="paragraph">
<p>Artemis uses different JDBC tables to store its bindings information,
the persistent messages and the large messages (paging is not supported
yet).</p>
</div>
<div class="paragraph">
<p>The name of these tables can be configured with the
<code>journal-bindings-table</code>, <code>journal-messages-table</code>,
<code>journal-page-store-table, and journal-large-messages-table</code>.</p>
</div>
<div class="sect3">
<h4 id="reference">Reference</h4>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Artemis JDBC Persistence -
<a href="http://activemq.apache.org/artemis/docs/1.5.0/persistence.html#configuring-jdbc-persistence" class="bare">http://activemq.apache.org/artemis/docs/1.5.0/persistence.html#configuring-jdbc-persistence</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Messaging_Discovery_Configuration">Configuring Broadcast/Discovery</h3>
<div class="paragraph">
<p>Each Artemis server can be configured to broadcast itself and/or discovery other Artemis servers within a cluster.
Artemis supports two mechanisms for configuring broadcast/discovery:</p>
</div>
<div class="sect3">
<h4 id="jgroups-based-broadcastdiscovery">JGroups-based broadcast/discovery</h4>
<div class="paragraph">
<p>Artemis can leverage the membership of an existing JGroups channel to both broadcast its identity and discover nodes on which Artemis servers are deployed.
WildFly&#8217;s default full-ha profile uses this mechanism for broadcast/discovery using the default JGroups channel of the server (as defined by the JGroups subsystem).</p>
</div>
<div class="paragraph">
<p>To add this support to a profile that does not include it by default, use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /subsystem=messaging-activemq/server=default/broadcast-group=bg-group1:add(jgroups-cluster=activemq-cluster,connectors=http-connector)
[standalone@localhost:9990 /]/subsystem=messaging-activemq/server=default/broadcast-group=dg-group1:add(jgroups-cluster=activemq-cluster)</code></pre>
</div>
</div>
<div class="paragraph">
<p>To segregate Artemis servers use a distinct membership, configure broadcast/discovery using a separate channel.  To do this, first create the channel resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /subsystem=jgroups/channel=messaging:add(stack=tcp)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This creates a new JGroups channel resource based on the "tcp" protocol stack.
Now create your broadcast/discovery groups using this channel:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /subsystem=messaging-activemq/server=default/broadcast-group=bg-group2:add(jgroups-channel=messaging, jgroups-cluster=activemq-cluster, connectors=http-connector)
[standalone@localhost:9990 /] /subsystem=messaging-activemq/server=default/broadcast-group=dg-group2:add(jgroups-channel=messaging, jgroups-cluster=activemq-cluster)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="multicast-broadcastdiscovery">Multicast broadcast/discovery</h4>
<div class="paragraph">
<p>To broadcast identity to standalone messaging clients, you can additionally configure broadcast/discovery using multicast sockets.</p>
</div>
<div class="paragraph">
<p>e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /socket-binding-group=standard-sockets/socket-binding=messaging(interface=private, multicast-address=230.0.0.4, multicast-port=45689)

[standalone@localhost:9990 /] /subsystem=messaging-activemq/server=default/broadcast-group=bg-group3:add(socket-binding=messaging, connectors=http-connector)
[standalone@localhost:9990 /] /subsystem=messaging-activemq/server=default/broadcast-group=dg-group3:add(socket-binding=messaging)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Security">Security subsystem configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The security subsystem is the subsystem that brings the security
services provided by <a href="http://www.jboss.org/picketbox">PicketBox</a> to the
WildFly 10.1 server instances.</p>
</div>
<div class="paragraph">
<p>If you are looking to secure the management interfaces for the
management of the domain then you should read the
<a href="#Security_Realms">Securing the Management Interfaces</a> chapter as the
management interfaces themselves are not run within a WildFly process so
use a custom configuration.</p>
</div>
<div class="sect2">
<h3 id="structure-of-the-security-subsystem">Structure of the Security Subsystem</h3>
<div class="paragraph">
<p>When deploying applications to WildFly most of the time it is likely
that you would be deploying a web application or EJBs and just require a
security domain to be defined with login modules to verify the users
identity, this chapter aims to provide additional detail regarding the
architecture and capability of the security subsystem however if you are
just looking to define a security domain and leave the rest to the
container please jump to the
<a href="#security-domains">security-domains</a>
section.</p>
</div>
<div class="paragraph">
<p>The security subsystem operates by using a security context associated
with the current request, this security context then makes available to
the relevant container a number of capabilities from the configured
security domain, the capabilities exposed are an authentication manager,
an authorization manager, an audit manager and a mapping manager.</p>
</div>
<div class="sect3">
<h4 id="security-authentication-manager">Authentication Manager</h4>
<div class="paragraph">
<p>The authentication manager is the component that performs the actual
authentication taking the declared users identity and their credential
so that the login context for the security domain can be used to 'login'
the user using the configured login module or modules.</p>
</div>
</div>
<div class="sect3">
<h4 id="security-authorization-manager">Authorization Manager</h4>
<div class="paragraph">
<p>The authorization manager is a component which can be obtained by the
container from the current security context to either obtain information
about a users roles or to perform an authorization check against a
resource for the currently authenticated user.</p>
</div>
</div>
<div class="sect3">
<h4 id="audit-manager">Audit Manager</h4>
<div class="paragraph">
<p>The audit manager from the security context is the component that can be
used to log audit events in relation to the security domain.</p>
</div>
</div>
<div class="sect3">
<h4 id="mapping-manager">Mapping Manager</h4>
<div class="paragraph">
<p>The mapping manager can be used to assign additional principals,
credentials, roles or attributes to the authenticated subject.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="security-subsystem-configuration">Security Subsystem Configuration</h3>
<div class="paragraph">
<p>By default a lot of defaults have already been selected for the security
subsystem and unless there is a specific implementation detail you need
to change, these defaults should not require modification. This chapter
describes all of the possible configuration attributes for completeness
but do keep in mind that not all will need to be changed.</p>
</div>
<div class="paragraph">
<p>The security subsystem is enabled by default by the addition of the
following extension: -<br>
<br>
&lt;extension module="org.jboss.as.security"/&gt;</p>
</div>
<div class="paragraph">
<p>The namespace used for the configuration of the security subsystem is
urn:jboss:domain:security:1.0, the configuration is defined within the
&lt;subsystem&gt; element from this namespace.</p>
</div>
<div class="paragraph">
<p>The &lt;subsystem&gt; element can optionally contain the following child
elements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>security-management</p>
</li>
<li>
<p>subject-factory</p>
</li>
<li>
<p>security-domains</p>
</li>
<li>
<p>security-properties</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="security-management">security-management</h4>
<div class="paragraph">
<p>This element is used to override some of the high level implementation
details of the PicketBox implementation if you have a need to change
some of this behaviour.</p>
</div>
<div class="paragraph">
<p>The element can have any or the following attributes set, all of which
are optional.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">authentication-manager-class-name</th>
<th class="tableblock halign-left valign-top">Specifies the AuthenticationManager
implementation class name to use.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deep-copy-subject-mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the copy mode of subjects done by the
security managers to be deep copies that makes copies of the subject
principals and credentials if they are cloneable. It should be set to
true if subject include mutable content that can be corrupted when
multiple threads have the same identity and cache flushes/logout
clearing the subject in one thread results in subject references
affecting other threads. Default value is "false".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-callback-handler-class-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a global class name for
the CallbackHandler implementation to be used with login modules.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">authorization-manager-class-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute specifies the
AuthorizationManager implementation class name to use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">audit-manager-class-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the AuditManager implementation
class name to use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">identity-trust-manager-class-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the IdentityTrustManager
implementation class name to use.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mapping-manager-class-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the MappingManager implementation
class name to use.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="subject-factory">subject-factory</h4>
<div class="paragraph">
<p>The subject factory is responsible for creating subject instances, this
also makes use of the authentication manager to actually verify the
caller. It is used mainly by JCA components to establish a subject. It
is not likely this would need to be overridden but if it is required the
"subject-factory-class-name" attribute can be specified on the
subject-factory element.</p>
</div>
</div>
<div class="sect3">
<h4 id="security-domains">security-domains</h4>
<div class="paragraph">
<p>This portion of the configuration is where the bulk of the security
subsystem configuration will actually take place for most
administrators, the security domains contain the configuration which is
specific to a deployment.</p>
</div>
<div class="paragraph">
<p>The security-domains element can contain numerous &lt;security-domain&gt;
definitions, a security-domain can have the following attributes set:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">The unique name of this security domain.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">extends</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Although version 1.0 of the security subsystem schema
contained an 'extends' attribute, security domain inheritance is not
supported and this attribute should not be used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of authentication cache to use with this domain.
If this attribute is removed no cache will be used. Allowed values are
"default" or "infinispan"</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following elements can then be set within the security-domain to
configure the domain behaviour.</p>
</div>
<div class="sect4">
<h5 id="authentication">authentication</h5>
<div class="paragraph">
<p>The authentication element is used to hold the list of login modules
that will be used for authentication when this domain is used, the
structure of the login-module element is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">&lt;login-module code="..." flag="..." module="..."&gt;
  &lt;module-option name="..." value="..."/&gt;
&lt;/login-module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code attribute is used to specify the implementing class of the
login module which can either be the full class name or one of the
abbreviated names from the following list:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Classname</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.ClientLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Certificate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.BaseCertLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CertificateUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.BaseCertLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CertificateRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.CertRolesLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.DatabaseServerLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DatabaseCertificate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.DatabaseCertLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DatabaseUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.DatabaseServerLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.IdentityLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ldap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.LdapLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LdapExtended</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.LdapExtLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RoleMapping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.RoleMappingLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RunAs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.RunAsLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Simple</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.SimpleServerLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ConfiguredIdentity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.picketbox.datasource.security.ConfiguredIdentityLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SecureIdentity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.picketbox.datasource.security.SecureIdentityLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PropertiesUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.PropertiesUsersLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SimpleUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.SimpleUsersLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LdapUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.LdapUsersLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kerberos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.sun.security.auth.module.Krb5LoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPNEGOUsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.negotiation.spnego.SPNEGOLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AdvancedLdap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.negotiation.AdvancedLdapLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AdvancedADLdap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.negotiation.AdvancedADLoginModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UsersRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.auth.spi.UsersRolesLoginModule</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The module attribute specifies the name of the JBoss Modules module from
which the class specified by the code attribute should be loaded.
Specifying it is not necessary if one of the abbreviated names in the
above list is used.</p>
</div>
<div class="paragraph">
<p>The flag attribute is used to specify the JAAS flag for this module and
should be one of required, requisite, sufficient, or optional.</p>
</div>
<div class="paragraph">
<p>The module-option element can be repeated zero or more times to specify
the module options as required for the login module being configured. It
requires the name and value attributes.</p>
</div>
</div>
<div class="sect4">
<h5 id="authentication-jaspi">authentication-jaspi</h5>
<div class="paragraph">
<p>The authentication-jaspi is used to configure a Java Authentication SPI
(JASPI) provider as the authentication mechanism. A security domain can
have either a &lt;authentication&gt; or a &lt;authentication-jaspi&gt; element, but
not both. We set up JASPI by configuring one or more login modules
inside the login-module-stack element and setting up an authentication
module. Here is the structure of the authentication-jaspi element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;login-module-stack name="..."&gt;
  &lt;login-module code="..." flag="..." module="..."&gt;
    &lt;module-option name="..." value="..."/&gt;
  &lt;/login-module&gt;
&lt;/login-module-stack&gt;
&lt;auth-module code="..." login-module-stack-ref="..."&gt;
  &lt;module-option name="..." value="..."/&gt;
&lt;/auth-module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The login-module-stack-ref attribute value must be the name of the
login-module-stack element to be used. The sub-element login-module is
configured just like in the
<a href="#authentication">authentication</a>
part</p>
</div>
</div>
<div class="sect4">
<h5 id="authorization">authorization</h5>
<div class="paragraph">
<p>Authorization in the AS container is normally done with RBAC (role based
access control) but there are situations where a more fine grained
authorization policy is required. The authorization element allows
definition of different authorization modules to used, such that
authorization can be checked with JACC (Java Authorization Contract for
Containers) or XACML (eXtensible Access Control Markup Language). The
structure of the authorization element is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;policy-module code="..." flag="..." module="..."&gt;
  &lt;module-option name="..." value="..."/&gt;
&lt;/policy-module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code attribute is used to specify the implementing class of the
policy module which can either be the full class name or one of the
abbreviated names from the following list:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Classname</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DenyAll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.authorization.modules.AllDenyAuthorizationModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PermitAll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.authorization.modules.AllPermitAuthorizationModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delegating</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.authorization.modules.DelegatingAuthorizationModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Web</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.authorization.modules.WebAuthorizationModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JACC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.authorization.modules.JACCAuthorizationModule</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XACML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.authorization.modules.XACMLAuthorizationModule</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The module attribute specifies the name of the JBoss Modules module from
which the class specified by the code attribute should be loaded.
Specifying it is not necessary if one of the abbreviated names in the
above list is used.</p>
</div>
<div class="paragraph">
<p>The flag attribute is used to specify the JAAS flag for this module and
should be one of required, requisite, sufficient, or optional.</p>
</div>
<div class="paragraph">
<p>The module-option element can be repeated zero or more times to specify
the module options as required for the login module being configured. It
requires the name and value attributes.</p>
</div>
</div>
<div class="sect4">
<h5 id="mapping">mapping</h5>
<div class="paragraph">
<p>The mapping element defines additional mapping of principals,
credentials, roles and attributes for the subject. The structure of the
mapping element is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;mapping-module type="..."code="..." module="..."&gt;
  &lt;module-option name="..." value="..."/&gt;
&lt;/mapping-module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The type attribute reflects the type of mapping of the provider and
should be one of principal, credential, role or attribute. By default
"role" is the type used if the attribute is not set.</p>
</div>
<div class="paragraph">
<p>The code attribute is used to specify the implementing class of the
login module which can either be the full class name or one of the
abbreviated names from the following list:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Classname</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PropertiesRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.mapping.providers.role.PropertiesRolesMappingProvider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SimpleRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.mapping.providers.role.SimpleRolesMappingProvider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DeploymentRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.mapping.providers.DeploymentRolesMappingProvider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DatabaseRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.mapping.providers.role.DatabaseRolesMappingProvider</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LdapRoles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.jboss.security.mapping.providers.role.LdapRolesMappingProvider</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The module attribute specifies the name of the JBoss Modules module from
which the class specified by the code attribute should be loaded.
Specifying it is not necessary if one of the abbreviated names in the
above list is used.</p>
</div>
<div class="paragraph">
<p>The module-option element can be repeated zero or more times to specify
the module options as required for the login module being configured. It
requires the name and value attributes.</p>
</div>
</div>
<div class="sect4">
<h5 id="audit">audit</h5>
<div class="paragraph">
<p>The audit element can be used to define a custom audit provider. The
default implementation used is
<code>org.jboss.security.audit.providers.LogAuditProvider</code>. The structure of
the audit element is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;provider-module code="..." module="..."&gt;
  &lt;module-option name="..." value="..."/&gt;
&lt;/provider-module&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code attribute is used to specify the implementing class of the
provider module.</p>
</div>
<div class="paragraph">
<p>The module attribute specifies the name of the JBoss Modules module from
which the class specified by the code attribute should be loaded.</p>
</div>
<div class="paragraph">
<p>The module-option element can be repeated zero or more times to specify
the module options as required for the login module being configured. It
requires the name and value attributes.</p>
</div>
</div>
<div class="sect4">
<h5 id="jsse">jsse</h5>
<div class="paragraph">
<p>The jsse element defines configuration for keystores and truststores
that can be used for SSL context configuration or for certificate
storing/retrieving.</p>
</div>
<div class="paragraph">
<p>The set of attributes (all of them optional) of this element are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">keystore-password</th>
<th class="tableblock halign-left valign-top">Password of the keystore</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type of the keystore. By default it&#8217;s "JKS"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL where the keystore file can be found</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider of the keystore. The default JDK provider
for the keystore type is used if this attribute is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-provider-argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String that can be passed as the argument
of the keystore Provider constructor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key-manager-factory-algorithm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Algorithm of the KeyManagerFactory. The
default JDK algorithm of the key manager factory is used if this
attribute is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key-manager-factory-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider of the KeyManagerFactory. The
default JDK provider for the key manager factory algorithm is used if
this attribute is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">truststore-password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password of the truststore</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">truststore-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type of the truststore. By deafult it&#8217;s "JKS"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">truststore-url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL where the truststore file can be found</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">truststore-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider of the truststore. The default JDK
provider for the truststore type is used if this attribute is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">truststore-provider-argument</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String that can be passed as the argument
of the truststore Provider constructor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">trust-manager-factory-algorithm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Algorithm of the TrustManagerFactory.
The default JDK algorithm of the trust manager factory is used if this
attribute is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">trust-manager-factory-provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider of the TrustManagerFactory.
The default JDK provider for the trust manager factory algorithm is used
if this attribute is null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">client-alias</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alias of the keystore to be used when creating client
side SSL sockets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">server-alias</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alias of the keystore to be used when creating server
side SSL sockets</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">service-auth-token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Validation token to enable third party services to
retrieve a keystore Key. This is typically used to retrieve a private
key for signing purposes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">client-auth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flag to indicate if the server side SSL socket should
require client authentication. Default is "false"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cipher-suites</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma separated list of cipher suites to be used by a
SSLContext</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">protocols</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma separated list of SSL protocols to be used by a
SSLContext</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The optional additional-properties element can be used to include other
options. The structure of the jsse element is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;jsse keystore-url="..." keystore-password="..." keystore-type="..." keystore-provider="..." keystore-provider-argument="..." key-manager-factory-algorithm="..." key-manager-factory-provider="..." truststore-url="..." truststore-password="..." truststore-type="..." truststore-provider="..." truststore-provider-argument="..." trust-manager-factory-algorithm="..." trust-manager-factory-provider="..." client-alias="..." server-alias="..." service-auth-token="..." client-auth="..." cipher-suites="..." protocols="..."&gt;
  &lt;additional-properties&gt;x=y
    a=b
  &lt;/additional-properties&gt;
&lt;/jsse&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="security-properties">security-properties</h4>
<div class="paragraph">
<p>This element is used to specify additional properties as required by the
security subsystem, properties are specified in the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;security-properties&gt;
  &lt;property name="..." value="..."/&gt;
&lt;/security-properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The property element can be repeated as required for as many properties
need to be defined.</p>
</div>
<div class="paragraph">
<p>Each property specified is set on the <code>java.security.Security</code> class.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Security_Authentication_Modules">Authentication Modules</h3>
<div class="paragraph">
<p>In this section we will describe each login module&#8217;s options available.</p>
</div>
<div class="sect3">
<h4 id="client">Client</h4>
<div class="paragraph">
<p>This login module is designed to establish caller identity and
credentials when WildFly is acting a client. It should never be used as
part of a security domain used for actual server authentication.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">multi-threaded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to true if each thread has its own
principal and credential storage. Set to false to indicate that all
threads in the VM share the same identity and credential. Default is
false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">restore-login-identity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to true if the identity and
credential seen at the start of the login() method should be restored
after the logout() method is invoked. Default is false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password-stacking</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to useFirstPass to indicate that this
login module should look for information stored in the LoginContext to
use as the identity. This option can be used when stacking other login
modules with this one. Default is false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="database">Database</h4>
<div class="paragraph">
<p>This login module is designed to be used for authenticating users
against a database backend.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dsJndiName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JNDI name of the datasource containing the tables
for users and roles</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">principalsQuery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL prepared statement to be executed in
order to match the password. Default is select Password from Principals
where PrincipalID=?</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rolesQuery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL prepared statement to be executed in order to
map roles. It should be an equivalent to select Role, RoleGroup from
Roles where PrincipalID=?, where Role is the role name and RoleGroup
column value should always be "Roles" with capital R.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">suspendResume</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A boolean flag that specifies that any
existing JTA transaction be suspended during DB operations. The default
is true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="certificate">Certificate</h4>
<div class="paragraph">
<p>This login module is designed to authenticate users based on
X509Certificates. A use case for this is CLIENT-CERT authentication of a
web application.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">securityDomain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the security domain that has the jsse
configuration for the truststore holding the trusted certificates</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">verifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The class name of the
org.jboss.security.auth.certs.X509CertificateVerifier to use for
verification of the login certificate</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If there is no verifier set, this login module will try to validate the
user&#8217;s certificate with a public certificate stored in the truststore.
The public certificate must be stored in the truststore using the DN of
the certificate as the truststore alias.</p>
</div>
</div>
<div class="sect3">
<h4 id="certificateroles">CertificateRoles</h4>
<div class="paragraph">
<p>This login module extends the Certificate login module to add role
mapping capabilities from a properties file. It has the same options
plus these additional options:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rolesProperties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the resource/file containing the
roles to assign to each user. Default is roles.properties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultRolesProperties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the resource/file to fall
back to if the rolesProperties file can&#8217;t be found. Default is
defaultRoles.properties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">roleGroupSeperator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Character to use as the role group
separator in the role properties file. Default character is '.' (period)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The role properties file must be in the format username=role1,role2
where the username is the DN of the certificate, escaping any equals and
space characters. Here is an example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CN\=unit-tests-client,\ OU\=JBoss\ Inc.,\ O\=JBoss\ Inc.,\ ST\=Washington,\ C\=US=JBossAdmin</pre>
</div>
</div>
<div class="paragraph">
<p>This would assign the <em>JBossAdmin</em> role to an user that presents a
certificate with <em>CN=unit-tests-client, OU=JBoss Inc., O=JBoss Inc.,
ST=Washington, C=US</em> as the DN.</p>
</div>
</div>
<div class="sect3">
<h4 id="databasecertificate">DatabaseCertificate</h4>
<div class="paragraph">
<p>This login module extends the Certificate login to add role mapping
capabilities from a database table. It has the same options plus these
additional options:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Options</th>
<th class="tableblock halign-left valign-top">Usage</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dsJndiName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JNDI name of the datasource containing the tables
for users and roles</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rolesQuery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL prepared statement to be executed in order to
map roles. It should be an equivalent to select Role, RoleGroup from
Roles where PrincipalID=?, where Role is the role name and RoleGroup
column value should always be "Roles" with capital R. Default is select
Role, RoleGroup from Roles where PrincipalID=?</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">suspendResume</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A boolean flag that specifies that any
existing JTA transaction be suspended during DB operations. The default
is <strong>true</strong>
select Role, RoleGroup from Roles where PrincipalID=?</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Web_services">Web services configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JBossWS components are provided to the application server through the
webservices subsystem. JBossWS components handle the processing of WS
endpoints. The subsystem supports the configuration of published
endpoint addresses, and endpoint handler chains. A default webservice
subsystem is provided in the server&#8217;s domain and standalone
configuration files.</p>
</div>
<div class="sect2">
<h3 id="structure-of-the-webservices-subsystem">Structure of the webservices subsystem</h3>
<div class="sect3">
<h4 id="published-endpoint-address">Published endpoint address</h4>
<div class="paragraph">
<p>JBossWS supports the rewriting of the <code>&lt;soap:address&gt;</code> element of
endpoints published in WSDL contracts. This feature is useful for
controlling the server address that is advertised to clients for each
endpoint.</p>
</div>
<div class="paragraph">
<p>The following elements are available and can be modified (all are
optional):</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">modify-wsdl-address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This boolean enables and disables the
address rewrite functionality.When modify-wsdl-address is set to true
and the content of &lt;soap:address&gt; is a valid URL, JBossWS will rewrite
the URL using the values of wsdl-host and wsdl-port or
wsdl-secure-port.When modify-wsdl-address is set to false and the
content of &lt;soap:address&gt; is a valid URL, JBossWS will not rewrite the
URL. The &lt;soap:address&gt; URL will be used.When the content of
&lt;soap:address&gt; is not a valid URL, JBossWS will rewrite it no matter
what the setting of modify-wsdl-address.If modify-wsdl-address is set to
true and wsdl-host is not defined or explicitly set to
'jbossws.undefined.host' the content of &lt;soap:address&gt; URL is use.
JBossWS uses the requester&#8217;s host when rewriting the &lt;soap:address&gt;When
modify-wsdl-address is not defined JBossWS uses a default value of true.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">wsdl-host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hostname / IP address to be used for rewriting
&lt;soap:address&gt;.If wsdl-host is set to jbossws.undefined.host, JBossWS
uses the requester&#8217;s host when rewriting the &lt;soap:address&gt;When
wsdl-host is not defined JBossWS uses a default value of
'jbossws.undefined.host'.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">wsdl-port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set this property to explicitly define the HTTP port
that will be used for rewriting the SOAP address.Otherwise the HTTP port
will be identified by querying the list of installed HTTP connectors.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">wsdl-secure-port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set this property to explicitly define the HTTPS
port that will be used for rewriting the SOAP address.Otherwise the
HTTPS port will be identified by querying the list of installed HTTPS
connectors.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">wsdl-uri-scheme</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This property explicitly sets the URI scheme
to use for rewriting &lt;soap:address&gt; . Valid values are http and https.
This configuration overrides scheme computed by processing the endpoint
(even if a transport guaranteeis specified). The provided values for
wsdl-port and wsdl-secure-port (or their default values) are used
depending on specified scheme.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">wsdl-path-rewrite-rule</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This string defines a SED substitution
command (e.g., 's/regexp/replacement/g') that JBossWS executes against
the path component of each &lt;soap:address&gt; URL published from the
server.When wsdl-path-rewrite-rule is not defined, JBossWS retains the
original path component of each &lt;soap:address&gt; URL.When
'modify-wsdl-address' is set to "false" this element is ignored.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="predefined-endpoint-configurations">Predefined endpoint configurations</h4>
<div class="paragraph">
<p>JBossWS enables extra setup configuration data to be predefined and
associated with an endpoint implementation. Predefined endpoint
configurations can be used for JAX-WS client and JAX-WS endpoint setup.
Endpoint configurations can include JAX-WS handlers and key/value
properties declarations. This feature provides a convenient way to add
handlers to WS endpoints and to set key/value properties that control
JBossWS and Apache CXF internals (
<a href="https://docs.jboss.org/author/display/JBWS/Apache+CXF+integration#ApacheCXFintegration-Deploymentdescriptorproperties">see
Apache CXF configuration</a>).</p>
</div>
<div class="paragraph">
<p>The webservices subsystem provides
<a href="http://www.jboss.org/schema/jbossas/jboss-as-webservices_1_2.xsd">schema</a>
to support the definition of named sets of endpoint configuration data.
Annotation, <em>org.jboss.ws.api.annotation.EndpointConfig</em> is provided to
map the named configuration to the endpoint implementation.</p>
</div>
<div class="paragraph">
<p>There is no limit to the number of endpoint configurations that can be
defined within the webservices subsystem. Each endpoint configuration
must have a name that is unique within the webservices subsystem.
Endpoint configurations defined in the webservices subsystem are
available for reference by name through the annotation to any endpoint
in a deployed application.</p>
</div>
<div class="paragraph">
<p>WildFly ships with two predefined endpoint configurations.
Standard-Endpoint-Config is the default configuration.
Recording-Endpoint-Config is an example of custom endpoint configuration
and includes a recording handler.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9999 /] /subsystem=webservices:read-resource
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "endpoint" =&gt; {},
        "modify-wsdl-address" =&gt; true,
        "wsdl-host" =&gt; expression "${jboss.bind.address:127.0.0.1}",
        "endpoint-config" =&gt; {
            "Standard-Endpoint-Config" =&gt; undefined,
            "Recording-Endpoint-Config" =&gt; undefined
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The <code>Standard-Endpoint-Config</code> is a special endpoint configuration. It
is used for any endpoint that does not have an explicitly assigned
endpoint configuration.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="endpoint-configs">Endpoint configs</h5>
<div class="paragraph">
<p>Endpoint configs are defined using <code>the endpoint-config</code> element. Each
endpoint configuration may include properties and handlers set to the
endpoints associated to the configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9999 /] /subsystem=webservices/endpoint-config=Recording-Endpoint-Config:read-resource
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "post-handler-chain" =&gt; undefined,
        "property" =&gt; undefined,
        "pre-handler-chain" =&gt; {"recording-handlers" =&gt; undefined}
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A new endpoint configuration can be added as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9999 /] /subsystem=webservices/endpoint-config=My-Endpoint-Config:add
{
    "outcome" =&gt; "success",
    "response-headers" =&gt; {
        "operation-requires-restart" =&gt; true,
        "process-state" =&gt; "restart-required"
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="handler-chains">Handler chains</h5>
<div class="paragraph">
<p>Each endpoint configuration may be associated with zero or more PRE and
POST handler chains. Each handler chain may include JAXWS handlers. For
outbound messages the PRE handler chains are executed before any handler
that is attached to the endpoint using the standard means, such as with
annotation @HandlerChain, and POST handler chains are executed after
those objects have executed. For inbound messages the POST handler
chains are executed before any handler that is attached to the endpoint
using the standard means and the PRE handler chains are executed after
those objects have executed.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>* Server inbound messages
Client --&gt; ... --&gt; POST HANDLER --&gt; ENDPOINT HANDLERS --&gt; PRE HANDLERS --&gt; Endpoint

* Server outbound messages
Endpoint --&gt; PRE HANDLER --&gt; ENDPOINT HANDLERS --&gt; POST HANDLERS --&gt; ... --&gt; Client</pre>
</div>
</div>
<div class="paragraph">
<p>The protocol-binding attribute must be used to set the protocols for
which the chain will be triggered.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9999 /] /subsystem=webservices/endpoint-config=Recording-Endpoint-Config/pre-handler-chain=recording-handlers:read-resource
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "protocol-bindings" =&gt; "##SOAP11_HTTP ##SOAP11_HTTP_MTOM ##SOAP12_HTTP ##SOAP12_HTTP_MTOM",
        "handler" =&gt; {"RecordingHandler" =&gt; undefined}
    },
    "response-headers" =&gt; {"process-state" =&gt; "restart-required"}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A new handler chain can be added as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9999 /] /subsystem=webservices/endpoint-config=My-Endpoint-Config/post-handler-chain=my-handlers:add(protocol-bindings="##SOAP11_HTTP")
{
    "outcome" =&gt; "success",
    "response-headers" =&gt; {
        "operation-requires-restart" =&gt; true,
        "process-state" =&gt; "restart-required"
    }
}
[standalone@localhost:9999 /] /subsystem=webservices/endpoint-config=My-Endpoint-Config/post-handler-chain=my-handlers:read-resource
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "handler" =&gt; undefined,
        "protocol-bindings" =&gt; "##SOAP11_HTTP"
    },
    "response-headers" =&gt; {"process-state" =&gt; "restart-required"}
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="jaxws-handlers">Handlers</h5>
<div class="paragraph">
<p>JAXWS handler can be added in handler chains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9999 /] /subsystem=webservices/endpoint-config=Recording-Endpoint-Config/pre-handler-chain=recording-handlers/handler=RecordingHandler:read-resource
{
    "outcome" =&gt; "success",
    "result" =&gt; {"class" =&gt; "org.jboss.ws.common.invocation.RecordingServerHandler"},
    "response-headers" =&gt; {"process-state" =&gt; "restart-required"}
}
[standalone@localhost:9999 /] /subsystem=webservices/endpoint-config=My-Endpoint-Config/post-handler-chain=my-handlers/handler=foo-handler:add(class="org.jboss.ws.common.invocation.RecordingServerHandler")
{
    "outcome" =&gt; "success",
    "response-headers" =&gt; {
        "operation-requires-restart" =&gt; true,
        "process-state" =&gt; "restart-required"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Endpoint-config handler classloading</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>class</code> attribute is used to provide the fully qualified class name
of the handler. At deploy time, an instance of the class is created for
each referencing deployment. For class creation to succeed, the
deployment classloader must to be able to load the handler class.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="runtime-information">Runtime information</h3>
<div class="paragraph">
<p>Each web service endpoint is exposed through the deployment that
provides the endpoint implementation. Each endpoint can be queried as a
deployment resource. For further information please consult the chapter
"Application Deployment". Each web service endpoint specifies a web
context and a WSDL Url:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9999 /] /deployment="*"/subsystem=webservices/endpoint="*":read-resource
{
   "outcome" =&gt; "success",
   "result" =&gt; [{
       "address" =&gt; [
           ("deployment" =&gt; "jaxws-samples-handlerchain.war"),
           ("subsystem" =&gt; "webservices"),
           ("endpoint" =&gt; "jaxws-samples-handlerchain:TestService")
       ],
       "outcome" =&gt; "success",
       "result" =&gt; {
           "class" =&gt; "org.jboss.test.ws.jaxws.samples.handlerchain.EndpointImpl",
           "context" =&gt; "jaxws-samples-handlerchain",
           "name" =&gt; "TestService",
           "type" =&gt; "JAXWS_JSE",
           "wsdl-url" =&gt; "http://localhost:8080/jaxws-samples-handlerchain?wsdl"
       }
   }]
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ws-component-reference">Component Reference</h3>
<div class="paragraph">
<p>The web service subsystem is provided by the JBossWS project. For a
detailed description of the available configuration properties, please
consult the project documentation.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>JBossWS homepage: <a href="http://www.jboss.org/jbossws" class="bare">http://www.jboss.org/jbossws</a></p>
</li>
<li>
<p>Project Documentation: <a href="https://docs.jboss.org/author/display/JBWS" class="bare">https://docs.jboss.org/author/display/JBWS</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Resource_adapters">Resource adapters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Resource adapters are configured through the <em>resource-adapters</em>
subsystem. Declaring a new resource adapter consists of two separate
steps: You would need to deploy the .rar archive and define a resource
adapter entry in the subsystem.</p>
</div>
<div class="sect2">
<h3 id="resource-adapter-definitions">Resource Adapter Definitions</h3>
<div class="paragraph">
<p>The resource adapter itself is defined within the subsystem
<em>resource-adapters</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:resource-adapters:1.0"&gt;
    &lt;resource-adapters&gt;
       &lt;resource-adapter&gt;
          &lt;archive&gt;eis.rar&lt;/archive&gt;
Â Â Â Â Â Â Â Â Â Â &lt;!-- Resource adapter level config-property --&gt;
Â Â Â Â Â Â Â Â Â  &lt;config-property name="Server"&gt;localhost&lt;/config-property&gt;
Â Â Â Â Â Â Â Â Â  &lt;config-property name="Port"&gt;19000&lt;/config-property&gt;
Â Â Â Â Â Â Â Â Â  &lt;transaction-support&gt;XATransaction&lt;/transaction-support&gt;
Â Â Â Â Â Â Â Â Â  &lt;connection-definitions&gt;
Â Â Â Â Â Â Â Â Â Â Â Â  &lt;connection-definition class-name="com.acme.eis.ra.EISManagedConnectionFactory"
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  jndi-name="java:/eis/AcmeConnectionFactory"
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  pool-name="AcmeConnectionFactory"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  &lt;!-- Managed connection factory level config-property --&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  &lt;config-property name="Name"&gt;Acme Inc&lt;/config-property&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  &lt;pool&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  &lt;min-pool-size&gt;10&lt;/min-pool-size&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  &lt;max-pool-size&gt;100&lt;/max-pool-size&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  &lt;/pool&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  &lt;security&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  &lt;application/&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  &lt;/security&gt;
Â Â Â Â Â Â Â Â Â Â Â Â  &lt;/connection-definition&gt;
Â Â Â Â Â Â Â Â  &lt;/connection-definitions&gt;
Â Â Â Â Â Â Â Â  &lt;admin-objects&gt;
Â Â Â Â Â Â Â Â Â Â Â Â  &lt;admin-object class-name="com.acme.eis.ra.EISAdminObjectImpl"
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â  jndi-name="java:/eis/AcmeAdminObject"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  &lt;config-property name="Threshold"&gt;10&lt;/config-property&gt;
Â Â Â Â Â Â Â Â Â Â Â Â  &lt;/admin-object&gt;
Â Â Â Â Â Â Â Â  &lt;/admin-objects&gt;
       &lt;/resource-adapter&gt;
    &lt;/resource-adapters&gt;
&lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note, that only JNDI bindings under java:/ or java:jboss/ are supported.</p>
</div>
<div class="paragraph">
<p><sub>(See</sub> <code>standalone/configuration/standalone.xml</code> <sub>)</sub></p>
</div>
</div>
<div class="sect2">
<h3 id="ra-using-security-domains">Using security domains</h3>
<div class="paragraph">
<p>Information about using security domains can be found at
<a href="https://community.jboss.org/wiki/JBossAS7SecurityDomainModel" class="bare">https://community.jboss.org/wiki/JBossAS7SecurityDomainModel</a></p>
</div>
</div>
<div class="sect2">
<h3 id="automatic-activation-of-resource-adapter-archives">Automatic activation of resource adapter archives</h3>
<div class="paragraph">
<p>A resource adapter archive can be automatically activated with a
configuration by including an META-INF/ironjacamar.xml in the archive.</p>
</div>
<div class="paragraph">
<p>The schema can be found at
<a href="http://docs.jboss.org/ironjacamar/schema/ironjacamar_1_0.xsd" class="bare">http://docs.jboss.org/ironjacamar/schema/ironjacamar_1_0.xsd</a></p>
</div>
</div>
<div class="sect2">
<h3 id="ra-component-reference">Component Reference</h3>
<div class="paragraph">
<p>The resource adapter subsystem is provided by the
<a href="http://www.jboss.org/ironjacamar">IronJacamar</a> project. For a detailed
description of the available configuration properties, please consult
the project documentation.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>IronJacamar homepage: <a href="http://www.jboss.org/ironjacamar" class="bare">http://www.jboss.org/ironjacamar</a></p>
</li>
<li>
<p>Project Documentation: <a href="http://www.jboss.org/ironjacamar/docs" class="bare">http://www.jboss.org/ironjacamar/docs</a></p>
</li>
<li>
<p>Schema description:
<a href="http://docs.jboss.org/ironjacamar/userguide/1.0/en-US/html/deployment.html#deployingra_descriptor" class="bare">http://docs.jboss.org/ironjacamar/userguide/1.0/en-US/html/deployment.html#deployingra_descriptor</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>[[Batch_(JSR-352)]]
= Batch (JSR-352) Subsystem Configuration</p>
</div>
<div class="quoteblock abstract">
<blockquote>
The batch subsystem is used to configure an environment for running
batch applications. <a href="http://wildfly.org">WildFly</a> uses
<a href="https://github.com/jberet/jsr352">JBeret</a> for it&#8217;s batch implementation.
Specific information about JBeret can be found in the
<a href="http://jberet.gitbooks.io/jberet-user-guide/content/">user guide</a>. The
resource path, in <a href="#CLI_Recipes">CLI notation</a>, for the subsystem
is <code>subsystem=batch-jberet</code>.
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="default-subsystem-configuration">Default Subsystem Configuration</h3>
<div class="paragraph">
<p>For up to date information about subsystem configuration options see
<a href="http://wildscribe.github.io/" class="bare">http://wildscribe.github.io/</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="security">Security</h3>
<div class="paragraph">
<p>A new <code>security-domain</code> attribute was added to the <code>batch-jberet</code>
subsystem to allow batch jobs to be executed under that security domain.
Jobs that are stopped as part of a <code>suspend</code> operation will be restarted
on execution of a <code>resume</code> with the original user that started job.</p>
</div>
<div class="paragraph">
<p>There was a
<code>org.wildfly.extension.batch.jberet.deployment.BatchPermission</code> added to
allow a security restraint to various batch functions. The following
functions can be controlled with this permission.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>start</p>
</li>
<li>
<p>stop</p>
</li>
<li>
<p>restart</p>
</li>
<li>
<p>abandon</p>
</li>
<li>
<p>read</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The read function allows users to use the getter methods from the
<code>javax.batch.operations.JobOperator</code> or read the <code>batch-jberet</code>
deployment resource, for example
<code>/deployment=my.war/subsystem=batch-jberet:read-resource</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="deployment-descriptors">Deployment Descriptors</h3>
<div class="paragraph">
<p>There are no deployment descriptors for configuring a batch environment
defined by the <a href="https://www.jcp.org/en/jsr/detail?id=352">JSR-352
specification</a>. In <a href="http://wildfly.org">WildFly</a> you can use a
<code>jboss-all.xml</code> deployment descriptor to define aspects of the batch
environment for your deployment.</p>
</div>
<div class="paragraph">
<p>In the <code>jboss-all.xml</code> deployment descriptor you can define a named job
repository, a new job repository and/or a named thread pool. A named job
repository and named thread pool are resources defined on the batch
subsystem. Only a named thread pool is allowed to be defined in the
deployment descriptor.</p>
</div>
<div class="listingblock">
<div class="title">Example Named Job Repository and Thread Pool</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;jboss umlns="urn:jboss:1.0"&gt;
    &lt;batch xmlns="urn:jboss:batch-jberet:1.0"&gt;
      &lt;job-repository&gt;
        &lt;named name="batch-ds"/&gt;
      &lt;/job-repository&gt;
      &lt;thread-pool name="deployment-thread-pool"/&gt;
    &lt;/batch&gt;
&lt;/jboss&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example new Job Repository</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;jboss umlns="urn:jboss:1.0"&gt;
    &lt;batch xmlns="urn:jboss:batch-jberet:1.0"&gt;
        &lt;job-repository&gt;
            &lt;jdbc jndi-name="java:jboss/datasources/ExampleDS"/&gt;
        &lt;/job-repository&gt;
    &lt;/batch&gt;
&lt;/jboss&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deployment-resources">Deployment Resources</h3>
<div class="paragraph">
<p>Some subsystems in <a href="http://wildfly.org">WildFly</a> register runtime
resources for deployments. The batch subsystem registers jobs and
executions. The jobs are registered using the job name, this is <em>not</em>
the job XML name. Executions are registered using the execution id.</p>
</div>
<div class="listingblock">
<div class="title">Batch application in a standalone server</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /deployment=batch-jdbc-chunk.war/subsystem=batch-jberet:read-resource(recursive=true,include-runtime=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {"job" =&gt; {
        "reader-3" =&gt; {
            "instance-count" =&gt; 1,
            "running-executions" =&gt; 0,
            "execution" =&gt; {"1" =&gt; {
                "batch-status" =&gt; "COMPLETED",
                "create-time" =&gt; "2015-08-07T15:37:06.416-0700",
                "end-time" =&gt; "2015-08-07T15:37:06.519-0700",
                "exit-status" =&gt; "COMPLETED",
                "instance-id" =&gt; 1L,
                "last-updated-time" =&gt; "2015-08-07T15:37:06.519-0700",
                "start-time" =&gt; "2015-08-07T15:37:06.425-0700"
            }}
        },
        "reader-5" =&gt; {
            "instance-count" =&gt; 0,
            "running-executions" =&gt; 0,
            "execution" =&gt; undefined
        }
    }}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The batch subsystem resource on a deployment also has 3 operations to
interact with batch jobs on the selected deployment. There is a
<code>start-job</code>, <code>stop-job</code> and <code>restart-job</code> operation. The <code>execution</code>
resource also has a <code>stop-job</code> and <code>restart-job</code> operation.</p>
</div>
<div class="listingblock">
<div class="title">Example start-job</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /deployment=batch-chunk.war/subsystem=batch-jberet:start-job(job-xml-name=simple, properties={writer.sleep=5000})
{
    "outcome" =&gt; "success",
    "result" =&gt; 1L
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example stop-job</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /deployment=batch-chunk.war/subsystem=batch-jberet:stop-job(execution-id=2)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example restart-job</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /deployment=batch-chunk.war/subsystem=batch-jberet:restart-job(execution-id=2)
{
    "outcome" =&gt; "success",
    "result" =&gt; 3L
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Result of resource after the 3 executions</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /deployment=batch-chunk.war/subsystem=batch-jberet:read-resource(recursive=true, include-runtime=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {"job" =&gt; {"chunkPartition" =&gt; {
        "instance-count" =&gt; 2,
        "running-executions" =&gt; 0,
        "execution" =&gt; {
            "1" =&gt; {
                "batch-status" =&gt; "COMPLETED",
                "create-time" =&gt; "2015-08-07T15:41:55.504-0700",
                "end-time" =&gt; "2015-08-07T15:42:15.513-0700",
                "exit-status" =&gt; "COMPLETED",
                "instance-id" =&gt; 1L,
                "last-updated-time" =&gt; "2015-08-07T15:42:15.513-0700",
                "start-time" =&gt; "2015-08-07T15:41:55.504-0700"
            },
            "2" =&gt; {
                "batch-status" =&gt; "STOPPED",
                "create-time" =&gt; "2015-08-07T15:44:39.879-0700",
                "end-time" =&gt; "2015-08-07T15:44:54.882-0700",
                "exit-status" =&gt; "STOPPED",
                "instance-id" =&gt; 2L,
                "last-updated-time" =&gt; "2015-08-07T15:44:54.882-0700",
                "start-time" =&gt; "2015-08-07T15:44:39.879-0700"
            },
            "3" =&gt; {
                "batch-status" =&gt; "COMPLETED",
                "create-time" =&gt; "2015-08-07T15:45:48.162-0700",
                "end-time" =&gt; "2015-08-07T15:45:53.165-0700",
                "exit-status" =&gt; "COMPLETED",
                "instance-id" =&gt; 2L,
                "last-updated-time" =&gt; "2015-08-07T15:45:53.165-0700",
                "start-time" =&gt; "2015-08-07T15:45:48.163-0700"
            }
        }
    }}}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pro Tip</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can filter jobs by an attribute on the execution resource with the
<code>query</code> operation.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">View all stopped jobs</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/deployment=batch-chunk.war/subsystem=batch-jberet/job=*/execution=*:query(where=["batch-status", "STOPPED"])</code></pre>
</div>
</div>
<div class="paragraph">
<p>As with all operations you can see details about the operation using the
<code>:read-operation-description</code> operation.</p>
</div>
<div class="paragraph">
<p>Tab completion</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Don&#8217;t forget that CLI has tab completion which will complete operations
and attributes (arguments) on operations.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example start-job operation description</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /deployment=batch-chunk.war/subsystem=batch-jberet:read-operation-description(name=start-job)
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "operation-name" =&gt; "start-job",
        "description" =&gt; "Starts a batch job.",
        "request-properties" =&gt; {
            "job-xml-name" =&gt; {
                "type" =&gt; STRING,
                "description" =&gt; "The name of the job XML file to use when starting the job.",
                "expressions-allowed" =&gt; false,
                "required" =&gt; true,
                "nillable" =&gt; false,
                "min-length" =&gt; 1L,
                "max-length" =&gt; 2147483647L
            },
            "properties" =&gt; {
                "type" =&gt; OBJECT,
                "description" =&gt; "Optional properties to use when starting the batch job.",
                "expressions-allowed" =&gt; false,
                "required" =&gt; false,
                "nillable" =&gt; true,
                "value-type" =&gt; STRING
            }
        },
        "reply-properties" =&gt; {"type" =&gt; LONG},
        "read-only" =&gt; false,
        "runtime-only" =&gt; true
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="JSF">JSF Configuration</h2>
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
JSF configuration is handled by the JSF subsystem. The JSF subsystem
allows multiple JSF implementations to be installed on the same WildFly
server. In particular, any version of Mojarra or MyFaces that implements
spec level 2.1 or higher can be installed. For each JSF implementation,
a new slot needs to be created under <code>com.sun.jsf-impl</code>,
<code>javax.faces.api</code>, and <code>org.jboss.as.jsf-injection</code>. When the JSF
subsystem starts up, it scans the module path to find all of the JSF
implementations that have been installed. The default JSF implementation
that WildFly should use is defined by the <code>default-jsf-impl-slot</code>
attribute.
</blockquote>
</div>
<div class="sect2">
<h3 id="installing-a-new-jsf-implementation-manually">Installing a new JSF implementation manually</h3>
<div class="paragraph">
<p>A new JSF implementation can be manually installed as follows:</p>
</div>
<div class="sect3">
<h4 id="add-a-module-slot-for-the-new-jsf-implementation-jar">Add a module slot for the new JSF implementation JAR</h4>
<div class="ulist">
<ul>
<li>
<p>Create the following directory structure under the
WILDFLY_HOME/modules directory:<br>
WILDFLY_HOME/modules/com/sun/jsf-impl/&lt;JSF_IMPL_NAME&gt;-&lt;JSF_VERSION&gt;<br>
<br>
For example, for Mojarra 2.2.11, the above path would resolve to:<br>
WILDFLY_HOME/modules/com/sun/jsf-impl/mojarra-2.2.11</p>
</li>
<li>
<p>Place the JSF implementation JAR in the &lt;JSF_IMPL_NAME&gt;-&lt;JSF_VERSION&gt;
subdirectory. In the same subdirectory, add a <code>module.xml</code> file similar
to the
<a href="https://github.com/wildfly/wildfly/blob/master/jsf/multi-jsf-installer/src/main/resources/mojarra-impl-module.xml">Mojarra</a>
or
<a href="https://github.com/wildfly/wildfly/blob/master/jsf/multi-jsf-installer/src/main/resources/myfaces-impl-module.xml">MyFaces</a>
template examples. Change the <code>resource-root-path</code> to the name of your
JSF implementation JAR and fill in appropriate values for $\{
<code>jsf-impl-name</code>} and $\{ <code>jsf-version</code>}.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="add-a-module-slot-for-the-new-jsf-api-jar">Add a module slot for the new JSF API JAR</h4>
<div class="ulist">
<ul>
<li>
<p>Create the following directory structure under the
WILDFLY_HOME/modules directory:<br>
WILDFLY_HOME/modules/javax/faces/api/&lt;JSF_IMPL_NAME&gt;-&lt;JSF_VERSION&gt;</p>
</li>
<li>
<p>Place the JSF API JAR in the &lt;JSF_IMPL_NAME&gt;-&lt;JSF_VERSION&gt;
subdirectory. In the same subdirectory, add a <code>module.xml</code> file similar
to the
<a href="https://github.com/wildfly/wildfly/blob/master/jsf/multi-jsf-installer/src/main/resources/mojarra-api-module.xml">Mojarra</a>
or
<a href="https://github.com/wildfly/wildfly/blob/master/jsf/multi-jsf-installer/src/main/resources/myfaces-api-module.xml">MyFaces</a>
template examples. Change the <code>resource-root-path</code> to the name of your
JSF API JAR and fill in appropriate values for $\{ <code>jsf-impl-name</code>} and
$\{ <code>jsf-version</code>}.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="add-a-module-slot-for-the-jsf-injection-jar">Add a module slot for the JSF injection JAR</h4>
<div class="ulist">
<ul>
<li>
<p>Create the following directory structure under the
WILDFLY_HOME/modules directory:<br>
WILDFLY_HOME/modules/org/jboss/as/jsf-injection/&lt;JSF_IMPL_NAME&gt;-&lt;JSF_VERSION&gt;</p>
</li>
<li>
<p>Copy the wildfly-jsf-injection JAR and the weld-core-jsf JAR from
WILDFLY_HOME/modules/system/layers/base/org/jboss/as/jsf-injection/main
to the &lt;JSF_IMPL_NAME&gt;-&lt;JSF_VERSION&gt; subdirectory.</p>
</li>
<li>
<p>In the &lt;JSF_IMPL_NAME&gt;-&lt;JSF_VERSION&gt; subdirectory, add a <code>module.xml</code>
file similar to the
<a href="https://gist.github.com/fjuma/30160f0e95ade328253118c706339604">Mojarra</a>
or
<a href="https://gist.github.com/fjuma/f73b05c3864255e7b10b49f989f0b75e">MyFaces</a>
template examples and fill in appropriate values for $\{
<code>jsf-impl-name</code>}, $\{ <code>jsf-version</code>}, $\{ <code>version.jboss.as</code>}, and $\{
<code>version.weld.core</code>}. (These last two placeholders depend on the
versions of the wildfly-jsf-injection and weld-core-jsf JARs that were
copied over in the previous step.)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="for-myfaces-only---add-a-module-for-the-commons-digester-jar">For MyFaces only - add a module for the commons-digester JAR</h4>
<div class="ulist">
<ul>
<li>
<p>Create the following directory structure under the
WILDFLY_HOME/modules directory:<br>
WILDFLY_HOME/modules/org/apache/commons/digester/main</p>
</li>
<li>
<p>Place the
<a href="http://search.maven.org/remotecontent?filepath=commons-digester/commons-digester/1.8/commons-digester-1.8.jar">commons-digester</a>
JAR in WILDFLY_HOME/modules/org/apache/commons/digester/main. In the
<code>main</code> subdirectory, add a <code>module.xml</code> file similar to this
<a href="https://github.com/wildfly/wildfly/blob/master/jsf/multi-jsf-installer/src/main/resources/myfaces-digester-module.xml">template</a>.
Fill in the appropriate value for $\{ <code>version.commons-digester</code>}.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="start-the-server">Start the server</h4>
<div class="paragraph">
<p>After starting the server, the following CLI command can be used to
verify that your new JSF implementation has been installed successfully.
The new JSF implementation should appear in the output of this command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /subsystem=jsf:list-active-jsf-impls()</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="changing-the-default-jsf-implementation">Changing the default JSF implementation</h3>
<div class="paragraph">
<p>The following CLI command can be used to make a newly installed JSF
implementation the default JSF implementation used by WildFly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">/subsystem=jsf/:write-attribute(name=default-jsf-impl-slot,value=&lt;JSF_IMPL_NAME&gt;-&lt;JSF_VERSION&gt;)</code></pre>
</div>
</div>
<div class="paragraph">
<p>A server restart will be required for this change to take effect.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuring-a-jsf-app-to-use-a-non-default-jsf-implementation">Configuring a JSF app to use a non-default JSF implementation</h3>
<div class="paragraph">
<p>A JSF app can be configured to use an installed JSF implementation
that&#8217;s not the default implementation by adding a
<code>org.jboss.jbossfaces.JSF_CONFIG_NAME</code> context parameter to its
<code>web.xml</code> file. For example, to indicate that a JSF app should use
MyFaces 2.2.12 (assuming MyFaces 2.2.12 has been installed on the
server), the following context parameter would need to be added:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;context-param&gt;
  &lt;param-name&gt;org.jboss.jbossfaces.JSF_CONFIG_NAME&lt;/param-name&gt;
  &lt;param-value&gt;myfaces-2.2.12&lt;/param-value&gt;
&lt;/context-param&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a JSF app does not specify this context parameter, the default JSF
implementation will be used for that app.</p>
</div>
</div>
<div class="sect2">
<h3 id="disallowing-doctype-declarations">Disallowing DOCTYPE declarations</h3>
<div class="paragraph">
<p>The following CLI commands can be used to disallow DOCTYPE declarations
in JSF deployments:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">/subsystem=jsf:write-attribute(name=disallow-doctype-decl, value=true)
reload</code></pre>
</div>
</div>
<div class="paragraph">
<p>This setting can be overridden for a particular JSF deployment by
adding the <code>com.sun.faces.disallowDoctypeDecl</code> context parameter
to the deployment&#8217;s <code>web.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;context-param&gt;
  &lt;param-name&gt;com.sun.faces.disallowDoctypeDecl&lt;/param-name&gt;
  &lt;param-value&gt;false&lt;/param-value&gt;
&lt;/context-param&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="JMX">JMX subsystem configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The JMX subsystem registers a service with the Remoting endpoint so that
remote access to JMX can be obtained over the exposed Remoting
connector.</p>
</div>
<div class="paragraph">
<p>This is switched on by default in standalone mode and accessible over
port 9990 but in domain mode is switched off so needs to be enabled - in
domain mode the port will be the port of the Remoting connector for the
WildFly instance to be monitored.</p>
</div>
<div class="paragraph">
<p>To use the connector you can access it in the standard way using a
<code>service:jmx</code> URL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">import javax.management.MBeanServerConnection;
import javax.management.remote.JMXConnector;
import javax.management.remote.JMXConnectorFactory;
import javax.management.remote.JMXServiceURL;
Â 
public class JMXExample {
Â 
    public static void main(String[] args) throws Exception {
        //Get a connection to the WildFly MBean server on localhost
        String host = "localhost";
        int port = 9990;  // management-web port
        String urlString =
            System.getProperty("jmx.service.url","service:jmx:remote+http://" + host + ":" + port);
        JMXServiceURL serviceURL = new JMXServiceURL(urlString);
        JMXConnector jmxConnector = JMXConnectorFactory.connect(serviceURL, null);
        MBeanServerConnection connection = jmxConnector.getMBeanServerConnection();
Â 
        //Invoke on the WildFly MBean server
        int count = connection.getMBeanCount();
        System.out.println(count);
       Â jmxConnector.close();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You also need to set your classpath when running the above example. The
following script covers Linux. If your environment is much different,
paste your script when you have it working.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">!/bin/bash

# specify your WildFly folder +
export YOUR_JBOSS_HOME=~/WildFly

java -classpath $YOUR_JBOSS_HOME/bin/client/jboss-client.jar:./
JMXExample</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also connect using jconsole.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If using jconsole use the <code>jconsole.sh</code> and <code>jconsole.bat</code> scripts
included in the /bin directory of the WildFly distribution as these set
the classpath as required to connect over Remoting.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In addition to the standard JVM MBeans, the WildFly MBean server
contains the following MBeans:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">JMX ObjectName</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jboss.msc:type=container,name=jboss-as</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exposes management operations
on the JBoss Modular Service Container, which is the dependency
injection framework at the heart of WildFly. It is useful for debugging
dependency problems, for example if you are integrating your own
subsystems, as it exposes operations to dump all services and their
current states</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jboss.naming:type=JNDIView</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shows what is bound in JNDI</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jboss.modules:type=ModuleLoader,name=*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This collection of MBeans
exposes management operations on JBoss Modules classloading layer. It is
useful for debugging dependency problems arising from missing module
dependencies</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="audit-logging">Audit logging</h3>
<div class="paragraph">
<p>Audit logging for the JMX MBean server managed by the JMX subsystem. The
resource is at <code>/subsystem=jmx/configuration=audit-log</code> and its
attributes are similar to the ones mentioned for
<code>/core-service=management/access=audit/logger=audit-log</code> in
<a href="#Audit_logging">Audit logging</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true to enable logging of the JMX operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">log-boot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true to log the JMX operations when booting the server, false
otherwise</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">log-read-only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true all operations will be audit logged, if false
only operations that change the model will be logged</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Then which handlers are used to log the management operations are
configured as <code>handler=*</code> children of the logger. These handlers and
their formatters are defined in the global
<code>/core-service=management/access=audit</code> section mentioned in
<a href="#Audit_logging">Audit logging</a>.</p>
</div>
<div class="sect3">
<h4 id="json-formatter">JSON Formatter</h4>
<div class="paragraph">
<p>The same JSON Formatter is used as described in
<a href="#Audit_logging">Audit logging</a>. However the records for MBean
Server invocations have slightly different fields from those logged for
the core management layer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">2013-08-29 18:26:29 - {
    "type" : "jmx",
    "r/o" : false,
    "booting" : false,
    "version" : "10.0.0.Final",
    "user" : "$local",
    "domainUUID" : null,
    "access" : "JMX",
    "remote-address" : "127.0.0.1/127.0.0.1",
    "method" : "invoke",
    "sig" : [
        "javax.management.ObjectName",
        "java.lang.String",
        "[Ljava.lang.Object;",
        "[Ljava.lang.String;"
    ],
    "params" : [
        "java.lang:type=Threading",
        "getThreadInfo",
        "[Ljava.lang.Object;@5e6c33c",
        "[Ljava.lang.String;@4b681c69"
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It includes an optional timestamp and then the following information in
the json record</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This will have the value jmx meaning it comes from the jmx
subsystem</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">r/o</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if the operation has read only impact on the MBean(s)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">booting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if the operation was executed during the bootup process,
false if it was executed once the server is up and running</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The version number of the WildFly instance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The username of the authenticated user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domainUUID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is not currently populated for JMX operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This can have one of the following values:*NATIVE - The
operation came in through the native management interface, for example
the CLI*HTTP - The operation came in through the domain HTTP interface,
for example the admin console*JMX - The operation came in through the
JMX subsystem. See JMX for how to configure audit logging for JMX.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">remote-address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The address of the client executing this operation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the called MBeanServer method</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The signature of the called called MBeanServer method</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">params</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The actual parameters passed in to the MBeanServer method, a
simple Object.toString() is called on each parameter.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If calling the MBeanServer method resulted in an error, this
field will be populated with Throwable.getMessage()</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Deployment_Scanner">Deployment Scanner configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The deployment scanner is only used in standalone mode. Its job is to
monitor a directory for new files and to deploy those files. It can be
found in <code>standalone.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:deployment-scanner:2.0"&gt;
   &lt;deployment-scanner scan-interval="5000"
      relative-to="jboss.server.base.dir" path="deployments" /&gt;
&lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can define more <code>deployment-scanner</code> entries to scan for deployments
from more locations. The configuration showed will scan the
<code>JBOSS_HOME/standalone/deployments</code> directory every five seconds. The
runtime model is shown below, and uses default values for attributes not
specified in the xml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9999 /] /subsystem=deployment-scanner:read-resource(recursive=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {"scanner" =&gt; {"default" =&gt; {
        "auto-deploy-exploded" =&gt; false,
        "auto-deploy-zipped" =&gt; true,
        "deployment-timeout" =&gt; 60L,
        "name" =&gt; "default",
        "path" =&gt; "deployments",
        "relative-to" =&gt; "jboss.server.base.dir",
        "scan-enabled" =&gt; true,
        "scan-interval" =&gt; 5000
    }}}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The attributes are</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">STRING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the scanner. default is used if not specified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">STRING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The actual filesystem path to be scanned. Treated as an
absolute path, unless the 'relative-to' attribute is specified, in which
case the value is treated as relative to that path.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relative-to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">STRING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference to a filesystem path defined in the
"paths" section of the server configuration, or one of the system
properties specified on startup. In the example above
jboss.server.base.dir resolves to JBOSS_HOME/standalone</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scan-enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOOLEAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true scanning is enabled</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scan-interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Periodic interval, in milliseconds, at which the
repository should be scanned for changes. A value of less than 1
indicates the repository should only be scanned at initial startup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">auto-deploy-zipped</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOOLEAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls whether zipped deployment content
should be automatically deployed by the scanner without requiring the
user to add a .dodeploy marker file.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">auto-deploy-exploded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOOLEAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls whether exploded deployment
content should be automatically deployed by the scanner without
requiring the user to add a .dodeploy marker file. Setting this to
'true' is not recommended for anything but basic development scenarios,
as there is no way to ensure that deployment will not occur in the
middle of changes to the content.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">auto-deploy-xml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOOLEAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls whether XML content should be
automatically deployed by the scanner without requiring a .dodeploy
marker file.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deployment-timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LONG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timeout, in seconds, a deployment is allows
to execute before being canceled. The default is 60 seconds.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Deployment scanners can be added by modifying <code>standalone.xml</code> before
starting up the server or they can be added and removed at runtime using
the CLI</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /subsystem=deployment-scanner/scanner=new:add(scan-interval=10000,relative-to="jboss.server.base.dir",path="other-deployments")
{"outcome" =&gt; "success"}
[standalone@localhost:9990 /] /subsystem=deployment-scanner/scanner=new:remove
{"outcome" =&gt; "success"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also change the attributes at runtime, so for example to turn
off scanning you can do</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">[standalone@localhost:9990 /] /subsystem=deployment-scanner/scanner=default:write-attribute(name="scan-enabled",value=false)
{"outcome" =&gt; "success"}
[standalone@localhost:9990 /] /subsystem=deployment-scanner:read-resource(recursive=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {"scanner" =&gt; {"default" =&gt; {
        "auto-deploy-exploded" =&gt; false,
        "auto-deploy-zipped" =&gt; true,
        "deployment-timeout" =&gt; 60L,
        "name" =&gt; "default",
        "path" =&gt; "deployments",
        "relative-to" =&gt; "jboss.server.base.dir",
        "scan-enabled" =&gt; false,
        "scan-interval" =&gt; 5000
    }}}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Core_Management">Core Management Subsystem Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The core management subsystem is composed services used to manage the
server or monitor its status.<br>
The core management subsystem configuration may be used to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>register a listener for a server lifecycle events.</p>
</li>
<li>
<p>list the last configuration changes on a server.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="lifecycle-listener">Lifecycle listener</h3>
<div class="paragraph">
<p>You can create an implementation of
<em>org.wildfly.extension.core.management.client.ProcessStateListener</em>
which will be notified on running and runtime configuration state
changes thus enabling the developer to react to those changes.</p>
</div>
<div class="paragraph">
<p>In order to use this feature you need to create your own module then
configure and deploy it using the core management subsystem.</p>
</div>
<div class="paragraph">
<p>For example let&#8217;s create a simple listener :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> public class SimpleListener implements ProcessStateListener {
Â 
Â Â Â  private File file;
Â Â Â  private FileWriter fileWriter;
Â Â Â  private ProcessStateListenerInitParameters parameters;
Â 
Â Â Â  @Override
Â Â Â  public void init(ProcessStateListenerInitParameters parameters) {
Â Â Â Â Â Â Â  this.parameters = parameters;
Â Â Â Â Â Â Â  this.file = new File(parameters.getInitProperties().get("file"));
Â Â Â Â Â Â Â  try {
Â Â Â Â Â Â Â Â Â Â Â  fileWriter = new FileWriter(file, true);
Â Â Â Â Â Â Â  } catch (IOException e) {
Â Â Â Â Â Â Â Â Â Â Â  e.printStackTrace();
Â Â Â Â Â Â Â  }
Â Â Â  }
Â 
Â Â Â  @Override
Â Â Â  public void cleanup() {
Â Â Â Â Â Â Â  try {
Â Â Â Â Â Â Â Â Â Â Â  fileWriter.close();
Â Â Â Â Â Â Â  } catch (IOException e) {
Â Â Â Â Â Â Â Â Â Â Â  e.printStackTrace();
Â Â Â Â Â Â Â  } finally {
Â Â Â Â Â Â Â Â Â Â Â  fileWriter = null;
Â Â Â Â Â Â Â  }
Â Â Â  }
Â 
Â Â Â  @Override
Â Â Â  public void runtimeConfigurationStateChanged(RuntimeConfigurationStateChangeEvent evt) {
Â Â Â Â Â Â Â  try {
Â Â Â Â Â Â Â Â Â Â Â  fileWriter.write(String.format("%s %s %s %s\n", parameters.getProcessType(), parameters.getRunningMode(), evt.getOldState(), evt.getNewState()));
Â Â Â Â Â Â Â  } catch (IOException e) {
Â Â Â Â Â Â Â Â Â Â Â  e.printStackTrace();
Â Â Â Â Â Â Â  }
Â Â Â  }
Â 
Â Â Â  @Override
Â Â Â  public void runningStateChanged(RunningStateChangeEvent evt) {
Â Â Â Â Â Â Â  try {
Â Â Â Â Â Â Â Â Â Â Â  fileWriter.write(String.format("%s %s %s %s\n", parameters.getProcessType(), parameters.getRunningMode(), evt.getOldState(), evt.getNewState()));
Â Â Â Â Â Â Â  } catch (IOException e) {
Â Â Â Â Â Â Â Â Â Â Â  e.printStackTrace();
Â Â Â Â Â Â Â  }
Â Â Â  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To compile it you need to depend on the
<em>org.wildfly.core:wildfly-core-management-client</em> maven module. Now
let&#8217;s add the module to the wildfly modules :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>module add --name=org.simple.lifecycle.events.listener --dependencies=org.wildfly.extension.core-management-client --resources=/home/ehsavoie/dev/demo/simple-listener/target/simple-process-state-listener.jar</pre>
</div>
</div>
<div class="paragraph">
<p>Now we can register or listener :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/subsystem=core-management/process-state-listener=simple-listener:add(class=org.simple.lifecycle.events.listener.SimpleListener, module=org.simple.lifecycle.events.listener, properties={file=/home/wildfly/tmp/events.txt})</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuration-changes">Configuration changes</h3>
<div class="paragraph">
<p>You can use the core management subsystem to enable and configure an
<strong>in-memory</strong> history of the last configuration changes.<br>
For example to track the last 5 configuration changes let&#8217;s active this
:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/subsystem=core-management/service=configuration-changes:add(max-history=5)</pre>
</div>
</div>
<div class="paragraph">
<p>Now we can list the last configuration changes :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ruby">/subsystem=core-management/service=configuration-changes:list-changes()
{
    "outcome" =&gt; "success",
    "result" =&gt; [{
        "operation-date" =&gt; "2016-12-05T11:05:12.867Z",
        "access-mechanism" =&gt; "NATIVE",
        "remote-address" =&gt; "/127.0.0.1",
        "outcome" =&gt; "success",
        "operations" =&gt; [{
            "address" =&gt; [
                ("subsystem" =&gt; "core-management"),
                ("service" =&gt; "configuration-changes")
            ],
            "operation" =&gt; "add",
            "max-history" =&gt; 5,
            "operation-headers" =&gt; {
                "caller-type" =&gt; "user",
                "access-mechanism" =&gt; "NATIVE"
            }
        }]
    }]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Simple_configuration_subsystems">Simple configuration subsystems</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following subsystems currently have no configuration beyond its root
element in the configuration</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">&lt;subsystem xmlns="urn:jboss:domain:jaxrs:1.0"/&gt;
&lt;subsystem xmlns="urn:jboss:domain:jdr:1.0"/&gt;
&lt;subsystem xmlns="urn:jboss:domain:pojo:1.0"/&gt;
&lt;subsystem xmlns="urn:jboss:domain:sar:1.0"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The presence of each of these turns on a piece of functionality:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jaxrs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables the deployment and functionality of JAX-RS applications</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jdr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables the gathering of diagnostic data for use in remote
analysis of error conditions. Although the data is in a simple format
and could be useful to anyone, primarily useful for JBoss EAP
subscribers who would provide the data to Red Hat when requesting
support</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pojo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables the deployment of applications containing JBoss
Microcontainer services, as supported by previous versions of JBoss
Application Server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables the deployment of .SAR archives containing MBean services,
as supported by previous versions of JBoss Application Server</p></td>
</tr>
</tbody>
</table>
</div>
</div>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/wildflysite/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Wildfly</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Wildfly</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wildfly"><svg class="svg-icon"><use xlink:href="/wildflysite/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wildfly</span></a></li><li><a href="https://www.twitter.com/WildFlyAS"><svg class="svg-icon"><use xlink:href="/wildflysite/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">WildFlyAS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
