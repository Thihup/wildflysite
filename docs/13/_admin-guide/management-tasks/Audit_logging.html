<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Audit logging | Wildfly</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="Audit logging" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/management-tasks/Audit_logging.html" />
<meta property="og:url" content="https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/management-tasks/Audit_logging.html" />
<meta property="og:site_name" content="Wildfly" />
<script type="application/ld+json">
{"@type":"WebPage","url":"https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/management-tasks/Audit_logging.html","headline":"Audit logging","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/wildflysite/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://jbossorg.github.io/wildflysite/feed.xml" title="Wildfly" /></head>
<body><div class="header navigation">
  <div class="logo-wrapper">
    <a href="/wildflysite/"><img class="wf-logo" src="/wildflysite/assets/img/wildfly_icons_one-color-logo.png"></a>
  </div>
  <div class="nav-container">
    <nav>
      <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
      <ul class="nav-list">
        <li>
          <a href="/wildflysite/" class="">Home</a>
        </li>
        <li>
          <a href="/wildflysite/downloads/" class="">Downloads</a>
        </li>
        <li>
          <a href="/wildflysite/blog/" class="">Blog</a>
        </li>
        <li>
          <a href="/wildflysite/about/" class="">About</a>
        </li>
        <li>
          <a href="/wildflysite/contribute/" class="">Contribute</a>
        </li>
        <li>
          <a href="/wildflysite/docs/" class="">Docs</a>
        </li>
        <li>
          <a class="button-cta secondary" href="https://github.com/wildfly/wildfly/fork" target="_blank">Fork</a>
        </li>
      </ul>
    </nav>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>WildFly comes with audit logging built in for management operations
affecting the management model. By default it is turned off. The
information is output as JSON records.</p>
</div>
<div class="paragraph">
<p>The default configuration of audit logging in standalone.xml looks as
follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">    &lt;management&gt;
        &lt;security-realms&gt;
...
        &lt;/security-realms&gt;
        &lt;audit-log&gt;
            &lt;formatters&gt;
                &lt;json-formatter name="json-formatter"/&gt;
            &lt;/formatters&gt;
            &lt;handlers&gt;
                &lt;file-handler name="file" formatter="json-formatter" path="audit-log.log" relative-to="jboss.server.data.dir"/&gt;
            &lt;/handlers&gt;
            &lt;logger log-boot="true" log-read-only="true" enabled="false"&gt;
                &lt;handlers&gt;
                    &lt;handler name="file"/&gt;
                &lt;/handlers&gt;
            &lt;/logger&gt;
        &lt;/audit-log&gt;
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Looking at this via the CLI it looks like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[standalone@localhost:9990 /] /core-service=management/access=audit:read-resource(recursive=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "file-handler" =&gt; {"file" =&gt; {
            "formatter" =&gt; "json-formatter",
            "max-failure-count" =&gt; 10,
            "path" =&gt; "audit-log.log",
            "relative-to" =&gt; "jboss.server.data.dir"
        }},
        "json-formatter" =&gt; {"json-formatter" =&gt; {
            "compact" =&gt; false,
            "date-format" =&gt; "yyyy-MM-dd HH:mm:ss",
            "date-separator" =&gt; " - ",
            "escape-control-characters" =&gt; false,
            "escape-new-line" =&gt; false,
            "include-date" =&gt; true
        }},
        "logger" =&gt; {"audit-log" =&gt; {
            "enabled" =&gt; false,
            "log-boot" =&gt; true,
            "log-read-only" =&gt; false,
            "handler" =&gt; {"file" =&gt; {}}
        }},
        "syslog-handler" =&gt; undefined
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To enable it via CLI you need just</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[standalone@localhost:9990 /] /core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)
{"outcome" =&gt; "success"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Audit data are stored in standalone/data/audit-log.log.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The audit logging subsystem has a lot of internal dependencies, and it
logs operations changing, enabling and disabling its components. When
configuring or changing things at runtime it is a good idea to make
these changes as part of a CLI batch. For example if you are adding a
syslog handler you need to add the handler and its information as one
step. Similarly if you are using a file handler, and want to change its
<code>path</code> and <code>relative-to</code> attributes, that needs to happen as one step.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="audit-logging-json-formatter">JSON Formatter</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first thing that needs configuring is the formatter, we currently
support outputting log records as JSON. You can define several
formatters, for use with different handlers. A log record has the
following format, and it is the formatter&#8217;s job to format the data
presented:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">2013-08-12 11:01:12 - {
    "type" : "core",
    "r/o" : false,
    "booting" : false,
    "version" : "8.0.0.Alpha4",
    "user" : "$local",
    "domainUUID" : null,
    "access" : "NATIVE",
    "remote-address" : "127.0.0.1/127.0.0.1",
    "success" : true,
    "ops" : [JMX|WFLY8:JMX subsystem configuration],
        "operation" : "write-attribute",
        "name" : "enabled",
        "value" : true,
        "operation-headers" : {"caller-type" : "user"}
    }]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It includes an optional timestamp and then the following information in
the json record</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This can have the values core, meaning it is a management
operation, or jmx meaning it comes from the jmx subsystem (see the jmx
subsystem for configuration of the jmx subsystem&#8217;s audit logging)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">r/o</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if the operation does not change the management model, false
otherwise</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">booting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if the operation was executed during the bootup process,
false if it was executed once the server is up and running</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The version number of the WildFly instance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The username of the authenticated user. In this case the
operation has been logged via the CLI on the same machine as the running
server, so the special $local user is used</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domainUUID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An ID to link together all operations as they are
propagated from the Doman Controller to it servers, slave Host
Controllers, and slave Host Controller servers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This can have one of the following values:*NATIVE - The
operation came in through the native management interface, for example
the CLI*HTTP - The operation came in through the domain HTTP interface,
for example the admin console*JMX - The operation came in through the
JMX subsystem. See JMX for how to configure audit logging for JMX.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">remote-address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The address of the client executing this operation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">success</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if the operation succeeded, false if it was rolled back</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ops</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operations being executed. This is a list of the operations
serialized to JSON. At boot this will be all the operations resulting
from parsing the xml. Once booted the list will typically just contain a
single entry</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The json formatter resource has the following attributes:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">include-date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolan toggling whether or not to include the timestamp
in the formatted log records</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date-separator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A string containing characters to separate the date and
the rest of the formatted log message. Will be ignored if
include-date=false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date-format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The date format to use for the timestamp as understood by
java.text.SimpleDateFormat. Will be ignored if include-date=false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compact</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true will format the JSON on one line. There may still be
values containing new lines, so if having the whole record on one line
is important, set escape-new-line or escape-control-characters to true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escape-control-characters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true it will escape all control
characters (ascii entries with a decimal value &lt; 32) with the ascii code
in octal, e.g. a new line becomes '#012'. If this is true, it will
override escape-new-line=false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">escape-new-line</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true it will escape all new lines with the ascii
code in octal, e.g. "#012".</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="handlers">Handlers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A handler is responsible for taking the formatted data and logging it to
a location. There are currently two types of handlers, File and Syslog.
You can configure several of each type of handler and use them to log
information.</p>
</div>
<div class="sect2">
<h3 id="file-handler">File handler</h3>
<div class="paragraph">
<p>The file handlers log the audit log records to a file on the server. The
attributes for the file handler are</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Read Only</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">formatter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a JSON formatter to use to format the log
records</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path of the audit log file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relative-to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of another previously named path, or of one of
the standard paths provided by the system. If relative-to is provided,
the value of the path attribute is treated as relative to the path
specified by this attribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">failure-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of logging failures since the handler was
initialized</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-failure-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of logging failures before
disabling this handler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">disabled-due-to-failure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if this handler was disabled due to
logging failures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In our standard configuration <code>path=audit-log.log</code> and
<code>relative-to=jboss.server.data.dir</code>, typically this will be
<code>$JBOSS_HOME/standalone/data/audit-log.log</code></p>
</div>
</div>
<div class="sect2">
<h3 id="audit-syslog-handler">Syslog handler</h3>
<div class="paragraph">
<p>The default configuration does not have syslog audit logging set up.
Syslog is a better choice for audit logging since you can log to a
remote syslog server, and secure the authentication to happen over TLS
with client certificate authentication. Syslog servers vary a lot in
their capabilities so not all settings in this section apply to all
syslog servers. We have tested with <a href="http://www.rsyslog.com">rsyslog</a>.</p>
</div>
<div class="paragraph">
<p>The address for the syslog handler is
<code>/core-service=management/access=audit/syslog-handler=*</code> and just like
file handlers you can add as many syslog entries as you like. The syslog
handler resources reference the main RFC&#8217;s for syslog a fair bit, for
reference they can be found at:<br>
* <a href="http://www.ietf.org/rfc/rfc3164.txt" class="bare">http://www.ietf.org/rfc/rfc3164.txt</a><br>
* <a href="http://www.ietf.org/rfc/rfc5424.txt" class="bare">http://www.ietf.org/rfc/rfc5424.txt</a><br>
* <a href="http://www.ietf.org/rfc/rfc6587.txt" class="bare">http://www.ietf.org/rfc/rfc6587.txt</a></p>
</div>
<div class="paragraph">
<p>The syslog handler resource has the following attributes:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">formatter</th>
<th class="tableblock halign-left valign-top">The name of a JSON formatter to use to format the log
records</th>
<th class="tableblock halign-left valign-top">false</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">failure-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of logging failures since the handler was
initialized</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-failure-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of logging failures before
disabling this handler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">disabled-due-to-failure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true if this handler was disabled due to
logging failures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">syslog-format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to set the syslog format to the one specified in
RFC-5424 or RFC-3164</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum length in bytes a log message, including the
header, is allowed to be. If undefined, it will default to 1024 bytes if
the syslog-format is RFC3164, or 2048 bytes if the syslog-format is
RFC5424.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">truncate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether or not a message, including the header, should
truncate the message if the length in bytes is greater than the maximum
length. If set to false messages will be split and sent with the same
header values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When adding a syslog handler you also need to add the protocol it will
use to communicate with the syslog server. The valid choices for
protocol are <code>UDP</code>, <code>TCP</code> and <code>TLS</code>. The protocol must be added at the
same time as you add the syslog handler, or it will fail. Also, you can
only add one protocol for the handler.</p>
</div>
<div class="sect3">
<h4 id="udp">UDP</h4>
<div class="paragraph">
<p>Configures the handler to use UDP to communicate with the syslog server.
The address of the <code>UDP</code> resource is
<code>/core-service=management/access=audit/syslog-handler=*/protocol=udp</code>.
The attributes of the <code>UDP</code> resource are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host of the syslog server for the udp requests</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port of the syslog server listening for the udp requests</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="tcp">TCP</h4>
<div class="paragraph">
<p>Configures the handler to use TCP to communicate with the syslog server.
The address of the <code>TCP</code> resource is
<code>/core-service=management/access=audit/syslog-handler=*/protocol=tcp</code>.
The attributes of the <code>TCP</code> resource are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host of the syslog server for the tcp requests</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port of the syslog server listening for the tcp requests</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">message-transfer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The message transfer setting as described in section
3.4 of RFC-6587. This can either be OCTET_COUNTING as described in
section 3.4.1 of RFC-6587, or NON_TRANSPARENT_FRAMING as described in
section 3.4.1 of RFC-6587</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="tls">TLS</h4>
<div class="paragraph">
<p>Configures the handler to use TLC to communicate securely with the
syslog server. The address of the <code>TLS</code> resource is
<code>/core-service=management/access=audit/syslog-handler=*/protocol=tls</code>.
The attributes of the <code>TLS</code> resource are the same as for <code>TCP</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host of the syslog server for the tls requests</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port of the syslog server listening for the tls requests</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">message-transfer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The message transfer setting as described in section
3.4 of RFC-6587. This can either be OCTET_COUNTING as described in
section 3.4.1 of RFC-6587, or NON_TRANSPARENT_FRAMING as described in
section 3.4.1 of RFC-6587</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If the syslog server&#8217;s TLS certificate is not signed by a certificate
signing authority, you will need to set up a truststore to trust the
certificate. The resource for the trust store is a child of the <code>TLS</code>
resource, and the full address is
<code>/core-service=management/access=audit/syslog-handler=*/protocol=tls/authentication=truststore</code>.
The attributes of the truststore resource are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password for the truststore</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path of the truststore</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-relative-to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of another previously named path, or of
one of the standard paths provided by the system. If
keystore-relative-to is provided, the value of the keystore-path
attribute is treated as relative to the path specified by this attribute</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="tls-with-client-certificate-authentication.">TLS with Client certificate authentication.</h5>
<div class="paragraph">
<p>If you have set up the syslog server to require client certificate
authentication, when creating your handler you will also need to set up
a client certificate store containing the certificate to be presented to
the syslog server. The address of the client certificate store resource
is
<code>/core-service=management/access=audit/syslog-handler=*/protocol=tls/authentication=client-certificate-store</code>
and its attributes are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password for the keystore</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key-password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password for the keystore key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path of the keystore</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keystore-relative-to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of another previously named path, or of
one of the standard paths provided by the system. If
keystore-relative-to is provided, the value of the keystore-path
attribute is treated as relative to the path specified by this attribute</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="logger-configuration">Logger configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The final part that needs configuring is the logger for the management
operations. This references one or more handlers and is configured at
<code>/core-service=management/access=audit/logger=audit-log</code>. The attributes
for this resource are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true to enable logging of the management operations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">log-boot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true to log the management operations when booting the
server, false otherwise</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">log-read-only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true all operations will be audit logged, if false
only operations that change the model will be logged</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Then which handlers are used to log the management operations are
configured as <code>handler=*</code> children of the logger.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="domain-mode-host-specific-configuration">Domain Mode (host specific configuration)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In domain mode audit logging is configured for each host in its
<code>host.xml</code> file. This means that when connecting to the DC, the
configuration of the audit logging is under the host&#8217;s entry, e.g. here
is the default configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">[domain@localhost:9990 /] /host=master/core-service=management/access=audit:read-resource(recursive=true)
{
    "outcome" =&gt; "success",
    "result" =&gt; {
        "file-handler" =&gt; {
            "host-file" =&gt; {
                "formatter" =&gt; "json-formatter",
                "max-failure-count" =&gt; 10,
                "path" =&gt; "audit-log.log",
                "relative-to" =&gt; "jboss.domain.data.dir"
            },
            "server-file" =&gt; {
                "formatter" =&gt; "json-formatter",
                "max-failure-count" =&gt; 10,
                "path" =&gt; "audit-log.log",
                "relative-to" =&gt; "jboss.server.data.dir"
            }
        },
        "json-formatter" =&gt; {"json-formatter" =&gt; {
            "compact" =&gt; false,
            "date-format" =&gt; "yyyy-MM-dd HH:mm:ss",
            "date-separator" =&gt; " - ",
            "escape-control-characters" =&gt; false,
            "escape-new-line" =&gt; false,
            "include-date" =&gt; true
        }},
        "logger" =&gt; {"audit-log" =&gt; {
            "enabled" =&gt; false,
            "log-boot" =&gt; true,
            "log-read-only" =&gt; false,
            "handler" =&gt; {"host-file" =&gt; {}}
        }},
        "server-logger" =&gt; {"audit-log" =&gt; {
            "enabled" =&gt; false,
            "log-boot" =&gt; true,
            "log-read-only" =&gt; false,
            "handler" =&gt; {"server-file" =&gt; {}}
        }},
        "syslog-handler" =&gt; undefined
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We now have two file handlers, one called <code>host-file</code> used to configure
the file to log management operations on the host, and one called
<code>server-file</code> used to log management operations executed on the servers.
Then <code>logger=audit-log</code> is used to configure the logger for the host
controller, referencing the <code>host-file</code> handler.
<code>server-logger=audit-log</code> is used to configure the logger for the
managed servers, referencing the <code>server-file</code> handler. The attributes
for <code>server-logger=audit-log</code> are the same as for
<code>server-logger=audit-log</code> in the previous section. Having the host
controller and server loggers configured independently means we can
control audit logging for managed servers and the host controller
independently.</p>
</div>
</div>
</div>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/wildflysite/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Wildfly</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Wildfly</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wildfly"><svg class="svg-icon"><use xlink:href="/wildflysite/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wildfly</span></a></li><li><a href="https://www.twitter.com/WildFlyAS"><svg class="svg-icon"><use xlink:href="/wildflysite/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">WildFlyAS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
