<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Detailed Configuration | Wildfly</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="Detailed Configuration" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/Security_Realms_Detailed_Configuration.html" />
<meta property="og:url" content="https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/Security_Realms_Detailed_Configuration.html" />
<meta property="og:site_name" content="Wildfly" />
<script type="application/ld+json">
{"@type":"WebPage","url":"https://jbossorg.github.io/wildflysite/docs/13/_admin-guide/Security_Realms_Detailed_Configuration.html","headline":"Detailed Configuration","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/wildflysite/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://jbossorg.github.io/wildflysite/feed.xml" title="Wildfly" /></head>
<body><div class="header navigation">
  <div class="logo-wrapper">
    <a href="/wildflysite/"><img class="wf-logo" src="/wildflysite/assets/img/wildfly_icons_one-color-logo.png"></a>
  </div>
  <div class="nav-container">
    <nav>
      <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
      <ul class="nav-list">
        <li>
          <a href="/wildflysite/" class="">Home</a>
        </li>
        <li>
          <a href="/wildflysite/downloads/" class="">Downloads</a>
        </li>
        <li>
          <a href="/wildflysite/blog/" class="">Blog</a>
        </li>
        <li>
          <a href="/wildflysite/about/" class="">About</a>
        </li>
        <li>
          <a href="/wildflysite/contribute/" class="">Contribute</a>
        </li>
        <li>
          <a href="/wildflysite/docs/" class="">Docs</a>
        </li>
        <li>
          <a class="button-cta secondary" href="https://github.com/wildfly/wildfly/fork" target="_blank">Fork</a>
        </li>
      </ul>
    </nav>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This section of the documentation describes the various configuration
options when defining realms, plug-ins are a slightly special case so
the configuration options for plug-ins is within it&#8217;s own section.</p>
</div>
<div class="paragraph">
<p>Within a security realm definition there are four optional elements
<code>&lt;plug-ins /&gt;</code>, <code>&lt;server-identities /&gt;</code>, <code>&lt;authentication /&gt;</code>, and
<code>&lt;authorization /&gt;</code>, as mentioned above plug-ins is defined within it&#8217;s
own section below so we will begin by looking at the
<code>&lt;server-identities /&gt;</code> element.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="server-identities">&lt;server-identities /&gt;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The server identities section of a realm definition is used to define
how a server appears to the outside world, currently this element can be
used to configure a password to be used when establishing a remote
outbound connection and also how to load a X.509 key which can be used
for both inbound and outbound SSL connections.</p>
</div>
<div class="sect2">
<h3 id="ssl">&lt;ssl /&gt;</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;server-identities&gt;
  &lt;ssl protocol="..."&gt;
    &lt;keystore path="..." relative-to="..." keystore-password="..." alias="..." key-password="..." /&gt;
  &lt;/ssl&gt;
&lt;/server-identities&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>protocol</strong> - By default this is set to TLS and in general does not
need to be set.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The SSL element then contains the nested <code>&lt;keystore /&gt;</code> element, this is
used to define how to load the key from the file based (JKS) keystore.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>path</strong> (mandatory) - This is the path to the keystore, this can be an
absolute path or relative to the next attribute.</p>
</li>
<li>
<p><strong>relative-to</strong> (optional) - The name of a service representing a path
the keystore is relative to.</p>
</li>
<li>
<p><strong>keystore-password</strong> (mandatory) - The password required to open the
keystore.</p>
</li>
<li>
<p><strong>alias</strong> (optional) - The alias of the entry to use from the keystore -
for a keystore with multiple entries in practice the first usable entry
is used but this should not be relied on and the alias should be set to
guarantee which entry is used.</p>
</li>
<li>
<p><strong>key-password</strong> (optional) - The password to load the key entry, if
omitted the keystore-password will be used instead.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If you see the error <code>UnrecoverableKeyException: Cannot recover key</code> the
most likely cause that you need to specify a <code>key-password</code> and possible
even an <code>alias</code> as well to ensure only one key is loaded.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="secret">&lt;secret /&gt;</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;server-identities&gt;
  &lt;secret value="..." /&gt;
&lt;/server-identities&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>value</strong> (mandatory) - The password to use for outbound connections
encoded as Base64, this field also supports a vault expression should
stronger protection be required.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The username for the outbound connection is specified at the point the
outbound connection is defined.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="authentication">&lt;authentication /&gt;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The authentication element is predominantly used to configure the
authentication that is performed on an inbound connection, however there
is one exception and that is if a trust store is defined - on
negotiating an outbound SSL connection the trust store will be used to
verify the remote server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;authentication&gt;
  &lt;truststore /&gt;
  &lt;local /&gt;
  &lt;jaas /&gt;
  &lt;ldap /&gt;
  &lt;properties /&gt;
  &lt;users /&gt;
  &lt;plug-in /&gt;
&lt;/authentication&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>An authentication definition can have zero or one <code>&lt;truststore /&gt;</code>, it
can also have zero or one <code>&lt;local /&gt;</code> and it can also have one of
<code>&lt;jaas /&gt;</code>, <code>&lt;ldap /&gt;</code>, <code>&lt;properties /&gt;</code>, <code>&lt;users /&gt;</code>, and <code>&lt;plug-in /&gt;</code>
i.e. the local mechanism and a truststore for certificate verification
can be independent switched on and off and a single username / password
store can be defined.</p>
</div>
<div class="sect2">
<h3 id="truststore">&lt;truststore /&gt;</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;authentication&gt;
  &lt;truststore path="..." relative-to="..." keystore-password="..."/&gt;
&lt;/authentication&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This element is used to define how to load a key store file that can be
used as the trust store within the SSLContext we create internally, the
store is then used to verify the certificates of the remote side of the
connection be that inbound or outbound.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>path</strong> (mandatory) - This is the path to the keystore, this can be an
absolute path or relative to the next attribute.</p>
</li>
<li>
<p><strong>relative-to</strong> (optional) - The name of a service representing a path
the keystore is relative to.</p>
</li>
<li>
<p><strong>keystore-password</strong> (mandatory) - The password required to open the
keystore.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Although this is a definition of a trust store the attribute for the
password is <code>keystore-password</code>, this is because the underlying file
being opened is still a key store.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="local">&lt;local /&gt;</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;authentication&gt;
  &lt;local default-user="..." allowed-users="..." /&gt;
&lt;/authentication&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This element switches on the local authentication mechanism that allows
clients to the server to verify that they are local to the server, at
the protocol level it is optional for the remote client to send a user
name in the authentication response.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>default-user</strong> (optional) - If the client does not pass in a username
this is the assumed username, this value is also automatically added to
the list of allowed-users.</p>
</li>
<li>
<p><strong>allowed-users</strong> (optional) - This attribute is used to specify a comma
separated list of users allowed to authenticate using the local
mechanism, alternatively ' `*&#8217; can be specified to allow any username
to be specified.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="jaas">&lt;jaas /&gt;</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;authentication&gt;
  &lt;jaas name="..." /&gt;
&lt;/authentication&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The jaas element is used to enable username and password based
authentication where the supplied username and password are verified by
making use of a configured jaas domain.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> (mandatory) - The name of the jaas domain to use to verify the
supplied username and password.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
As JAAS authentication works by taking a username and password and
verifying these the use of this element means that at the transport
level authentication will be forced to send the password in plain text,
any interception of the messages exchanged between the client and server
without SSL enabled will reveal the users password.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="ldap">&lt;ldap /&gt;</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;authentication&gt;
  &lt;ldap connection="..." base-dn="..." recursive="..." user-dn="..."&gt;
    &lt;username-filter attribute="..." /&gt;
    &lt;advanced-filter filter="..." /&gt;
  &lt;/ldap&gt;
&lt;/authentication&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The ldap element is used to define how LDAP searches will be used to
authenticate a user, this works by first connecting to LDAP and
performing a search using the supplied user name to identity the
distinguished name of the user and then a subsequent connection is made
to the server using the password supplied by the user - if this second
connection is a success then authentication succeeds.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Due to the verification approach used this configuration causes the
authentication mechanisms selected for the protocol to cause the
password to be sent from the client in plain text, the following Jira
issue is to investigating proxying a Digest authentication with the LDAP
server so no plain text password is needed
<a href="https://issues.jboss.org/browse/AS7-4195">AS7-4195</a>.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>connection</strong> (mandatory) - The name of the connection to use to
connect to LDAP.</p>
</li>
<li>
<p><strong>base-dn</strong> (mandatory) - The distinguished name of the context to use
to begin the search from.</p>
</li>
<li>
<p><strong>recursive</strong> (optional) - Should the filter be executed recursively?
Defaults to false.</p>
</li>
<li>
<p><strong>user-dn</strong> (optional) - After the user has been found specifies which
attribute to read for the users distinguished name, defaults to ' `dn&#8217;.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Within the ldap element only one of <code>&lt;username-filter /&gt;</code> or
<code>&lt;advanced-filter /&gt;</code> can be specified.</p>
</div>
<div class="sect3">
<h4 id="username-filter">&lt;username-filter /&gt;</h4>
<div class="paragraph">
<p>This element is used for a simple filter to match the username specified
by the remote user against a single attribute, as an example with Active
Directory the match is most likely to be against the ' `sAMAccountName&#8217;
attribute.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>attribute</strong> (mandatory) - The name of the field to match the users
supplied username against.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="advanced-filter">&lt;advanced-filter /&gt;</h4>
<div class="paragraph">
<p>This element is used where a more advanced filter is required, one
example use of this filter is to exclude certain matches by specifying
some additional criteria for the filter.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>filter</strong> (mandatory) - The filter to execute to locate the user, this
filter should contain '\{ <code>0</code>}' as a place holder for the username
supplied by the user authenticating.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="security-realms-properties">&lt;properties /&gt;</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;authentication&gt;
  &lt;properties path="..." relative-to="..." plain-text="..." /&gt;
&lt;/authentication&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The properties element is used to reference a properties file to load to
read a users password or pre-prepared digest for the authentication
process.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>path</strong> (mandatory) - The path to the properties file, either absolute
or relative to the path referenced by the relative-to attribute.</p>
</li>
<li>
<p><strong>relative-to</strong> (optional) - The name of a path service that the defined
path will be relative to.</p>
</li>
<li>
<p><strong>plain-text</strong> (optional) - Setting to specify if the passwords are
stored as plain text within the properties file, defaults to false.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
By default the properties files are expected to store a pre-prepared
hash of the users password in the form HEX( MD5( username ':' realm ':'
password))
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="users">&lt;users /&gt;</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;authentication&gt;
  &lt;users&gt;
    &lt;user username="..."&gt;
      &lt;password&gt;...&lt;/password&gt;
    &lt;/user&gt;
  &lt;/users&gt;
&lt;/authentication&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a very simple store of a username and password that stores both
of these within the domain model, this is only really provided for the
provision of simple examples.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>username</strong> (mandatory) - A users username.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>&lt;password/&gt;</code> element is then used to define the password for the
user.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="authorization">&lt;authorization /&gt;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The authorization element is used to define how a users roles can be
loaded after the authentication process completes, these roles may then
be used for subsequent authorization decisions based on the service
being accessed. At the moment only a properties file approach or a
custom plug-in are supported - support for loading roles from LDAP or
from a database are planned for a subsequent release.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;authorization&gt;
  &lt;properties /&gt;
  &lt;plug-in /&gt;
&lt;/authorization&gt;</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="properties">&lt;properties /&gt;</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;authorization&gt;
  &lt;properties path="..." relative-to="..." /&gt;
&lt;/authorization&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The format of the properties file is <code>username={ROLES</code>} where \{
<code>ROLES</code>} is a comma separated list of the users roles.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>path</strong> (mandatory) - The path to the properties file, either absolute
or relative to the path referenced by the relative-to attribute.</p>
</li>
<li>
<p><strong>relative-to</strong> (optional) - The name of a path service that the defined
path will be relative to.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="outbound-connection">&lt;outbound-connection /&gt;</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Strictly speaking these are not a part of the security realm definition,
however at the moment they are only used by security realms so the
definition of outbound connection is described here.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;management&gt;
  &lt;security-realms /&gt;
  &lt;outbound-connections&gt;
    &lt;ldap /&gt;
  &lt;/outbound-connections&gt;
&lt;/management&gt;</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="ldap-2">&lt;ldap /&gt;</h3>
<div class="paragraph">
<p>At the moment we only support outbound connections to ldap servers for
the authentication process - this will later be expanded when we add
support for database based authentication.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;outbound-connections&gt;
  &lt;ldap name="..." url="..." search-dn="..." search-credential="..." initial-context-factory="..." /&gt;
&lt;/outbound-connections&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The outbound connections are defined in this section and then referenced
by name from the configuration that makes use of them.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> (mandatory) - The unique name used to reference this
connection.</p>
</li>
<li>
<p><strong>url</strong> (mandatory) - The URL use to establish the LDAP connection.</p>
</li>
<li>
<p><strong>search-dn</strong> (mandatory) - The distinguished name of the user to
authenticate as to perform the searches.</p>
</li>
<li>
<p><strong>search-credential</strong> (mandatory) - The password required to connect to
LDAP as the search-dn.</p>
</li>
<li>
<p><strong>initial-context-factory</strong> (optional) - Allows overriding the initial
context factory, defaults to ' `com.sun.jndi.ldap.LdapCtxFactory&#8217;</p>
</li>
</ul>
</div>
</div>
</div>
</div>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/wildflysite/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Wildfly</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Wildfly</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/wildfly"><svg class="svg-icon"><use xlink:href="/wildflysite/assets/minima-social-icons.svg#github"></use></svg> <span class="username">wildfly</span></a></li><li><a href="https://www.twitter.com/WildFlyAS"><svg class="svg-icon"><use xlink:href="/wildflysite/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">WildFlyAS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
